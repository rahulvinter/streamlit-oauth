(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function Ho(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ms={exports:{}},R={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K=typeof Symbol=="function"&&Symbol.for,Jn=K?Symbol.for("react.element"):60103,Gn=K?Symbol.for("react.portal"):60106,Hr=K?Symbol.for("react.fragment"):60107,Kr=K?Symbol.for("react.strict_mode"):60108,Jr=K?Symbol.for("react.profiler"):60114,Gr=K?Symbol.for("react.provider"):60109,qr=K?Symbol.for("react.context"):60110,qn=K?Symbol.for("react.async_mode"):60111,Zr=K?Symbol.for("react.concurrent_mode"):60111,Qr=K?Symbol.for("react.forward_ref"):60112,Xr=K?Symbol.for("react.suspense"):60113,Ko=K?Symbol.for("react.suspense_list"):60120,tn=K?Symbol.for("react.memo"):60115,en=K?Symbol.for("react.lazy"):60116,Jo=K?Symbol.for("react.block"):60121,Go=K?Symbol.for("react.fundamental"):60117,qo=K?Symbol.for("react.responder"):60118,Zo=K?Symbol.for("react.scope"):60119;function ct(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Jn:switch(e=e.type,e){case qn:case Zr:case Hr:case Jr:case Kr:case Xr:return e;default:switch(e=e&&e.$$typeof,e){case qr:case Qr:case en:case tn:case Gr:return e;default:return t}}case Gn:return t}}}function Us(e){return ct(e)===Zr}R.AsyncMode=qn;R.ConcurrentMode=Zr;R.ContextConsumer=qr;R.ContextProvider=Gr;R.Element=Jn;R.ForwardRef=Qr;R.Fragment=Hr;R.Lazy=en;R.Memo=tn;R.Portal=Gn;R.Profiler=Jr;R.StrictMode=Kr;R.Suspense=Xr;R.isAsyncMode=function(e){return Us(e)||ct(e)===qn};R.isConcurrentMode=Us;R.isContextConsumer=function(e){return ct(e)===qr};R.isContextProvider=function(e){return ct(e)===Gr};R.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Jn};R.isForwardRef=function(e){return ct(e)===Qr};R.isFragment=function(e){return ct(e)===Hr};R.isLazy=function(e){return ct(e)===en};R.isMemo=function(e){return ct(e)===tn};R.isPortal=function(e){return ct(e)===Gn};R.isProfiler=function(e){return ct(e)===Jr};R.isStrictMode=function(e){return ct(e)===Kr};R.isSuspense=function(e){return ct(e)===Xr};R.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Hr||e===Zr||e===Jr||e===Kr||e===Xr||e===Ko||typeof e=="object"&&e!==null&&(e.$$typeof===en||e.$$typeof===tn||e.$$typeof===Gr||e.$$typeof===qr||e.$$typeof===Qr||e.$$typeof===Go||e.$$typeof===qo||e.$$typeof===Zo||e.$$typeof===Jo)};R.typeOf=ct;(function(e){e.exports=R})(Ms);var Es=Ms.exports,Qo={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Xo={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Ns={};Ns[Es.ForwardRef]=Qo;Ns[Es.Memo]=Xo;var Vs={exports:{}},k={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Zi=Object.getOwnPropertySymbols,tc=Object.prototype.hasOwnProperty,ec=Object.prototype.propertyIsEnumerable;function rc(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function nc(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(t).map(function(a){return t[a]});if(n.join("")!=="0123456789")return!1;var s={};return"abcdefghijklmnopqrst".split("").forEach(function(a){s[a]=a}),Object.keys(Object.assign({},s)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var ic=nc()?Object.assign:function(e,t){for(var r,n=rc(e),s,a=1;a<arguments.length;a++){r=Object(arguments[a]);for(var i in r)tc.call(r,i)&&(n[i]=r[i]);if(Zi){s=Zi(r);for(var o=0;o<s.length;o++)ec.call(r,s[o])&&(n[s[o]]=r[s[o]])}}return n};/** @license React v16.14.0
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zn=ic,wt=typeof Symbol=="function"&&Symbol.for,Ze=wt?Symbol.for("react.element"):60103,sc=wt?Symbol.for("react.portal"):60106,ac=wt?Symbol.for("react.fragment"):60107,oc=wt?Symbol.for("react.strict_mode"):60108,cc=wt?Symbol.for("react.profiler"):60114,uc=wt?Symbol.for("react.provider"):60109,lc=wt?Symbol.for("react.context"):60110,hc=wt?Symbol.for("react.forward_ref"):60112,fc=wt?Symbol.for("react.suspense"):60113,dc=wt?Symbol.for("react.memo"):60115,pc=wt?Symbol.for("react.lazy"):60116,Qi=typeof Symbol=="function"&&Symbol.iterator;function Qe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Cs={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Rs={};function xe(e,t,r){this.props=e,this.context=t,this.refs=Rs,this.updater=r||Cs}xe.prototype.isReactComponent={};xe.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error(Qe(85));this.updater.enqueueSetState(this,e,t,"setState")};xe.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function ks(){}ks.prototype=xe.prototype;function Qn(e,t,r){this.props=e,this.context=t,this.refs=Rs,this.updater=r||Cs}var Xn=Qn.prototype=new ks;Xn.constructor=Qn;Zn(Xn,xe.prototype);Xn.isPureReactComponent=!0;var ti={current:null},js=Object.prototype.hasOwnProperty,zs={key:!0,ref:!0,__self:!0,__source:!0};function Ps(e,t,r){var n,s={},a=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)js.call(t,n)&&!zs.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Ze,type:e,key:a,ref:i,props:s,_owner:ti.current}}function yc(e,t){return{$$typeof:Ze,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ei(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ze}function bc(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,function(r){return t[r]})}var $s=/\/+/g,Tr=[];function Ws(e,t,r,n){if(Tr.length){var s=Tr.pop();return s.result=e,s.keyPrefix=t,s.func=r,s.context=n,s.count=0,s}return{result:e,keyPrefix:t,func:r,context:n,count:0}}function Ys(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>Tr.length&&Tr.push(e)}function En(e,t,r,n){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Ze:case sc:a=!0}}if(a)return r(n,e,t===""?"."+_n(e,0):t),1;if(a=0,t=t===""?".":t+":",Array.isArray(e))for(var i=0;i<e.length;i++){s=e[i];var o=t+_n(s,i);a+=En(s,o,r,n)}else if(e===null||typeof e!="object"?o=null:(o=Qi&&e[Qi]||e["@@iterator"],o=typeof o=="function"?o:null),typeof o=="function")for(e=o.call(e),i=0;!(s=e.next()).done;)s=s.value,o=t+_n(s,i++),a+=En(s,o,r,n);else if(s==="object")throw r=""+e,Error(Qe(31,r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r,""));return a}function Nn(e,t,r){return e==null?0:En(e,"",t,r)}function _n(e,t){return typeof e=="object"&&e!==null&&e.key!=null?bc(e.key):t.toString(36)}function mc(e,t){e.func.call(e.context,t,e.count++)}function gc(e,t,r){var n=e.result,s=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?Vn(e,n,r,function(a){return a}):e!=null&&(ei(e)&&(e=yc(e,s+(!e.key||t&&t.key===e.key?"":(""+e.key).replace($s,"$&/")+"/")+r)),n.push(e))}function Vn(e,t,r,n,s){var a="";r!=null&&(a=(""+r).replace($s,"$&/")+"/"),t=Ws(t,a,n,s),Nn(e,gc,t),Ys(t)}var Hs={current:null};function Vt(){var e=Hs.current;if(e===null)throw Error(Qe(321));return e}var _c={ReactCurrentDispatcher:Hs,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:ti,IsSomeRendererActing:{current:!1},assign:Zn};k.Children={map:function(e,t,r){if(e==null)return e;var n=[];return Vn(e,n,null,t,r),n},forEach:function(e,t,r){if(e==null)return e;t=Ws(null,null,t,r),Nn(e,mc,t),Ys(t)},count:function(e){return Nn(e,function(){return null},null)},toArray:function(e){var t=[];return Vn(e,t,null,function(r){return r}),t},only:function(e){if(!ei(e))throw Error(Qe(143));return e}};k.Component=xe;k.Fragment=ac;k.Profiler=cc;k.PureComponent=Qn;k.StrictMode=oc;k.Suspense=fc;k.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_c;k.cloneElement=function(e,t,r){if(e==null)throw Error(Qe(267,e));var n=Zn({},e.props),s=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=ti.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)js.call(t,c)&&!zs.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Ze,type:e.type,key:s,ref:a,props:n,_owner:i}};k.createContext=function(e,t){return t===void 0&&(t=null),e={$$typeof:lc,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider={$$typeof:uc,_context:e},e.Consumer=e};k.createElement=Ps;k.createFactory=function(e){var t=Ps.bind(null,e);return t.type=e,t};k.createRef=function(){return{current:null}};k.forwardRef=function(e){return{$$typeof:hc,render:e}};k.isValidElement=ei;k.lazy=function(e){return{$$typeof:pc,_ctor:e,_status:-1,_result:null}};k.memo=function(e,t){return{$$typeof:dc,type:e,compare:t===void 0?null:t}};k.useCallback=function(e,t){return Vt().useCallback(e,t)};k.useContext=function(e,t){return Vt().useContext(e,t)};k.useDebugValue=function(){};k.useEffect=function(e,t){return Vt().useEffect(e,t)};k.useImperativeHandle=function(e,t,r){return Vt().useImperativeHandle(e,t,r)};k.useLayoutEffect=function(e,t){return Vt().useLayoutEffect(e,t)};k.useMemo=function(e,t){return Vt().useMemo(e,t)};k.useReducer=function(e,t,r){return Vt().useReducer(e,t,r)};k.useRef=function(e){return Vt().useRef(e)};k.useState=function(e){return Vt().useState(e)};k.version="16.14.0";(function(e){e.exports=k})(Vs);const wc=Ho(Vs.exports),Ks=new WeakMap,Cn=new WeakMap;function P(e){const t=Ks.get(e);return console.assert(t!=null,"'this' is expected an Event object, but got",e),t}function Xi(e){if(e.passiveListener!=null){typeof console<"u"&&typeof console.error=="function"&&console.error("Unable to preventDefault inside passive event listener invocation.",e.passiveListener);return}!e.event.cancelable||(e.canceled=!0,typeof e.event.preventDefault=="function"&&e.event.preventDefault())}function _e(e,t){Ks.set(this,{eventTarget:e,event:t,eventPhase:2,currentTarget:e,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:t.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});const r=Object.keys(t);for(let n=0;n<r.length;++n){const s=r[n];s in this||Object.defineProperty(this,s,Js(s))}}_e.prototype={get type(){return P(this).event.type},get target(){return P(this).eventTarget},get currentTarget(){return P(this).currentTarget},composedPath(){const e=P(this).currentTarget;return e==null?[]:[e]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return P(this).eventPhase},stopPropagation(){const e=P(this);e.stopped=!0,typeof e.event.stopPropagation=="function"&&e.event.stopPropagation()},stopImmediatePropagation(){const e=P(this);e.stopped=!0,e.immediateStopped=!0,typeof e.event.stopImmediatePropagation=="function"&&e.event.stopImmediatePropagation()},get bubbles(){return Boolean(P(this).event.bubbles)},get cancelable(){return Boolean(P(this).event.cancelable)},preventDefault(){Xi(P(this))},get defaultPrevented(){return P(this).canceled},get composed(){return Boolean(P(this).event.composed)},get timeStamp(){return P(this).timeStamp},get srcElement(){return P(this).eventTarget},get cancelBubble(){return P(this).stopped},set cancelBubble(e){if(!e)return;const t=P(this);t.stopped=!0,typeof t.event.cancelBubble=="boolean"&&(t.event.cancelBubble=!0)},get returnValue(){return!P(this).canceled},set returnValue(e){e||Xi(P(this))},initEvent(){}};Object.defineProperty(_e.prototype,"constructor",{value:_e,configurable:!0,writable:!0});typeof window<"u"&&typeof window.Event<"u"&&(Object.setPrototypeOf(_e.prototype,window.Event.prototype),Cn.set(window.Event.prototype,_e));function Js(e){return{get(){return P(this).event[e]},set(t){P(this).event[e]=t},configurable:!0,enumerable:!0}}function vc(e){return{value(){const t=P(this).event;return t[e].apply(t,arguments)},configurable:!0,enumerable:!0}}function Ic(e,t){const r=Object.keys(t);if(r.length===0)return e;function n(s,a){e.call(this,s,a)}n.prototype=Object.create(e.prototype,{constructor:{value:n,configurable:!0,writable:!0}});for(let s=0;s<r.length;++s){const a=r[s];if(!(a in e.prototype)){const o=typeof Object.getOwnPropertyDescriptor(t,a).value=="function";Object.defineProperty(n.prototype,a,o?vc(a):Js(a))}}return n}function Gs(e){if(e==null||e===Object.prototype)return _e;let t=Cn.get(e);return t==null&&(t=Ic(Gs(Object.getPrototypeOf(e)),e),Cn.set(e,t)),t}function Sc(e,t){const r=Gs(Object.getPrototypeOf(t));return new r(e,t)}function Bc(e){return P(e).immediateStopped}function Ac(e,t){P(e).eventPhase=t}function Tc(e,t){P(e).currentTarget=t}function ts(e,t){P(e).passiveListener=t}const qs=new WeakMap,es=1,rs=2,_r=3;function wr(e){return e!==null&&typeof e=="object"}function Ee(e){const t=qs.get(e);if(t==null)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return t}function Fc(e){return{get(){let r=Ee(this).get(e);for(;r!=null;){if(r.listenerType===_r)return r.listener;r=r.next}return null},set(t){typeof t!="function"&&!wr(t)&&(t=null);const r=Ee(this);let n=null,s=r.get(e);for(;s!=null;)s.listenerType===_r?n!==null?n.next=s.next:s.next!==null?r.set(e,s.next):r.delete(e):n=s,s=s.next;if(t!==null){const a={listener:t,listenerType:_r,passive:!1,once:!1,next:null};n===null?r.set(e,a):n.next=a}},configurable:!0,enumerable:!0}}function Oc(e,t){Object.defineProperty(e,`on${t}`,Fc(t))}function ns(e){function t(){Wt.call(this)}t.prototype=Object.create(Wt.prototype,{constructor:{value:t,configurable:!0,writable:!0}});for(let r=0;r<e.length;++r)Oc(t.prototype,e[r]);return t}function Wt(){if(this instanceof Wt){qs.set(this,new Map);return}if(arguments.length===1&&Array.isArray(arguments[0]))return ns(arguments[0]);if(arguments.length>0){const e=new Array(arguments.length);for(let t=0;t<arguments.length;++t)e[t]=arguments[t];return ns(e)}throw new TypeError("Cannot call a class as a function")}Wt.prototype={addEventListener(e,t,r){if(t==null)return;if(typeof t!="function"&&!wr(t))throw new TypeError("'listener' should be a function or an object.");const n=Ee(this),s=wr(r),i=Boolean(s?r.capture:r)?es:rs,o={listener:t,listenerType:i,passive:s&&Boolean(r.passive),once:s&&Boolean(r.once),next:null};let c=n.get(e);if(c===void 0){n.set(e,o);return}let u=null;for(;c!=null;){if(c.listener===t&&c.listenerType===i)return;u=c,c=c.next}u.next=o},removeEventListener(e,t,r){if(t==null)return;const n=Ee(this),a=(wr(r)?Boolean(r.capture):Boolean(r))?es:rs;let i=null,o=n.get(e);for(;o!=null;){if(o.listener===t&&o.listenerType===a){i!==null?i.next=o.next:o.next!==null?n.set(e,o.next):n.delete(e);return}i=o,o=o.next}},dispatchEvent(e){if(e==null||typeof e.type!="string")throw new TypeError('"event.type" should be a string.');const t=Ee(this),r=e.type;let n=t.get(r);if(n==null)return!0;const s=Sc(this,e);let a=null;for(;n!=null;){if(n.once?a!==null?a.next=n.next:n.next!==null?t.set(r,n.next):t.delete(r):a=n,ts(s,n.passive?n.listener:null),typeof n.listener=="function")try{n.listener.call(this,s)}catch(i){typeof console<"u"&&typeof console.error=="function"&&console.error(i)}else n.listenerType!==_r&&typeof n.listener.handleEvent=="function"&&n.listener.handleEvent(s);if(Bc(s))break;n=n.next}return ts(s,null),Ac(s,0),Tc(s,null),!s.defaultPrevented}};Object.defineProperty(Wt.prototype,"constructor",{value:Wt,configurable:!0,writable:!0});typeof window<"u"&&typeof window.EventTarget<"u"&&Object.setPrototypeOf(Wt.prototype,window.EventTarget.prototype);var h={};h.SIZEOF_SHORT=2;h.SIZEOF_INT=4;h.FILE_IDENTIFIER_LENGTH=4;h.Encoding={UTF8_BYTES:1,UTF16_STRING:2};h.int32=new Int32Array(2);h.float32=new Float32Array(h.int32.buffer);h.float64=new Float64Array(h.int32.buffer);h.isLittleEndian=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;h.Long=function(e,t){this.low=e|0,this.high=t|0};h.Long.create=function(e,t){return e==0&&t==0?h.Long.ZERO:new h.Long(e,t)};h.Long.prototype.toFloat64=function(){return(this.low>>>0)+this.high*4294967296};h.Long.prototype.equals=function(e){return this.low==e.low&&this.high==e.high};h.Long.ZERO=new h.Long(0,0);h.Builder=function(e){if(e)var t=e;else var t=1024;this.bb=h.ByteBuffer.allocate(t),this.space=t,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1};h.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1};h.Builder.prototype.forceDefaults=function(e){this.force_defaults=e};h.Builder.prototype.dataBuffer=function(){return this.bb};h.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())};h.Builder.prototype.prep=function(e,t){e>this.minalign&&(this.minalign=e);for(var r=~(this.bb.capacity()-this.space+t)+1&e-1;this.space<r+e+t;){var n=this.bb.capacity();this.bb=h.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-n}this.pad(r)};h.Builder.prototype.pad=function(e){for(var t=0;t<e;t++)this.bb.writeInt8(--this.space,0)};h.Builder.prototype.writeInt8=function(e){this.bb.writeInt8(this.space-=1,e)};h.Builder.prototype.writeInt16=function(e){this.bb.writeInt16(this.space-=2,e)};h.Builder.prototype.writeInt32=function(e){this.bb.writeInt32(this.space-=4,e)};h.Builder.prototype.writeInt64=function(e){this.bb.writeInt64(this.space-=8,e)};h.Builder.prototype.writeFloat32=function(e){this.bb.writeFloat32(this.space-=4,e)};h.Builder.prototype.writeFloat64=function(e){this.bb.writeFloat64(this.space-=8,e)};h.Builder.prototype.addInt8=function(e){this.prep(1,0),this.writeInt8(e)};h.Builder.prototype.addInt16=function(e){this.prep(2,0),this.writeInt16(e)};h.Builder.prototype.addInt32=function(e){this.prep(4,0),this.writeInt32(e)};h.Builder.prototype.addInt64=function(e){this.prep(8,0),this.writeInt64(e)};h.Builder.prototype.addFloat32=function(e){this.prep(4,0),this.writeFloat32(e)};h.Builder.prototype.addFloat64=function(e){this.prep(8,0),this.writeFloat64(e)};h.Builder.prototype.addFieldInt8=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt8(t),this.slot(e))};h.Builder.prototype.addFieldInt16=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt16(t),this.slot(e))};h.Builder.prototype.addFieldInt32=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt32(t),this.slot(e))};h.Builder.prototype.addFieldInt64=function(e,t,r){(this.force_defaults||!t.equals(r))&&(this.addInt64(t),this.slot(e))};h.Builder.prototype.addFieldFloat32=function(e,t,r){(this.force_defaults||t!=r)&&(this.addFloat32(t),this.slot(e))};h.Builder.prototype.addFieldFloat64=function(e,t,r){(this.force_defaults||t!=r)&&(this.addFloat64(t),this.slot(e))};h.Builder.prototype.addFieldOffset=function(e,t,r){(this.force_defaults||t!=r)&&(this.addOffset(t),this.slot(e))};h.Builder.prototype.addFieldStruct=function(e,t,r){t!=r&&(this.nested(t),this.slot(e))};h.Builder.prototype.nested=function(e){if(e!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")};h.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")};h.Builder.prototype.slot=function(e){this.vtable[e]=this.offset()};h.Builder.prototype.offset=function(){return this.bb.capacity()-this.space};h.Builder.growByteBuffer=function(e){var t=e.capacity();if(t&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var r=t<<1,n=h.ByteBuffer.allocate(r);return n.setPosition(r-t),n.bytes().set(e.bytes(),r-t),n};h.Builder.prototype.addOffset=function(e){this.prep(h.SIZEOF_INT,0),this.writeInt32(this.offset()-e+h.SIZEOF_INT)};h.Builder.prototype.startObject=function(e){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=e;for(var t=0;t<e;t++)this.vtable[t]=0;this.isNested=!0,this.object_start=this.offset()};h.Builder.prototype.endObject=function(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var e=this.offset(),t=this.vtable_in_use-1;t>=0&&this.vtable[t]==0;t--);for(var r=t+1;t>=0;t--)this.addInt16(this.vtable[t]!=0?e-this.vtable[t]:0);var n=2;this.addInt16(e-this.object_start);var s=(r+n)*h.SIZEOF_SHORT;this.addInt16(s);var a=0,i=this.space;t:for(t=0;t<this.vtables.length;t++){var o=this.bb.capacity()-this.vtables[t];if(s==this.bb.readInt16(o)){for(var c=h.SIZEOF_SHORT;c<s;c+=h.SIZEOF_SHORT)if(this.bb.readInt16(i+c)!=this.bb.readInt16(o+c))continue t;a=this.vtables[t];break}}return a?(this.space=this.bb.capacity()-e,this.bb.writeInt32(this.space,a-e)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-e,this.offset()-e)),this.isNested=!1,e};h.Builder.prototype.finish=function(e,t){if(t){var r=t;if(this.prep(this.minalign,h.SIZEOF_INT+h.FILE_IDENTIFIER_LENGTH),r.length!=h.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+h.FILE_IDENTIFIER_LENGTH);for(var n=h.FILE_IDENTIFIER_LENGTH-1;n>=0;n--)this.writeInt8(r.charCodeAt(n))}this.prep(this.minalign,h.SIZEOF_INT),this.addOffset(e),this.bb.setPosition(this.space)};h.Builder.prototype.requiredField=function(e,t){var r=this.bb.capacity()-e,n=r-this.bb.readInt32(r),s=this.bb.readInt16(n+t)!=0;if(!s)throw new Error("FlatBuffers: field "+t+" must be set")};h.Builder.prototype.startVector=function(e,t,r){this.notNested(),this.vector_num_elems=t,this.prep(h.SIZEOF_INT,e*t),this.prep(r,e*t)};h.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()};h.Builder.prototype.createString=function(e){if(e instanceof Uint8Array)var t=e;else for(var t=[],r=0;r<e.length;){var n,s=e.charCodeAt(r++);if(s<55296||s>=56320)n=s;else{var a=e.charCodeAt(r++);n=(s<<10)+a+(65536-(55296<<10)-56320)}n<128?t.push(n):(n<2048?t.push(n>>6&31|192):(n<65536?t.push(n>>12&15|224):t.push(n>>18&7|240,n>>12&63|128),t.push(n>>6&63|128)),t.push(n&63|128))}this.addInt8(0),this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length);for(var r=0,i=this.space,o=this.bb.bytes();r<t.length;r++)o[i++]=t[r];return this.endVector()};h.Builder.prototype.createLong=function(e,t){return h.Long.create(e,t)};h.ByteBuffer=function(e){this.bytes_=e,this.position_=0};h.ByteBuffer.allocate=function(e){return new h.ByteBuffer(new Uint8Array(e))};h.ByteBuffer.prototype.clear=function(){this.position_=0};h.ByteBuffer.prototype.bytes=function(){return this.bytes_};h.ByteBuffer.prototype.position=function(){return this.position_};h.ByteBuffer.prototype.setPosition=function(e){this.position_=e};h.ByteBuffer.prototype.capacity=function(){return this.bytes_.length};h.ByteBuffer.prototype.readInt8=function(e){return this.readUint8(e)<<24>>24};h.ByteBuffer.prototype.readUint8=function(e){return this.bytes_[e]};h.ByteBuffer.prototype.readInt16=function(e){return this.readUint16(e)<<16>>16};h.ByteBuffer.prototype.readUint16=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8};h.ByteBuffer.prototype.readInt32=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24};h.ByteBuffer.prototype.readUint32=function(e){return this.readInt32(e)>>>0};h.ByteBuffer.prototype.readInt64=function(e){return new h.Long(this.readInt32(e),this.readInt32(e+4))};h.ByteBuffer.prototype.readUint64=function(e){return new h.Long(this.readUint32(e),this.readUint32(e+4))};h.ByteBuffer.prototype.readFloat32=function(e){return h.int32[0]=this.readInt32(e),h.float32[0]};h.ByteBuffer.prototype.readFloat64=function(e){return h.int32[h.isLittleEndian?0:1]=this.readInt32(e),h.int32[h.isLittleEndian?1:0]=this.readInt32(e+4),h.float64[0]};h.ByteBuffer.prototype.writeInt8=function(e,t){this.bytes_[e]=t};h.ByteBuffer.prototype.writeUint8=function(e,t){this.bytes_[e]=t};h.ByteBuffer.prototype.writeInt16=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8};h.ByteBuffer.prototype.writeUint16=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8};h.ByteBuffer.prototype.writeInt32=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24};h.ByteBuffer.prototype.writeUint32=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24};h.ByteBuffer.prototype.writeInt64=function(e,t){this.writeInt32(e,t.low),this.writeInt32(e+4,t.high)};h.ByteBuffer.prototype.writeUint64=function(e,t){this.writeUint32(e,t.low),this.writeUint32(e+4,t.high)};h.ByteBuffer.prototype.writeFloat32=function(e,t){h.float32[0]=t,this.writeInt32(e,h.int32[0])};h.ByteBuffer.prototype.writeFloat64=function(e,t){h.float64[0]=t,this.writeInt32(e,h.int32[h.isLittleEndian?0:1]),this.writeInt32(e+4,h.int32[h.isLittleEndian?1:0])};h.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+h.SIZEOF_INT+h.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var e="",t=0;t<h.FILE_IDENTIFIER_LENGTH;t++)e+=String.fromCharCode(this.readInt8(this.position_+h.SIZEOF_INT+t));return e};h.ByteBuffer.prototype.__offset=function(e,t){var r=e-this.readInt32(e);return t<this.readInt16(r)?this.readInt16(r+t):0};h.ByteBuffer.prototype.__union=function(e,t){return e.bb_pos=t+this.readInt32(t),e.bb=this,e};h.ByteBuffer.prototype.__string=function(e,t){e+=this.readInt32(e);var r=this.readInt32(e),n="",s=0;if(e+=h.SIZEOF_INT,t===h.Encoding.UTF8_BYTES)return this.bytes_.subarray(e,e+r);for(;s<r;){var a,i=this.readUint8(e+s++);if(i<192)a=i;else{var o=this.readUint8(e+s++);if(i<224)a=(i&31)<<6|o&63;else{var c=this.readUint8(e+s++);if(i<240)a=(i&15)<<12|(o&63)<<6|c&63;else{var u=this.readUint8(e+s++);a=(i&7)<<18|(o&63)<<12|(c&63)<<6|u&63}}}a<65536?n+=String.fromCharCode(a):(a-=65536,n+=String.fromCharCode((a>>10)+55296,(a&(1<<10)-1)+56320))}return n};h.ByteBuffer.prototype.__indirect=function(e){return e+this.readInt32(e)};h.ByteBuffer.prototype.__vector=function(e){return e+this.readInt32(e)+h.SIZEOF_INT};h.ByteBuffer.prototype.__vector_len=function(e){return this.readInt32(e+this.readInt32(e))};h.ByteBuffer.prototype.__has_identifier=function(e){if(e.length!=h.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+h.FILE_IDENTIFIER_LENGTH);for(var t=0;t<h.FILE_IDENTIFIER_LENGTH;t++)if(e.charCodeAt(t)!=this.readInt8(this.position_+h.SIZEOF_INT+t))return!1;return!0};h.ByteBuffer.prototype.createLong=function(e,t){return h.Long.create(e,t)};function Ut(e,t,r){return t<=e&&e<=r}function rn(e){if(e===void 0)return{};if(e===Object(e))return e;throw TypeError("Could not convert argument to dictionary")}function Dc(e){for(var t=String(e),r=t.length,n=0,s=[];n<r;){var a=t.charCodeAt(n);if(a<55296||a>57343)s.push(a);else if(56320<=a&&a<=57343)s.push(65533);else if(55296<=a&&a<=56319)if(n===r-1)s.push(65533);else{var i=e.charCodeAt(n+1);if(56320<=i&&i<=57343){var o=a&1023,c=i&1023;s.push(65536+(o<<10)+c),n+=1}else s.push(65533)}n+=1}return s}function xc(e){for(var t="",r=0;r<e.length;++r){var n=e[r];n<=65535?t+=String.fromCharCode(n):(n-=65536,t+=String.fromCharCode((n>>10)+55296,(n&1023)+56320))}return t}var Fr=-1;function ri(e){this.tokens=[].slice.call(e)}ri.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():Fr},prepend:function(e){if(Array.isArray(e))for(var t=e;t.length;)this.tokens.unshift(t.pop());else this.tokens.unshift(e)},push:function(e){if(Array.isArray(e))for(var t=e;t.length;)this.tokens.push(t.shift());else this.tokens.push(e)}};var we=-1;function wn(e,t){if(e)throw TypeError("Decoder error");return t||65533}var Or="utf-8";function Dr(e,t){if(!(this instanceof Dr))return new Dr(e,t);if(e=e!==void 0?String(e).toLowerCase():Or,e!==Or)throw new Error("Encoding not supported. Only utf-8 is supported");t=rn(t),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=Boolean(t.fatal),this._ignoreBOM=Boolean(t.ignoreBOM),Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}Dr.prototype={decode:function(t,r){var n;typeof t=="object"&&t instanceof ArrayBuffer?n=new Uint8Array(t):typeof t=="object"&&"buffer"in t&&t.buffer instanceof ArrayBuffer?n=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):n=new Uint8Array(0),r=rn(r),this._streaming||(this._decoder=new Lc({fatal:this._fatal}),this._BOMseen=!1),this._streaming=Boolean(r.stream);for(var s=new ri(n),a=[],i;!s.endOfStream()&&(i=this._decoder.handler(s,s.read()),i!==we);)i!==null&&(Array.isArray(i)?a.push.apply(a,i):a.push(i));if(!this._streaming){do{if(i=this._decoder.handler(s,s.read()),i===we)break;i!==null&&(Array.isArray(i)?a.push.apply(a,i):a.push(i))}while(!s.endOfStream());this._decoder=null}return a.length&&["utf-8"].indexOf(this.encoding)!==-1&&!this._ignoreBOM&&!this._BOMseen&&(a[0]===65279?(this._BOMseen=!0,a.shift()):this._BOMseen=!0),xc(a)}};function xr(e,t){if(!(this instanceof xr))return new xr(e,t);if(e=e!==void 0?String(e).toLowerCase():Or,e!==Or)throw new Error("Encoding not supported. Only utf-8 is supported");t=rn(t),this._streaming=!1,this._encoder=null,this._options={fatal:Boolean(t.fatal)},Object.defineProperty(this,"encoding",{value:"utf-8"})}xr.prototype={encode:function(t,r){t=t?String(t):"",r=rn(r),this._streaming||(this._encoder=new Mc(this._options)),this._streaming=Boolean(r.stream);for(var n=[],s=new ri(Dc(t)),a;!s.endOfStream()&&(a=this._encoder.handler(s,s.read()),a!==we);)Array.isArray(a)?n.push.apply(n,a):n.push(a);if(!this._streaming){for(;a=this._encoder.handler(s,s.read()),a!==we;)Array.isArray(a)?n.push.apply(n,a):n.push(a);this._encoder=null}return new Uint8Array(n)}};function Lc(e){var t=e.fatal,r=0,n=0,s=0,a=128,i=191;this.handler=function(o,c){if(c===Fr&&s!==0)return s=0,wn(t);if(c===Fr)return we;if(s===0){if(Ut(c,0,127))return c;if(Ut(c,194,223))s=1,r=c-192;else if(Ut(c,224,239))c===224&&(a=160),c===237&&(i=159),s=2,r=c-224;else if(Ut(c,240,244))c===240&&(a=144),c===244&&(i=143),s=3,r=c-240;else return wn(t);return r=r<<6*s,null}if(!Ut(c,a,i))return r=s=n=0,a=128,i=191,o.prepend(c),wn(t);if(a=128,i=191,n+=1,r+=c-128<<6*(s-n),n!==s)return null;var u=r;return r=s=n=0,u}}function Mc(e){e.fatal,this.handler=function(t,r){if(r===Fr)return we;if(Ut(r,0,127))return r;var n,s;Ut(r,128,2047)?(n=1,s=192):Ut(r,2048,65535)?(n=2,s=224):Ut(r,65536,1114111)&&(n=3,s=240);for(var a=[(r>>6*n)+s];n>0;){var i=r>>6*(n-1);a.push(128|i&63),n-=1}return a}}const Lr=typeof Buffer=="function"?Buffer:null,Zs=typeof TextDecoder=="function"&&typeof TextEncoder=="function",Rn=(e=>{if(Zs||!Lr){const t=new e("utf-8");return r=>t.decode(r)}return t=>{const{buffer:r,byteOffset:n,length:s}=x(t);return Lr.from(r,n,s).toString()}})(typeof TextDecoder<"u"?TextDecoder:Dr),nn=(e=>{if(Zs||!Lr){const t=new e;return r=>t.encode(r)}return(t="")=>x(Lr.from(t,"utf8"))})(typeof TextEncoder<"u"?TextEncoder:xr),$=Object.freeze({done:!0,value:void 0});class is{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class ie{tee(){return this._getDOMStream().tee()}pipe(t,r){return this._getNodeStream().pipe(t,r)}pipeTo(t,r){return this._getDOMStream().pipeTo(t,r)}pipeThrough(t,r){return this._getDOMStream().pipeThrough(t,r)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class Uc extends ie{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(t=>this._closedPromiseResolve=t)}get closed(){return this._closedPromise}async cancel(t){await this.return(t)}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){const{resolvers:t}=this;for(;t.length>0;)t.shift().resolve($);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return it.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return it.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}async throw(t){return await this.abort(t),$}async return(t){return await this.close(),$}async read(t){return(await this.next(t,"read")).value}async peek(t){return(await this.next(t,"peek")).value}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((r,n)=>{this.resolvers.push({resolve:r,reject:n})}):Promise.resolve($)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error(`${this} is closed`)}}const[Ec,sn]=(()=>{const e=()=>{throw new Error("BigInt is not available in this environment")};function t(){throw e()}return t.asIntN=()=>{throw e()},t.asUintN=()=>{throw e()},typeof BigInt<"u"?[BigInt,!0]:[t,!1]})(),[Le,Ld]=(()=>{const e=()=>{throw new Error("BigInt64Array is not available in this environment")};class t{static get BYTES_PER_ELEMENT(){return 8}static of(){throw e()}static from(){throw e()}constructor(){throw e()}}return typeof BigInt64Array<"u"?[BigInt64Array,!0]:[t,!1]})(),[Xe,Md]=(()=>{const e=()=>{throw new Error("BigUint64Array is not available in this environment")};class t{static get BYTES_PER_ELEMENT(){return 8}static of(){throw e()}static from(){throw e()}constructor(){throw e()}}return typeof BigUint64Array<"u"?[BigUint64Array,!0]:[t,!1]})(),Nc=e=>typeof e=="number",Qs=e=>typeof e=="boolean",lt=e=>typeof e=="function",at=e=>e!=null&&Object(e)===e,Yt=e=>at(e)&&lt(e.then),mt=e=>at(e)&&lt(e[Symbol.iterator]),Ct=e=>at(e)&&lt(e[Symbol.asyncIterator]),kn=e=>at(e)&&at(e.schema),Xs=e=>at(e)&&"done"in e&&"value"in e,ta=e=>at(e)&&lt(e.stat)&&Nc(e.fd),ea=e=>at(e)&&ni(e.body),Vc=e=>at(e)&&lt(e.abort)&&lt(e.getWriter)&&!(e instanceof ie),ni=e=>at(e)&&lt(e.cancel)&&lt(e.getReader)&&!(e instanceof ie),Cc=e=>at(e)&&lt(e.end)&&lt(e.write)&&Qs(e.writable)&&!(e instanceof ie),ra=e=>at(e)&&lt(e.read)&&lt(e.pipe)&&Qs(e.readable)&&!(e instanceof ie);var Rc=h.ByteBuffer;const ii=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function kc(e){let t=e[0]?[e[0]]:[],r,n,s,a;for(let i,o,c=0,u=0,d=e.length;++c<d;){if(i=t[u],o=e[c],!i||!o||i.buffer!==o.buffer||o.byteOffset<i.byteOffset){o&&(t[++u]=o);continue}if({byteOffset:r,byteLength:s}=i,{byteOffset:n,byteLength:a}=o,r+s<n||n+a<r){o&&(t[++u]=o);continue}t[u]=new Uint8Array(i.buffer,r,n-r+a)}return t}function ke(e,t,r=0,n=t.byteLength){const s=e.byteLength,a=new Uint8Array(e.buffer,e.byteOffset,s),i=new Uint8Array(t.buffer,t.byteOffset,Math.min(n,s));return a.set(i,r),e}function gt(e,t){let r=kc(e),n=r.reduce((d,y)=>d+y.byteLength,0),s,a,i,o=0,c=-1,u=Math.min(t||1/0,n);for(let d=r.length;++c<d;){if(s=r[c],a=s.subarray(0,Math.min(s.length,u-o)),u<=o+a.length){a.length<s.length?r[c]=s.subarray(a.length):a.length===s.length&&c++,i?ke(i,a,o):i=a;break}ke(i||(i=new Uint8Array(u)),a,o),o+=a.length}return[i||new Uint8Array(0),r.slice(c),n-(i?i.byteLength:0)]}function O(e,t){let r=Xs(t)?t.value:t;return r instanceof e?e===Uint8Array?new e(r.buffer,r.byteOffset,r.byteLength):r:r?(typeof r=="string"&&(r=nn(r)),r instanceof ArrayBuffer?new e(r):r instanceof ii?new e(r):r instanceof Rc?O(e,r.bytes()):ArrayBuffer.isView(r)?r.byteLength<=0?new e(0):new e(r.buffer,r.byteOffset,r.byteLength/e.BYTES_PER_ELEMENT):e.from(r)):new e(0)}const jc=e=>O(Int8Array,e),zc=e=>O(Int16Array,e),he=e=>O(Int32Array,e),na=e=>O(Le,e),x=e=>O(Uint8Array,e),Pc=e=>O(Uint16Array,e),$c=e=>O(Uint32Array,e),ia=e=>O(Xe,e),Wc=e=>O(Float32Array,e),Yc=e=>O(Float64Array,e),Hc=e=>O(Uint8ClampedArray,e),jn=e=>(e.next(),e);function*Dt(e,t){const r=function*(s){yield s},n=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof ii?r(t):mt(t)?t:r(t);yield*jn(function*(s){let a=null;do a=s.next(yield O(e,a));while(!a.done)}(n[Symbol.iterator]()))}const Kc=e=>Dt(Int8Array,e),Jc=e=>Dt(Int16Array,e),Gc=e=>Dt(Int32Array,e),sa=e=>Dt(Uint8Array,e),qc=e=>Dt(Uint16Array,e),Zc=e=>Dt(Uint32Array,e),Qc=e=>Dt(Float32Array,e),Xc=e=>Dt(Float64Array,e),tu=e=>Dt(Uint8ClampedArray,e);async function*vt(e,t){if(Yt(t))return yield*vt(e,await t);const r=async function*(a){yield await a},n=async function*(a){yield*jn(function*(i){let o=null;do o=i.next(yield o&&o.value);while(!o.done)}(a[Symbol.iterator]()))},s=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof ii?r(t):mt(t)?n(t):Ct(t)?t:r(t);yield*jn(async function*(a){let i=null;do i=await a.next(yield O(e,i));while(!i.done)}(s[Symbol.asyncIterator]()))}const eu=e=>vt(Int8Array,e),ru=e=>vt(Int16Array,e),nu=e=>vt(Int32Array,e),aa=e=>vt(Uint8Array,e),iu=e=>vt(Uint16Array,e),su=e=>vt(Uint32Array,e),au=e=>vt(Float32Array,e),ou=e=>vt(Float64Array,e),cu=e=>vt(Uint8ClampedArray,e);function an(e,t,r){if(e!==0){r=r.slice(0,t+1);for(let n=-1;++n<=t;)r[n]+=e}return r}function oa(e,t){let r=0,n=e.length;if(n!==t.length)return!1;if(n>0)do if(e[r]!==t[r])return!1;while(++r<n);return!0}const uu=Object.freeze(Object.defineProperty({__proto__:null,memcpy:ke,joinUint8Arrays:gt,toArrayBufferView:O,toInt8Array:jc,toInt16Array:zc,toInt32Array:he,toBigInt64Array:na,toUint8Array:x,toUint16Array:Pc,toUint32Array:$c,toBigUint64Array:ia,toFloat32Array:Wc,toFloat64Array:Yc,toUint8ClampedArray:Hc,toArrayBufferViewIterator:Dt,toInt8ArrayIterator:Kc,toInt16ArrayIterator:Jc,toInt32ArrayIterator:Gc,toUint8ArrayIterator:sa,toUint16ArrayIterator:qc,toUint32ArrayIterator:Zc,toFloat32ArrayIterator:Qc,toFloat64ArrayIterator:Xc,toUint8ClampedArrayIterator:tu,toArrayBufferViewAsyncIterator:vt,toInt8ArrayAsyncIterator:eu,toInt16ArrayAsyncIterator:ru,toInt32ArrayAsyncIterator:nu,toUint8ArrayAsyncIterator:aa,toUint16ArrayAsyncIterator:iu,toUint32ArrayAsyncIterator:su,toFloat32ArrayAsyncIterator:au,toFloat64ArrayAsyncIterator:ou,toUint8ClampedArrayAsyncIterator:cu,rebaseValueOffsets:an,compareArrayLike:oa},Symbol.toStringTag,{value:"Module"})),it={fromIterable(e){return dr(lu(e))},fromAsyncIterable(e){return dr(hu(e))},fromDOMStream(e){return dr(fu(e))},fromNodeStream(e){return dr(pu(e))},toDOMStream(e,t){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(e,t){throw new Error('"toNodeStream" not available in this environment')}},dr=e=>(e.next(),e);function*lu(e){let t,r=!1,n=[],s,a,i,o=0;function c(){return a==="peek"?gt(n,i)[0]:([s,n,o]=gt(n,i),s)}({cmd:a,size:i}=yield null);let u=sa(e)[Symbol.iterator]();try{do if({done:t,value:s}=isNaN(i-o)?u.next(void 0):u.next(i-o),!t&&s.byteLength>0&&(n.push(s),o+=s.byteLength),t||i<=o)do({cmd:a,size:i}=yield c());while(i<o);while(!t)}catch(d){(r=!0)&&typeof u.throw=="function"&&u.throw(d)}finally{r===!1&&typeof u.return=="function"&&u.return()}}async function*hu(e){let t,r=!1,n=[],s,a,i,o=0;function c(){return a==="peek"?gt(n,i)[0]:([s,n,o]=gt(n,i),s)}({cmd:a,size:i}=yield null);let u=aa(e)[Symbol.asyncIterator]();try{do if({done:t,value:s}=isNaN(i-o)?await u.next(void 0):await u.next(i-o),!t&&s.byteLength>0&&(n.push(s),o+=s.byteLength),t||i<=o)do({cmd:a,size:i}=yield c());while(i<o);while(!t)}catch(d){(r=!0)&&typeof u.throw=="function"&&await u.throw(d)}finally{r===!1&&typeof u.return=="function"&&await u.return()}}async function*fu(e){let t=!1,r=!1,n=[],s,a,i,o=0;function c(){return a==="peek"?gt(n,i)[0]:([s,n,o]=gt(n,i),s)}({cmd:a,size:i}=yield null);let u=new du(e);try{do if({done:t,value:s}=isNaN(i-o)?await u.read(void 0):await u.read(i-o),!t&&s.byteLength>0&&(n.push(x(s)),o+=s.byteLength),t||i<=o)do({cmd:a,size:i}=yield c());while(i<o);while(!t)}catch(d){(r=!0)&&await u.cancel(d)}finally{r===!1?await u.cancel():e.locked&&u.releaseLock()}}class du{constructor(t){this.source=t,this.byobReader=null,this.defaultReader=null;try{this.supportsBYOB=!!(this.reader=this.getBYOBReader())}catch{this.supportsBYOB=!(this.reader=this.getDefaultReader())}}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=this.byobReader=this.defaultReader=null}async cancel(t){const{reader:r,source:n}=this;r&&await r.cancel(t).catch(()=>{}),n&&n.locked&&this.releaseLock()}async read(t){if(t===0)return{done:this.reader==null,value:new Uint8Array(0)};const r=!this.supportsBYOB||typeof t!="number"?await this.getDefaultReader().read():await this.readFromBYOBReader(t);return!r.done&&(r.value=x(r)),r}getDefaultReader(){return this.byobReader&&this.releaseLock(),this.defaultReader||(this.defaultReader=this.source.getReader(),this.defaultReader.closed.catch(()=>{})),this.reader=this.defaultReader}getBYOBReader(){return this.defaultReader&&this.releaseLock(),this.byobReader||(this.byobReader=this.source.getReader({mode:"byob"}),this.byobReader.closed.catch(()=>{})),this.reader=this.byobReader}async readFromBYOBReader(t){return await ca(this.getBYOBReader(),new ArrayBuffer(t),0,t)}}async function ca(e,t,r,n){if(r>=n)return{done:!1,value:new Uint8Array(t,0,n)};const{done:s,value:a}=await e.read(new Uint8Array(t,r,n-r));return(r+=a.byteLength)<n&&!s?await ca(e,a.buffer,r,n):{done:s,value:new Uint8Array(a.buffer,0,r)}}const vn=(e,t)=>{let r=s=>n([t,s]),n;return[t,r,new Promise(s=>(n=s)&&e.once(t,r))]};async function*pu(e){let t=[],r="error",n=!1,s=null,a,i,o=0,c=[],u;function d(){return a==="peek"?gt(c,i)[0]:([u,c,o]=gt(c,i),u)}if({cmd:a,size:i}=yield null,e.isTTY)return yield new Uint8Array(0);try{t[0]=vn(e,"end"),t[1]=vn(e,"error");do{if(t[2]=vn(e,"readable"),[r,s]=await Promise.race(t.map(F=>F[2])),r==="error")break;if((n=r==="end")||(isFinite(i-o)?(u=x(e.read(i-o)),u.byteLength<i-o&&(u=x(e.read(void 0)))):u=x(e.read(void 0)),u.byteLength>0&&(c.push(u),o+=u.byteLength)),n||i<=o)do({cmd:a,size:i}=yield d());while(i<o)}while(!n)}finally{await y(t,r==="error"?s:null)}function y(F,U){return u=c=null,new Promise(async(Bt,fr)=>{for(const[ce,Yo]of F)e.off(ce,Yo);try{const ce=e.destroy;ce&&ce.call(e,U),U=void 0}catch(ce){U=ce||U}finally{U!=null?fr(U):Bt()}})}}class L{}var f;(function(e){(function(t){(function(r){(function(n){(function(s){s[s.V1=0]="V1",s[s.V2=1]="V2",s[s.V3=2]="V3",s[s.V4=3]="V4"})(n.MetadataVersion||(n.MetadataVersion={}))})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){(function(s){s[s.Sparse=0]="Sparse",s[s.Dense=1]="Dense"})(n.UnionMode||(n.UnionMode={}))})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){(function(s){s[s.HALF=0]="HALF",s[s.SINGLE=1]="SINGLE",s[s.DOUBLE=2]="DOUBLE"})(n.Precision||(n.Precision={}))})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){(function(s){s[s.DAY=0]="DAY",s[s.MILLISECOND=1]="MILLISECOND"})(n.DateUnit||(n.DateUnit={}))})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){(function(s){s[s.SECOND=0]="SECOND",s[s.MILLISECOND=1]="MILLISECOND",s[s.MICROSECOND=2]="MICROSECOND",s[s.NANOSECOND=3]="NANOSECOND"})(n.TimeUnit||(n.TimeUnit={}))})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){(function(s){s[s.YEAR_MONTH=0]="YEAR_MONTH",s[s.DAY_TIME=1]="DAY_TIME"})(n.IntervalUnit||(n.IntervalUnit={}))})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){(function(s){s[s.NONE=0]="NONE",s[s.Null=1]="Null",s[s.Int=2]="Int",s[s.FloatingPoint=3]="FloatingPoint",s[s.Binary=4]="Binary",s[s.Utf8=5]="Utf8",s[s.Bool=6]="Bool",s[s.Decimal=7]="Decimal",s[s.Date=8]="Date",s[s.Time=9]="Time",s[s.Timestamp=10]="Timestamp",s[s.Interval=11]="Interval",s[s.List=12]="List",s[s.Struct_=13]="Struct_",s[s.Union=14]="Union",s[s.FixedSizeBinary=15]="FixedSizeBinary",s[s.FixedSizeList=16]="FixedSizeList",s[s.Map=17]="Map",s[s.Duration=18]="Duration",s[s.LargeBinary=19]="LargeBinary",s[s.LargeUtf8=20]="LargeUtf8",s[s.LargeList=21]="LargeList"})(n.Type||(n.Type={}))})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){(function(s){s[s.Little=0]="Little",s[s.Big=1]="Big"})(n.Endianness||(n.Endianness={}))})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsNull(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}static startNull(i){i.startObject(0)}static endNull(i){return i.endObject()}static createNull(i){return s.startNull(i),s.endNull(i)}}n.Null=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsStruct_(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}static startStruct_(i){i.startObject(0)}static endStruct_(i){return i.endObject()}static createStruct_(i){return s.startStruct_(i),s.endStruct_(i)}}n.Struct_=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsList(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}static startList(i){i.startObject(0)}static endList(i){return i.endObject()}static createList(i){return s.startList(i),s.endList(i)}}n.List=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsLargeList(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}static startLargeList(i){i.startObject(0)}static endLargeList(i){return i.endObject()}static createLargeList(i){return s.startLargeList(i),s.endLargeList(i)}}n.LargeList=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsFixedSizeList(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}listSize(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt32(this.bb_pos+i):0}static startFixedSizeList(i){i.startObject(1)}static addListSize(i,o){i.addFieldInt32(0,o,0)}static endFixedSizeList(i){return i.endObject()}static createFixedSizeList(i,o){return s.startFixedSizeList(i),s.addListSize(i,o),s.endFixedSizeList(i)}}n.FixedSizeList=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsMap(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}keysSorted(){let i=this.bb.__offset(this.bb_pos,4);return i?!!this.bb.readInt8(this.bb_pos+i):!1}static startMap(i){i.startObject(1)}static addKeysSorted(i,o){i.addFieldInt8(0,+o,0)}static endMap(i){return i.endObject()}static createMap(i,o){return s.startMap(i),s.addKeysSorted(i,o),s.endMap(i)}}n.Map=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsUnion(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}mode(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):e.apache.arrow.flatbuf.UnionMode.Sparse}typeIds(i){let o=this.bb.__offset(this.bb_pos,6);return o?this.bb.readInt32(this.bb.__vector(this.bb_pos+o)+i*4):0}typeIdsLength(){let i=this.bb.__offset(this.bb_pos,6);return i?this.bb.__vector_len(this.bb_pos+i):0}typeIdsArray(){let i=this.bb.__offset(this.bb_pos,6);return i?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+i),this.bb.__vector_len(this.bb_pos+i)):null}static startUnion(i){i.startObject(2)}static addMode(i,o){i.addFieldInt16(0,o,e.apache.arrow.flatbuf.UnionMode.Sparse)}static addTypeIds(i,o){i.addFieldOffset(1,o,0)}static createTypeIdsVector(i,o){i.startVector(4,o.length,4);for(let c=o.length-1;c>=0;c--)i.addInt32(o[c]);return i.endVector()}static startTypeIdsVector(i,o){i.startVector(4,o,4)}static endUnion(i){return i.endObject()}static createUnion(i,o,c){return s.startUnion(i),s.addMode(i,o),s.addTypeIds(i,c),s.endUnion(i)}}n.Union=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsInt(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}bitWidth(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt32(this.bb_pos+i):0}isSigned(){let i=this.bb.__offset(this.bb_pos,6);return i?!!this.bb.readInt8(this.bb_pos+i):!1}static startInt(i){i.startObject(2)}static addBitWidth(i,o){i.addFieldInt32(0,o,0)}static addIsSigned(i,o){i.addFieldInt8(1,+o,0)}static endInt(i){return i.endObject()}static createInt(i,o,c){return s.startInt(i),s.addBitWidth(i,o),s.addIsSigned(i,c),s.endInt(i)}}n.Int=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsFloatingPoint(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}precision(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):e.apache.arrow.flatbuf.Precision.HALF}static startFloatingPoint(i){i.startObject(1)}static addPrecision(i,o){i.addFieldInt16(0,o,e.apache.arrow.flatbuf.Precision.HALF)}static endFloatingPoint(i){return i.endObject()}static createFloatingPoint(i,o){return s.startFloatingPoint(i),s.addPrecision(i,o),s.endFloatingPoint(i)}}n.FloatingPoint=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsUtf8(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}static startUtf8(i){i.startObject(0)}static endUtf8(i){return i.endObject()}static createUtf8(i){return s.startUtf8(i),s.endUtf8(i)}}n.Utf8=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsBinary(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}static startBinary(i){i.startObject(0)}static endBinary(i){return i.endObject()}static createBinary(i){return s.startBinary(i),s.endBinary(i)}}n.Binary=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsLargeUtf8(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}static startLargeUtf8(i){i.startObject(0)}static endLargeUtf8(i){return i.endObject()}static createLargeUtf8(i){return s.startLargeUtf8(i),s.endLargeUtf8(i)}}n.LargeUtf8=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsLargeBinary(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}static startLargeBinary(i){i.startObject(0)}static endLargeBinary(i){return i.endObject()}static createLargeBinary(i){return s.startLargeBinary(i),s.endLargeBinary(i)}}n.LargeBinary=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsFixedSizeBinary(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}byteWidth(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt32(this.bb_pos+i):0}static startFixedSizeBinary(i){i.startObject(1)}static addByteWidth(i,o){i.addFieldInt32(0,o,0)}static endFixedSizeBinary(i){return i.endObject()}static createFixedSizeBinary(i,o){return s.startFixedSizeBinary(i),s.addByteWidth(i,o),s.endFixedSizeBinary(i)}}n.FixedSizeBinary=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsBool(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}static startBool(i){i.startObject(0)}static endBool(i){return i.endObject()}static createBool(i){return s.startBool(i),s.endBool(i)}}n.Bool=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsDecimal(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}precision(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt32(this.bb_pos+i):0}scale(){let i=this.bb.__offset(this.bb_pos,6);return i?this.bb.readInt32(this.bb_pos+i):0}static startDecimal(i){i.startObject(2)}static addPrecision(i,o){i.addFieldInt32(0,o,0)}static addScale(i,o){i.addFieldInt32(1,o,0)}static endDecimal(i){return i.endObject()}static createDecimal(i,o,c){return s.startDecimal(i),s.addPrecision(i,o),s.addScale(i,c),s.endDecimal(i)}}n.Decimal=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsDate(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}unit(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):e.apache.arrow.flatbuf.DateUnit.MILLISECOND}static startDate(i){i.startObject(1)}static addUnit(i,o){i.addFieldInt16(0,o,e.apache.arrow.flatbuf.DateUnit.MILLISECOND)}static endDate(i){return i.endObject()}static createDate(i,o){return s.startDate(i),s.addUnit(i,o),s.endDate(i)}}n.Date=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsTime(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}unit(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):e.apache.arrow.flatbuf.TimeUnit.MILLISECOND}bitWidth(){let i=this.bb.__offset(this.bb_pos,6);return i?this.bb.readInt32(this.bb_pos+i):32}static startTime(i){i.startObject(2)}static addUnit(i,o){i.addFieldInt16(0,o,e.apache.arrow.flatbuf.TimeUnit.MILLISECOND)}static addBitWidth(i,o){i.addFieldInt32(1,o,32)}static endTime(i){return i.endObject()}static createTime(i,o,c){return s.startTime(i),s.addUnit(i,o),s.addBitWidth(i,c),s.endTime(i)}}n.Time=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsTimestamp(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}unit(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):e.apache.arrow.flatbuf.TimeUnit.SECOND}timezone(i){let o=this.bb.__offset(this.bb_pos,6);return o?this.bb.__string(this.bb_pos+o,i):null}static startTimestamp(i){i.startObject(2)}static addUnit(i,o){i.addFieldInt16(0,o,e.apache.arrow.flatbuf.TimeUnit.SECOND)}static addTimezone(i,o){i.addFieldOffset(1,o,0)}static endTimestamp(i){return i.endObject()}static createTimestamp(i,o,c){return s.startTimestamp(i),s.addUnit(i,o),s.addTimezone(i,c),s.endTimestamp(i)}}n.Timestamp=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsInterval(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}unit(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):e.apache.arrow.flatbuf.IntervalUnit.YEAR_MONTH}static startInterval(i){i.startObject(1)}static addUnit(i,o){i.addFieldInt16(0,o,e.apache.arrow.flatbuf.IntervalUnit.YEAR_MONTH)}static endInterval(i){return i.endObject()}static createInterval(i,o){return s.startInterval(i),s.addUnit(i,o),s.endInterval(i)}}n.Interval=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsDuration(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}unit(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):e.apache.arrow.flatbuf.TimeUnit.MILLISECOND}static startDuration(i){i.startObject(1)}static addUnit(i,o){i.addFieldInt16(0,o,e.apache.arrow.flatbuf.TimeUnit.MILLISECOND)}static endDuration(i){return i.endObject()}static createDuration(i,o){return s.startDuration(i),s.addUnit(i,o),s.endDuration(i)}}n.Duration=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsKeyValue(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}key(i){let o=this.bb.__offset(this.bb_pos,4);return o?this.bb.__string(this.bb_pos+o,i):null}value(i){let o=this.bb.__offset(this.bb_pos,6);return o?this.bb.__string(this.bb_pos+o,i):null}static startKeyValue(i){i.startObject(2)}static addKey(i,o){i.addFieldOffset(0,o,0)}static addValue(i,o){i.addFieldOffset(1,o,0)}static endKeyValue(i){return i.endObject()}static createKeyValue(i,o,c){return s.startKeyValue(i),s.addKey(i,o),s.addValue(i,c),s.endKeyValue(i)}}n.KeyValue=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsDictionaryEncoding(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}id(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt64(this.bb_pos+i):this.bb.createLong(0,0)}indexType(i){let o=this.bb.__offset(this.bb_pos,6);return o?(i||new e.apache.arrow.flatbuf.Int).__init(this.bb.__indirect(this.bb_pos+o),this.bb):null}isOrdered(){let i=this.bb.__offset(this.bb_pos,8);return i?!!this.bb.readInt8(this.bb_pos+i):!1}static startDictionaryEncoding(i){i.startObject(3)}static addId(i,o){i.addFieldInt64(0,o,i.createLong(0,0))}static addIndexType(i,o){i.addFieldOffset(1,o,0)}static addIsOrdered(i,o){i.addFieldInt8(2,+o,0)}static endDictionaryEncoding(i){return i.endObject()}static createDictionaryEncoding(i,o,c,u){return s.startDictionaryEncoding(i),s.addId(i,o),s.addIndexType(i,c),s.addIsOrdered(i,u),s.endDictionaryEncoding(i)}}n.DictionaryEncoding=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsField(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}name(i){let o=this.bb.__offset(this.bb_pos,4);return o?this.bb.__string(this.bb_pos+o,i):null}nullable(){let i=this.bb.__offset(this.bb_pos,6);return i?!!this.bb.readInt8(this.bb_pos+i):!1}typeType(){let i=this.bb.__offset(this.bb_pos,8);return i?this.bb.readUint8(this.bb_pos+i):e.apache.arrow.flatbuf.Type.NONE}type(i){let o=this.bb.__offset(this.bb_pos,10);return o?this.bb.__union(i,this.bb_pos+o):null}dictionary(i){let o=this.bb.__offset(this.bb_pos,12);return o?(i||new e.apache.arrow.flatbuf.DictionaryEncoding).__init(this.bb.__indirect(this.bb_pos+o),this.bb):null}children(i,o){let c=this.bb.__offset(this.bb_pos,14);return c?(o||new e.apache.arrow.flatbuf.Field).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+c)+i*4),this.bb):null}childrenLength(){let i=this.bb.__offset(this.bb_pos,14);return i?this.bb.__vector_len(this.bb_pos+i):0}customMetadata(i,o){let c=this.bb.__offset(this.bb_pos,16);return c?(o||new e.apache.arrow.flatbuf.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+c)+i*4),this.bb):null}customMetadataLength(){let i=this.bb.__offset(this.bb_pos,16);return i?this.bb.__vector_len(this.bb_pos+i):0}static startField(i){i.startObject(7)}static addName(i,o){i.addFieldOffset(0,o,0)}static addNullable(i,o){i.addFieldInt8(1,+o,0)}static addTypeType(i,o){i.addFieldInt8(2,o,e.apache.arrow.flatbuf.Type.NONE)}static addType(i,o){i.addFieldOffset(3,o,0)}static addDictionary(i,o){i.addFieldOffset(4,o,0)}static addChildren(i,o){i.addFieldOffset(5,o,0)}static createChildrenVector(i,o){i.startVector(4,o.length,4);for(let c=o.length-1;c>=0;c--)i.addOffset(o[c]);return i.endVector()}static startChildrenVector(i,o){i.startVector(4,o,4)}static addCustomMetadata(i,o){i.addFieldOffset(6,o,0)}static createCustomMetadataVector(i,o){i.startVector(4,o.length,4);for(let c=o.length-1;c>=0;c--)i.addOffset(o[c]);return i.endVector()}static startCustomMetadataVector(i,o){i.startVector(4,o,4)}static endField(i){return i.endObject()}static createField(i,o,c,u,d,y,F,U){return s.startField(i),s.addName(i,o),s.addNullable(i,c),s.addTypeType(i,u),s.addType(i,d),s.addDictionary(i,y),s.addChildren(i,F),s.addCustomMetadata(i,U),s.endField(i)}}n.Field=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static createBuffer(i,o,c){return i.prep(8,16),i.writeInt64(c),i.writeInt64(o),i.offset()}}n.Buffer=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsSchema(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}endianness(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):e.apache.arrow.flatbuf.Endianness.Little}fields(i,o){let c=this.bb.__offset(this.bb_pos,6);return c?(o||new e.apache.arrow.flatbuf.Field).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+c)+i*4),this.bb):null}fieldsLength(){let i=this.bb.__offset(this.bb_pos,6);return i?this.bb.__vector_len(this.bb_pos+i):0}customMetadata(i,o){let c=this.bb.__offset(this.bb_pos,8);return c?(o||new e.apache.arrow.flatbuf.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+c)+i*4),this.bb):null}customMetadataLength(){let i=this.bb.__offset(this.bb_pos,8);return i?this.bb.__vector_len(this.bb_pos+i):0}static startSchema(i){i.startObject(3)}static addEndianness(i,o){i.addFieldInt16(0,o,e.apache.arrow.flatbuf.Endianness.Little)}static addFields(i,o){i.addFieldOffset(1,o,0)}static createFieldsVector(i,o){i.startVector(4,o.length,4);for(let c=o.length-1;c>=0;c--)i.addOffset(o[c]);return i.endVector()}static startFieldsVector(i,o){i.startVector(4,o,4)}static addCustomMetadata(i,o){i.addFieldOffset(2,o,0)}static createCustomMetadataVector(i,o){i.startVector(4,o.length,4);for(let c=o.length-1;c>=0;c--)i.addOffset(o[c]);return i.endVector()}static startCustomMetadataVector(i,o){i.startVector(4,o,4)}static endSchema(i){return i.endObject()}static finishSchemaBuffer(i,o){i.finish(o)}static createSchema(i,o,c,u){return s.startSchema(i),s.addEndianness(i,o),s.addFields(i,c),s.addCustomMetadata(i,u),s.endSchema(i)}}n.Schema=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(f||(f={}));var q;(function(e){(function(t){(function(r){(function(n){n.Schema=f.apache.arrow.flatbuf.Schema})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(q||(q={}));(function(e){(function(t){(function(r){(function(n){(function(s){s[s.NONE=0]="NONE",s[s.Schema=1]="Schema",s[s.DictionaryBatch=2]="DictionaryBatch",s[s.RecordBatch=3]="RecordBatch",s[s.Tensor=4]="Tensor",s[s.SparseTensor=5]="SparseTensor"})(n.MessageHeader||(n.MessageHeader={}))})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(q||(q={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static createFieldNode(i,o,c){return i.prep(8,16),i.writeInt64(c),i.writeInt64(o),i.offset()}}n.FieldNode=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(q||(q={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsRecordBatch(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}length(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt64(this.bb_pos+i):this.bb.createLong(0,0)}nodes(i,o){let c=this.bb.__offset(this.bb_pos,6);return c?(o||new e.apache.arrow.flatbuf.FieldNode).__init(this.bb.__vector(this.bb_pos+c)+i*16,this.bb):null}nodesLength(){let i=this.bb.__offset(this.bb_pos,6);return i?this.bb.__vector_len(this.bb_pos+i):0}buffers(i,o){let c=this.bb.__offset(this.bb_pos,8);return c?(o||new f.apache.arrow.flatbuf.Buffer).__init(this.bb.__vector(this.bb_pos+c)+i*16,this.bb):null}buffersLength(){let i=this.bb.__offset(this.bb_pos,8);return i?this.bb.__vector_len(this.bb_pos+i):0}static startRecordBatch(i){i.startObject(3)}static addLength(i,o){i.addFieldInt64(0,o,i.createLong(0,0))}static addNodes(i,o){i.addFieldOffset(1,o,0)}static startNodesVector(i,o){i.startVector(16,o,8)}static addBuffers(i,o){i.addFieldOffset(2,o,0)}static startBuffersVector(i,o){i.startVector(16,o,8)}static endRecordBatch(i){return i.endObject()}static createRecordBatch(i,o,c,u){return s.startRecordBatch(i),s.addLength(i,o),s.addNodes(i,c),s.addBuffers(i,u),s.endRecordBatch(i)}}n.RecordBatch=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(q||(q={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsDictionaryBatch(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}id(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt64(this.bb_pos+i):this.bb.createLong(0,0)}data(i){let o=this.bb.__offset(this.bb_pos,6);return o?(i||new e.apache.arrow.flatbuf.RecordBatch).__init(this.bb.__indirect(this.bb_pos+o),this.bb):null}isDelta(){let i=this.bb.__offset(this.bb_pos,8);return i?!!this.bb.readInt8(this.bb_pos+i):!1}static startDictionaryBatch(i){i.startObject(3)}static addId(i,o){i.addFieldInt64(0,o,i.createLong(0,0))}static addData(i,o){i.addFieldOffset(1,o,0)}static addIsDelta(i,o){i.addFieldInt8(2,+o,0)}static endDictionaryBatch(i){return i.endObject()}static createDictionaryBatch(i,o,c,u){return s.startDictionaryBatch(i),s.addId(i,o),s.addData(i,c),s.addIsDelta(i,u),s.endDictionaryBatch(i)}}n.DictionaryBatch=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(q||(q={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsMessage(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}version(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):f.apache.arrow.flatbuf.MetadataVersion.V1}headerType(){let i=this.bb.__offset(this.bb_pos,6);return i?this.bb.readUint8(this.bb_pos+i):e.apache.arrow.flatbuf.MessageHeader.NONE}header(i){let o=this.bb.__offset(this.bb_pos,8);return o?this.bb.__union(i,this.bb_pos+o):null}bodyLength(){let i=this.bb.__offset(this.bb_pos,10);return i?this.bb.readInt64(this.bb_pos+i):this.bb.createLong(0,0)}customMetadata(i,o){let c=this.bb.__offset(this.bb_pos,12);return c?(o||new f.apache.arrow.flatbuf.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+c)+i*4),this.bb):null}customMetadataLength(){let i=this.bb.__offset(this.bb_pos,12);return i?this.bb.__vector_len(this.bb_pos+i):0}static startMessage(i){i.startObject(5)}static addVersion(i,o){i.addFieldInt16(0,o,f.apache.arrow.flatbuf.MetadataVersion.V1)}static addHeaderType(i,o){i.addFieldInt8(1,o,e.apache.arrow.flatbuf.MessageHeader.NONE)}static addHeader(i,o){i.addFieldOffset(2,o,0)}static addBodyLength(i,o){i.addFieldInt64(3,o,i.createLong(0,0))}static addCustomMetadata(i,o){i.addFieldOffset(4,o,0)}static createCustomMetadataVector(i,o){i.startVector(4,o.length,4);for(let c=o.length-1;c>=0;c--)i.addOffset(o[c]);return i.endVector()}static startCustomMetadataVector(i,o){i.startVector(4,o,4)}static endMessage(i){return i.endObject()}static finishMessageBuffer(i,o){i.finish(o)}static createMessage(i,o,c,u,d,y){return s.startMessage(i),s.addVersion(i,o),s.addHeaderType(i,c),s.addHeader(i,u),s.addBodyLength(i,d),s.addCustomMetadata(i,y),s.endMessage(i)}}n.Message=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(q||(q={}));f.apache.arrow.flatbuf.Type;var Ft=f.apache.arrow.flatbuf.DateUnit,V=f.apache.arrow.flatbuf.TimeUnit,ut=f.apache.arrow.flatbuf.Precision,Nt=f.apache.arrow.flatbuf.UnionMode,ve=f.apache.arrow.flatbuf.IntervalUnit,j=q.apache.arrow.flatbuf.MessageHeader,dt=f.apache.arrow.flatbuf.MetadataVersion,l;(function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct=13]="Struct",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Dictionary=-1]="Dictionary",e[e.Int8=-2]="Int8",e[e.Int16=-3]="Int16",e[e.Int32=-4]="Int32",e[e.Int64=-5]="Int64",e[e.Uint8=-6]="Uint8",e[e.Uint16=-7]="Uint16",e[e.Uint32=-8]="Uint32",e[e.Uint64=-9]="Uint64",e[e.Float16=-10]="Float16",e[e.Float32=-11]="Float32",e[e.Float64=-12]="Float64",e[e.DateDay=-13]="DateDay",e[e.DateMillisecond=-14]="DateMillisecond",e[e.TimestampSecond=-15]="TimestampSecond",e[e.TimestampMillisecond=-16]="TimestampMillisecond",e[e.TimestampMicrosecond=-17]="TimestampMicrosecond",e[e.TimestampNanosecond=-18]="TimestampNanosecond",e[e.TimeSecond=-19]="TimeSecond",e[e.TimeMillisecond=-20]="TimeMillisecond",e[e.TimeMicrosecond=-21]="TimeMicrosecond",e[e.TimeNanosecond=-22]="TimeNanosecond",e[e.DenseUnion=-23]="DenseUnion",e[e.SparseUnion=-24]="SparseUnion",e[e.IntervalDayTime=-25]="IntervalDayTime",e[e.IntervalYearMonth=-26]="IntervalYearMonth"})(l||(l={}));var b;(function(e){e[e.OFFSET=0]="OFFSET",e[e.DATA=1]="DATA",e[e.VALIDITY=2]="VALIDITY",e[e.TYPE=3]="TYPE"})(b||(b={}));function si(e,t,r,n){return(r&1<<n)!==0}function ua(e,t,r,n){return(r&1<<n)>>n}function la(e,t,r){return r?!!(e[t>>3]|=1<<t%8)||!0:!(e[t>>3]&=~(1<<t%8))&&!1}function on(e,t,r){const n=r.byteLength+7&-8;if(e>0||r.byteLength<n){const s=new Uint8Array(n);return s.set(e%8===0?r.subarray(e>>3):je(tr(r,e,t,null,si)).subarray(0,n)),s}return r}function je(e){let t=[],r=0,n=0,s=0;for(const i of e)i&&(s|=1<<n),++n===8&&(t[r++]=s,s=n=0);(r===0||n>0)&&(t[r++]=s);let a=new Uint8Array(t.length+7&-8);return a.set(t),a}function*tr(e,t,r,n,s){let a=t%8,i=t>>3,o=0,c=r;for(;c>0;a=0){let u=e[i++];do yield s(n,o++,u,a);while(--c>0&&++a<8)}}function Mr(e,t,r){if(r-t<=0)return 0;if(r-t<8){let a=0;for(const i of tr(e,t,r-t,e,ua))a+=i;return a}const n=r>>3<<3,s=t+(t%8===0?0:8-t%8);return Mr(e,t,s)+Mr(e,n,r)+ha(e,s>>3,n-s>>3)}function ha(e,t,r){let n=0,s=t|0;const a=new DataView(e.buffer,e.byteOffset,e.byteLength),i=r===void 0?e.byteLength:s+r;for(;i-s>=4;)n+=vr(a.getUint32(s)),s+=4;for(;i-s>=2;)n+=vr(a.getUint16(s)),s+=2;for(;i-s>=1;)n+=vr(a.getUint8(s)),s+=1;return n}function vr(e){let t=e|0;return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24}const yu=Object.freeze(Object.defineProperty({__proto__:null,getBool:si,getBit:ua,setBool:la,truncateBitmap:on,packBools:je,iterateBits:tr,popcnt_bit_range:Mr,popcnt_array:ha,popcnt_uint32:vr},Symbol.toStringTag,{value:"Module"}));class D{visitMany(t,...r){return t.map((n,s)=>this.visit(n,...r.map(a=>a[s])))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,r=!0){return bu(this,t,r)}visitNull(t,...r){return null}visitBool(t,...r){return null}visitInt(t,...r){return null}visitFloat(t,...r){return null}visitUtf8(t,...r){return null}visitBinary(t,...r){return null}visitFixedSizeBinary(t,...r){return null}visitDate(t,...r){return null}visitTimestamp(t,...r){return null}visitTime(t,...r){return null}visitDecimal(t,...r){return null}visitList(t,...r){return null}visitStruct(t,...r){return null}visitUnion(t,...r){return null}visitDictionary(t,...r){return null}visitInterval(t,...r){return null}visitFixedSizeList(t,...r){return null}visitMap(t,...r){return null}}function bu(e,t,r=!0){let n=null,s=l.NONE;switch(t instanceof p||t instanceof L?s=In(t.type):t instanceof A?s=In(t):typeof(s=t)!="number"&&(s=l[t]),s){case l.Null:n=e.visitNull;break;case l.Bool:n=e.visitBool;break;case l.Int:n=e.visitInt;break;case l.Int8:n=e.visitInt8||e.visitInt;break;case l.Int16:n=e.visitInt16||e.visitInt;break;case l.Int32:n=e.visitInt32||e.visitInt;break;case l.Int64:n=e.visitInt64||e.visitInt;break;case l.Uint8:n=e.visitUint8||e.visitInt;break;case l.Uint16:n=e.visitUint16||e.visitInt;break;case l.Uint32:n=e.visitUint32||e.visitInt;break;case l.Uint64:n=e.visitUint64||e.visitInt;break;case l.Float:n=e.visitFloat;break;case l.Float16:n=e.visitFloat16||e.visitFloat;break;case l.Float32:n=e.visitFloat32||e.visitFloat;break;case l.Float64:n=e.visitFloat64||e.visitFloat;break;case l.Utf8:n=e.visitUtf8;break;case l.Binary:n=e.visitBinary;break;case l.FixedSizeBinary:n=e.visitFixedSizeBinary;break;case l.Date:n=e.visitDate;break;case l.DateDay:n=e.visitDateDay||e.visitDate;break;case l.DateMillisecond:n=e.visitDateMillisecond||e.visitDate;break;case l.Timestamp:n=e.visitTimestamp;break;case l.TimestampSecond:n=e.visitTimestampSecond||e.visitTimestamp;break;case l.TimestampMillisecond:n=e.visitTimestampMillisecond||e.visitTimestamp;break;case l.TimestampMicrosecond:n=e.visitTimestampMicrosecond||e.visitTimestamp;break;case l.TimestampNanosecond:n=e.visitTimestampNanosecond||e.visitTimestamp;break;case l.Time:n=e.visitTime;break;case l.TimeSecond:n=e.visitTimeSecond||e.visitTime;break;case l.TimeMillisecond:n=e.visitTimeMillisecond||e.visitTime;break;case l.TimeMicrosecond:n=e.visitTimeMicrosecond||e.visitTime;break;case l.TimeNanosecond:n=e.visitTimeNanosecond||e.visitTime;break;case l.Decimal:n=e.visitDecimal;break;case l.List:n=e.visitList;break;case l.Struct:n=e.visitStruct;break;case l.Union:n=e.visitUnion;break;case l.DenseUnion:n=e.visitDenseUnion||e.visitUnion;break;case l.SparseUnion:n=e.visitSparseUnion||e.visitUnion;break;case l.Dictionary:n=e.visitDictionary;break;case l.Interval:n=e.visitInterval;break;case l.IntervalDayTime:n=e.visitIntervalDayTime||e.visitInterval;break;case l.IntervalYearMonth:n=e.visitIntervalYearMonth||e.visitInterval;break;case l.FixedSizeList:n=e.visitFixedSizeList;break;case l.Map:n=e.visitMap;break}if(typeof n=="function")return n;if(!r)return()=>null;throw new Error(`Unrecognized type '${l[s]}'`)}function In(e){switch(e.typeId){case l.Null:return l.Null;case l.Int:const{bitWidth:t,isSigned:r}=e;switch(t){case 8:return r?l.Int8:l.Uint8;case 16:return r?l.Int16:l.Uint16;case 32:return r?l.Int32:l.Uint32;case 64:return r?l.Int64:l.Uint64}return l.Int;case l.Float:switch(e.precision){case ut.HALF:return l.Float16;case ut.SINGLE:return l.Float32;case ut.DOUBLE:return l.Float64}return l.Float;case l.Binary:return l.Binary;case l.Utf8:return l.Utf8;case l.Bool:return l.Bool;case l.Decimal:return l.Decimal;case l.Time:switch(e.unit){case V.SECOND:return l.TimeSecond;case V.MILLISECOND:return l.TimeMillisecond;case V.MICROSECOND:return l.TimeMicrosecond;case V.NANOSECOND:return l.TimeNanosecond}return l.Time;case l.Timestamp:switch(e.unit){case V.SECOND:return l.TimestampSecond;case V.MILLISECOND:return l.TimestampMillisecond;case V.MICROSECOND:return l.TimestampMicrosecond;case V.NANOSECOND:return l.TimestampNanosecond}return l.Timestamp;case l.Date:switch(e.unit){case Ft.DAY:return l.DateDay;case Ft.MILLISECOND:return l.DateMillisecond}return l.Date;case l.Interval:switch(e.unit){case ve.DAY_TIME:return l.IntervalDayTime;case ve.YEAR_MONTH:return l.IntervalYearMonth}return l.Interval;case l.Map:return l.Map;case l.List:return l.List;case l.Struct:return l.Struct;case l.Union:switch(e.mode){case Nt.Dense:return l.DenseUnion;case Nt.Sparse:return l.SparseUnion}return l.Union;case l.FixedSizeBinary:return l.FixedSizeBinary;case l.FixedSizeList:return l.FixedSizeList;case l.Dictionary:return l.Dictionary}throw new Error(`Unrecognized type '${l[e.typeId]}'`)}D.prototype.visitInt8=null;D.prototype.visitInt16=null;D.prototype.visitInt32=null;D.prototype.visitInt64=null;D.prototype.visitUint8=null;D.prototype.visitUint16=null;D.prototype.visitUint32=null;D.prototype.visitUint64=null;D.prototype.visitFloat16=null;D.prototype.visitFloat32=null;D.prototype.visitFloat64=null;D.prototype.visitDateDay=null;D.prototype.visitDateMillisecond=null;D.prototype.visitTimestampSecond=null;D.prototype.visitTimestampMillisecond=null;D.prototype.visitTimestampMicrosecond=null;D.prototype.visitTimestampNanosecond=null;D.prototype.visitTimeSecond=null;D.prototype.visitTimeMillisecond=null;D.prototype.visitTimeMicrosecond=null;D.prototype.visitTimeNanosecond=null;D.prototype.visitDenseUnion=null;D.prototype.visitSparseUnion=null;D.prototype.visitIntervalDayTime=null;D.prototype.visitIntervalYearMonth=null;class m extends D{compareSchemas(t,r){return t===r||r instanceof t.constructor&&st.compareFields(t.fields,r.fields)}compareFields(t,r){return t===r||Array.isArray(t)&&Array.isArray(r)&&t.length===r.length&&t.every((n,s)=>st.compareField(n,r[s]))}compareField(t,r){return t===r||r instanceof t.constructor&&t.name===r.name&&t.nullable===r.nullable&&st.visit(t.type,r.type)}}function et(e,t){return t instanceof e.constructor}function er(e,t){return e===t||et(e,t)}function Rt(e,t){return e===t||et(e,t)&&e.bitWidth===t.bitWidth&&e.isSigned===t.isSigned}function cn(e,t){return e===t||et(e,t)&&e.precision===t.precision}function mu(e,t){return e===t||et(e,t)&&e.byteWidth===t.byteWidth}function ai(e,t){return e===t||et(e,t)&&e.unit===t.unit}function rr(e,t){return e===t||et(e,t)&&e.unit===t.unit&&e.timezone===t.timezone}function nr(e,t){return e===t||et(e,t)&&e.unit===t.unit&&e.bitWidth===t.bitWidth}function gu(e,t){return e===t||et(e,t)&&e.children.length===t.children.length&&st.compareFields(e.children,t.children)}function _u(e,t){return e===t||et(e,t)&&e.children.length===t.children.length&&st.compareFields(e.children,t.children)}function oi(e,t){return e===t||et(e,t)&&e.mode===t.mode&&e.typeIds.every((r,n)=>r===t.typeIds[n])&&st.compareFields(e.children,t.children)}function wu(e,t){return e===t||et(e,t)&&e.id===t.id&&e.isOrdered===t.isOrdered&&st.visit(e.indices,t.indices)&&st.visit(e.dictionary,t.dictionary)}function ci(e,t){return e===t||et(e,t)&&e.unit===t.unit}function vu(e,t){return e===t||et(e,t)&&e.listSize===t.listSize&&e.children.length===t.children.length&&st.compareFields(e.children,t.children)}function Iu(e,t){return e===t||et(e,t)&&e.keysSorted===t.keysSorted&&e.children.length===t.children.length&&st.compareFields(e.children,t.children)}m.prototype.visitNull=er;m.prototype.visitBool=er;m.prototype.visitInt=Rt;m.prototype.visitInt8=Rt;m.prototype.visitInt16=Rt;m.prototype.visitInt32=Rt;m.prototype.visitInt64=Rt;m.prototype.visitUint8=Rt;m.prototype.visitUint16=Rt;m.prototype.visitUint32=Rt;m.prototype.visitUint64=Rt;m.prototype.visitFloat=cn;m.prototype.visitFloat16=cn;m.prototype.visitFloat32=cn;m.prototype.visitFloat64=cn;m.prototype.visitUtf8=er;m.prototype.visitBinary=er;m.prototype.visitFixedSizeBinary=mu;m.prototype.visitDate=ai;m.prototype.visitDateDay=ai;m.prototype.visitDateMillisecond=ai;m.prototype.visitTimestamp=rr;m.prototype.visitTimestampSecond=rr;m.prototype.visitTimestampMillisecond=rr;m.prototype.visitTimestampMicrosecond=rr;m.prototype.visitTimestampNanosecond=rr;m.prototype.visitTime=nr;m.prototype.visitTimeSecond=nr;m.prototype.visitTimeMillisecond=nr;m.prototype.visitTimeMicrosecond=nr;m.prototype.visitTimeNanosecond=nr;m.prototype.visitDecimal=er;m.prototype.visitList=gu;m.prototype.visitStruct=_u;m.prototype.visitUnion=oi;m.prototype.visitDenseUnion=oi;m.prototype.visitSparseUnion=oi;m.prototype.visitDictionary=wu;m.prototype.visitInterval=ci;m.prototype.visitIntervalDayTime=ci;m.prototype.visitIntervalYearMonth=ci;m.prototype.visitFixedSizeList=vu;m.prototype.visitMap=Iu;const st=new m;class A{static isNull(t){return t&&t.typeId===l.Null}static isInt(t){return t&&t.typeId===l.Int}static isFloat(t){return t&&t.typeId===l.Float}static isBinary(t){return t&&t.typeId===l.Binary}static isUtf8(t){return t&&t.typeId===l.Utf8}static isBool(t){return t&&t.typeId===l.Bool}static isDecimal(t){return t&&t.typeId===l.Decimal}static isDate(t){return t&&t.typeId===l.Date}static isTime(t){return t&&t.typeId===l.Time}static isTimestamp(t){return t&&t.typeId===l.Timestamp}static isInterval(t){return t&&t.typeId===l.Interval}static isList(t){return t&&t.typeId===l.List}static isStruct(t){return t&&t.typeId===l.Struct}static isUnion(t){return t&&t.typeId===l.Union}static isFixedSizeBinary(t){return t&&t.typeId===l.FixedSizeBinary}static isFixedSizeList(t){return t&&t.typeId===l.FixedSizeList}static isMap(t){return t&&t.typeId===l.Map}static isDictionary(t){return t&&t.typeId===l.Dictionary}get typeId(){return l.NONE}compareTo(t){return st.visit(this,t)}}A[Symbol.toStringTag]=(e=>(e.children=null,e.ArrayType=Array,e[Symbol.toStringTag]="DataType"))(A.prototype);class Ie extends A{toString(){return"Null"}get typeId(){return l.Null}}Ie[Symbol.toStringTag]=(e=>e[Symbol.toStringTag]="Null")(Ie.prototype);class tt extends A{constructor(t,r){super(),this.isSigned=t,this.bitWidth=r}get typeId(){return l.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?Int32Array:Uint32Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}tt[Symbol.toStringTag]=(e=>(e.isSigned=null,e.bitWidth=null,e[Symbol.toStringTag]="Int"))(tt.prototype);class ui extends tt{constructor(){super(!0,8)}}class li extends tt{constructor(){super(!0,16)}}class Qt extends tt{constructor(){super(!0,32)}}class Se extends tt{constructor(){super(!0,64)}}class hi extends tt{constructor(){super(!1,8)}}class fi extends tt{constructor(){super(!1,16)}}class di extends tt{constructor(){super(!1,32)}}class Be extends tt{constructor(){super(!1,64)}}Object.defineProperty(ui.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(li.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(Qt.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(Se.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(hi.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(fi.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(di.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(Be.prototype,"ArrayType",{value:Uint32Array});class Xt extends A{constructor(t){super(),this.precision=t}get typeId(){return l.Float}get ArrayType(){switch(this.precision){case ut.HALF:return Uint16Array;case ut.SINGLE:return Float32Array;case ut.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}Xt[Symbol.toStringTag]=(e=>(e.precision=null,e[Symbol.toStringTag]="Float"))(Xt.prototype);class un extends Xt{constructor(){super(ut.HALF)}}class pi extends Xt{constructor(){super(ut.SINGLE)}}class yi extends Xt{constructor(){super(ut.DOUBLE)}}Object.defineProperty(un.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(pi.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(yi.prototype,"ArrayType",{value:Float64Array});class ze extends A{constructor(){super()}get typeId(){return l.Binary}toString(){return"Binary"}}ze[Symbol.toStringTag]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Binary"))(ze.prototype);class Ae extends A{constructor(){super()}get typeId(){return l.Utf8}toString(){return"Utf8"}}Ae[Symbol.toStringTag]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Utf8"))(Ae.prototype);class Pe extends A{constructor(){super()}get typeId(){return l.Bool}toString(){return"Bool"}}Pe[Symbol.toStringTag]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Bool"))(Pe.prototype);class Ur extends A{constructor(t,r){super(),this.scale=t,this.precision=r}get typeId(){return l.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}Ur[Symbol.toStringTag]=(e=>(e.scale=null,e.precision=null,e.ArrayType=Uint32Array,e[Symbol.toStringTag]="Decimal"))(Ur.prototype);class Te extends A{constructor(t){super(),this.unit=t}get typeId(){return l.Date}toString(){return`Date${(this.unit+1)*32}<${Ft[this.unit]}>`}}Te[Symbol.toStringTag]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Date"))(Te.prototype);class Su extends Te{constructor(){super(Ft.DAY)}}class ss extends Te{constructor(){super(Ft.MILLISECOND)}}class Er extends A{constructor(t,r){super(),this.unit=t,this.bitWidth=r}get typeId(){return l.Time}toString(){return`Time${this.bitWidth}<${V[this.unit]}>`}}Er[Symbol.toStringTag]=(e=>(e.unit=null,e.bitWidth=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Time"))(Er.prototype);class Nr extends A{constructor(t,r){super(),this.unit=t,this.timezone=r}get typeId(){return l.Timestamp}toString(){return`Timestamp<${V[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}Nr[Symbol.toStringTag]=(e=>(e.unit=null,e.timezone=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Timestamp"))(Nr.prototype);class Vr extends A{constructor(t){super(),this.unit=t}get typeId(){return l.Interval}toString(){return`Interval<${ve[this.unit]}>`}}Vr[Symbol.toStringTag]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Interval"))(Vr.prototype);class Fe extends A{constructor(t){super(),this.children=[t]}get typeId(){return l.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}Fe[Symbol.toStringTag]=(e=>(e.children=null,e[Symbol.toStringTag]="List"))(Fe.prototype);class _t extends A{constructor(t){super(),this.children=t}get typeId(){return l.Struct}toString(){return`Struct<{${this.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}}_t[Symbol.toStringTag]=(e=>(e.children=null,e[Symbol.toStringTag]="Struct"))(_t.prototype);class $e extends A{constructor(t,r,n){super(),this.mode=t,this.children=n,this.typeIds=r=Int32Array.from(r),this.typeIdToChildIndex=r.reduce((s,a,i)=>(s[a]=i)&&s||s,Object.create(null))}get typeId(){return l.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(t=>`${t.type}`).join(" | ")}>`}}$e[Symbol.toStringTag]=(e=>(e.mode=null,e.typeIds=null,e.children=null,e.typeIdToChildIndex=null,e.ArrayType=Int8Array,e[Symbol.toStringTag]="Union"))($e.prototype);class Cr extends A{constructor(t){super(),this.byteWidth=t}get typeId(){return l.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}Cr[Symbol.toStringTag]=(e=>(e.byteWidth=null,e.ArrayType=Uint8Array,e[Symbol.toStringTag]="FixedSizeBinary"))(Cr.prototype);class We extends A{constructor(t,r){super(),this.listSize=t,this.children=[r]}get typeId(){return l.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}We[Symbol.toStringTag]=(e=>(e.children=null,e.listSize=null,e[Symbol.toStringTag]="FixedSizeList"))(We.prototype);class Ye extends A{constructor(t,r=!1){super(),this.children=[t],this.keysSorted=r}get typeId(){return l.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}toString(){return`Map<{${this.children[0].type.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}}Ye[Symbol.toStringTag]=(e=>(e.children=null,e.keysSorted=null,e[Symbol.toStringTag]="Map_"))(Ye.prototype);const Bu=(e=>()=>++e)(-1);class Ht extends A{constructor(t,r,n,s){super(),this.indices=r,this.dictionary=t,this.isOrdered=s||!1,this.id=n==null?Bu():typeof n=="number"?n:n.low}get typeId(){return l.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}Ht[Symbol.toStringTag]=(e=>(e.id=null,e.indices=null,e.isOrdered=null,e.dictionary=null,e[Symbol.toStringTag]="Dictionary"))(Ht.prototype);function fa(e){let t=e;switch(e.typeId){case l.Decimal:return 4;case l.Timestamp:return 2;case l.Date:return 1+t.unit;case l.Interval:return 1+t.unit;case l.Int:return 1+ +(t.bitWidth>32);case l.Time:return 1+ +(t.bitWidth>32);case l.FixedSizeList:return t.listSize;case l.FixedSizeBinary:return t.byteWidth;default:return 1}}const Au=-1;class p{constructor(t,r,n,s,a,i,o){this.type=t,this.dictionary=o,this.offset=Math.floor(Math.max(r||0,0)),this.length=Math.floor(Math.max(n||0,0)),this._nullCount=Math.floor(Math.max(s||0,-1)),this.childData=(i||[]).map(u=>u instanceof p?u:u.data);let c;a instanceof p?(this.stride=a.stride,this.values=a.values,this.typeIds=a.typeIds,this.nullBitmap=a.nullBitmap,this.valueOffsets=a.valueOffsets):(this.stride=fa(t),a&&((c=a[0])&&(this.valueOffsets=c),(c=a[1])&&(this.values=c),(c=a[2])&&(this.nullBitmap=c),(c=a[3])&&(this.typeIds=c)))}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let t=0,{valueOffsets:r,values:n,nullBitmap:s,typeIds:a}=this;return r&&(t+=r.byteLength),n&&(t+=n.byteLength),s&&(t+=s.byteLength),a&&(t+=a.byteLength),this.childData.reduce((i,o)=>i+o.byteLength,t)}get nullCount(){let t=this._nullCount,r;return t<=Au&&(r=this.nullBitmap)&&(this._nullCount=t=this.length-Mr(r,this.offset,this.offset+this.length)),t}clone(t,r=this.offset,n=this.length,s=this._nullCount,a=this,i=this.childData){return new p(t,r,n,s,a,i,this.dictionary)}slice(t,r){const{stride:n,typeId:s,childData:a}=this,i=+(this._nullCount===0)-1,o=s===16?n:1,c=this._sliceBuffers(t,r,n,s);return this.clone(this.type,this.offset+t,r,i,c,!a.length||this.valueOffsets?a:this._sliceChildren(a,o*t,o*r))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===l.Null)return this.clone(this.type,0,t,0);const{length:r,nullCount:n}=this,s=new Uint8Array((t+63&-64)>>3).fill(255,0,r>>3);s[r>>3]=(1<<r-(r&-8))-1,n>0&&s.set(on(this.offset,r,this.nullBitmap),0);const a=this.buffers;return a[b.VALIDITY]=s,this.clone(this.type,0,t,n+(t-r),a)}_sliceBuffers(t,r,n,s){let a,{buffers:i}=this;return(a=i[b.TYPE])&&(i[b.TYPE]=a.subarray(t,t+r)),(a=i[b.OFFSET])&&(i[b.OFFSET]=a.subarray(t,t+r+1))||(a=i[b.DATA])&&(i[b.DATA]=s===6?a:a.subarray(n*t,n*(t+r))),i}_sliceChildren(t,r,n){return t.map(s=>s.slice(r,n))}static new(t,r,n,s,a,i,o){switch(a instanceof p?a=a.buffers:a||(a=[]),t.typeId){case l.Null:return p.Null(t,r,n);case l.Int:return p.Int(t,r,n,s||0,a[b.VALIDITY],a[b.DATA]||[]);case l.Dictionary:return p.Dictionary(t,r,n,s||0,a[b.VALIDITY],a[b.DATA]||[],o);case l.Float:return p.Float(t,r,n,s||0,a[b.VALIDITY],a[b.DATA]||[]);case l.Bool:return p.Bool(t,r,n,s||0,a[b.VALIDITY],a[b.DATA]||[]);case l.Decimal:return p.Decimal(t,r,n,s||0,a[b.VALIDITY],a[b.DATA]||[]);case l.Date:return p.Date(t,r,n,s||0,a[b.VALIDITY],a[b.DATA]||[]);case l.Time:return p.Time(t,r,n,s||0,a[b.VALIDITY],a[b.DATA]||[]);case l.Timestamp:return p.Timestamp(t,r,n,s||0,a[b.VALIDITY],a[b.DATA]||[]);case l.Interval:return p.Interval(t,r,n,s||0,a[b.VALIDITY],a[b.DATA]||[]);case l.FixedSizeBinary:return p.FixedSizeBinary(t,r,n,s||0,a[b.VALIDITY],a[b.DATA]||[]);case l.Binary:return p.Binary(t,r,n,s||0,a[b.VALIDITY],a[b.OFFSET]||[],a[b.DATA]||[]);case l.Utf8:return p.Utf8(t,r,n,s||0,a[b.VALIDITY],a[b.OFFSET]||[],a[b.DATA]||[]);case l.List:return p.List(t,r,n,s||0,a[b.VALIDITY],a[b.OFFSET]||[],(i||[])[0]);case l.FixedSizeList:return p.FixedSizeList(t,r,n,s||0,a[b.VALIDITY],(i||[])[0]);case l.Struct:return p.Struct(t,r,n,s||0,a[b.VALIDITY],i||[]);case l.Map:return p.Map(t,r,n,s||0,a[b.VALIDITY],a[b.OFFSET]||[],(i||[])[0]);case l.Union:return p.Union(t,r,n,s||0,a[b.VALIDITY],a[b.TYPE]||[],a[b.OFFSET]||i,i)}throw new Error(`Unrecognized typeId ${t.typeId}`)}static Null(t,r,n){return new p(t,r,n,0)}static Int(t,r,n,s,a,i){return new p(t,r,n,s,[void 0,O(t.ArrayType,i),x(a)])}static Dictionary(t,r,n,s,a,i,o){return new p(t,r,n,s,[void 0,O(t.indices.ArrayType,i),x(a)],[],o)}static Float(t,r,n,s,a,i){return new p(t,r,n,s,[void 0,O(t.ArrayType,i),x(a)])}static Bool(t,r,n,s,a,i){return new p(t,r,n,s,[void 0,O(t.ArrayType,i),x(a)])}static Decimal(t,r,n,s,a,i){return new p(t,r,n,s,[void 0,O(t.ArrayType,i),x(a)])}static Date(t,r,n,s,a,i){return new p(t,r,n,s,[void 0,O(t.ArrayType,i),x(a)])}static Time(t,r,n,s,a,i){return new p(t,r,n,s,[void 0,O(t.ArrayType,i),x(a)])}static Timestamp(t,r,n,s,a,i){return new p(t,r,n,s,[void 0,O(t.ArrayType,i),x(a)])}static Interval(t,r,n,s,a,i){return new p(t,r,n,s,[void 0,O(t.ArrayType,i),x(a)])}static FixedSizeBinary(t,r,n,s,a,i){return new p(t,r,n,s,[void 0,O(t.ArrayType,i),x(a)])}static Binary(t,r,n,s,a,i,o){return new p(t,r,n,s,[he(i),x(o),x(a)])}static Utf8(t,r,n,s,a,i,o){return new p(t,r,n,s,[he(i),x(o),x(a)])}static List(t,r,n,s,a,i,o){return new p(t,r,n,s,[he(i),void 0,x(a)],[o])}static FixedSizeList(t,r,n,s,a,i){return new p(t,r,n,s,[void 0,void 0,x(a)],[i])}static Struct(t,r,n,s,a,i){return new p(t,r,n,s,[void 0,void 0,x(a)],i)}static Map(t,r,n,s,a,i,o){return new p(t,r,n,s,[he(i),void 0,x(a)],[o])}static Union(t,r,n,s,a,i,o,c){const u=[void 0,void 0,x(a),O(t.ArrayType,i)];return t.mode===Nt.Sparse?new p(t,r,n,s,u,o):(u[b.OFFSET]=he(o),new p(t,r,n,s,u,c))}}p.prototype.childData=Object.freeze([]);const Tu=void 0;function Ne(e){if(e===null)return"null";if(e===Tu)return"undefined";switch(typeof e){case"number":return`${e}`;case"bigint":return`${e}`;case"string":return`"${e}"`}return typeof e[Symbol.toPrimitive]=="function"?e[Symbol.toPrimitive]("string"):ArrayBuffer.isView(e)?`[${e}]`:JSON.stringify(e)}function Fu(e){if(!e||e.length<=0)return function(s){return!0};let t="",r=e.filter(n=>n===n);return r.length>0&&(t=`
    switch (x) {${r.map(n=>`
        case ${Ou(n)}:`).join("")}
            return false;
    }`),e.length!==r.length&&(t=`if (x !== x) return false;
${t}`),new Function("x",`${t}
return true;`)}function Ou(e){return typeof e!="bigint"?Ne(e):sn?`${Ne(e)}n`:`"${Ne(e)}"`}const Sn=(e,t)=>(e*t+63&-64||64)/t,Du=(e,t=0)=>e.length>=t?e.subarray(0,t):ke(new e.constructor(t),e,0);class ir{constructor(t,r=1){this.buffer=t,this.stride=r,this.BYTES_PER_ELEMENT=t.BYTES_PER_ELEMENT,this.ArrayType=t.constructor,this._resize(this.length=t.length/r|0)}get byteLength(){return this.length*this.stride*this.BYTES_PER_ELEMENT|0}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(t,r){return this}append(t){return this.set(this.length,t)}reserve(t){if(t>0){this.length+=t;const r=this.stride,n=this.length*r,s=this.buffer.length;n>=s&&this._resize(s===0?Sn(n*1,this.BYTES_PER_ELEMENT):Sn(n*2,this.BYTES_PER_ELEMENT))}return this}flush(t=this.length){t=Sn(t*this.stride,this.BYTES_PER_ELEMENT);const r=Du(this.buffer,t);return this.clear(),r}clear(){return this.length=0,this._resize(0),this}_resize(t){return this.buffer=ke(new this.ArrayType(t),this.buffer)}}ir.prototype.offset=0;class sr extends ir{last(){return this.get(this.length-1)}get(t){return this.buffer[t]}set(t,r){return this.reserve(t-this.length+1),this.buffer[t*this.stride]=r,this}}class da extends sr{constructor(t=new Uint8Array(0)){super(t,1/8),this.numValid=0}get numInvalid(){return this.length-this.numValid}get(t){return this.buffer[t>>3]>>t%8&1}set(t,r){const{buffer:n}=this.reserve(t-this.length+1),s=t>>3,a=t%8,i=n[s]>>a&1;return r?i===0&&(n[s]|=1<<a,++this.numValid):i===1&&(n[s]&=~(1<<a),--this.numValid),this}clear(){return this.numValid=0,super.clear()}}class pa extends sr{constructor(t=new Int32Array(1)){super(t,1)}append(t){return this.set(this.length-1,t)}set(t,r){const n=this.length-1,s=this.reserve(t-n+1).buffer;return n<t++&&s.fill(s[n],n,t),s[t]=s[t-1]+r,this}flush(t=this.length-1){return t>this.length&&this.set(t-1,0),super.flush(t+1)}}class ya extends ir{get ArrayType64(){return this._ArrayType64||(this._ArrayType64=this.buffer instanceof Int32Array?Le:Xe)}set(t,r){switch(this.reserve(t-this.length+1),typeof r){case"bigint":this.buffer64[t]=r;break;case"number":this.buffer[t*this.stride]=r;break;default:this.buffer.set(r,t*this.stride)}return this}_resize(t){const r=super._resize(t),n=r.byteLength/(this.BYTES_PER_ELEMENT*this.stride);return sn&&(this.buffer64=new this.ArrayType64(r.buffer,r.byteOffset,n)),r}}class W{constructor({type:t,nullValues:r}){this.length=0,this.finished=!1,this.type=t,this.children=[],this.nullValues=r,this.stride=fa(t),this._nulls=new da,r&&r.length>0&&(this._isValid=Fu(r))}static new(t){}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t){throw new Error('"throughDOM" not available in this environment')}static throughIterable(t){return xu(t)}static throughAsyncIterable(t){return Lu(t)}toVector(){return L.new(this.flush())}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let t=0;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),this._typeIds&&(t+=this._typeIds.byteLength),this.children.reduce((r,n)=>r+n.byteLength,t)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let t=0;return this._offsets&&(t+=this._offsets.reservedByteLength),this._values&&(t+=this._values.reservedByteLength),this._nulls&&(t+=this._nulls.reservedByteLength),this._typeIds&&(t+=this._typeIds.reservedByteLength),this.children.reduce((r,n)=>r+n.reservedByteLength,t)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(t){return this.set(this.length,t)}isValid(t){return this._isValid(t)}set(t,r){return this.setValid(t,this.isValid(r))&&this.setValue(t,r),this}setValue(t,r){this._setValue(this,t,r)}setValid(t,r){return this.length=this._nulls.set(t,+r).length,r}addChild(t,r=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(t){return this.children[t]||null}flush(){const t=[],r=this._values,n=this._offsets,s=this._typeIds,{length:a,nullCount:i}=this;s?(t[b.TYPE]=s.flush(a),n&&(t[b.OFFSET]=n.flush(a))):n?(r&&(t[b.DATA]=r.flush(n.last())),t[b.OFFSET]=n.flush(a)):r&&(t[b.DATA]=r.flush(a)),i>0&&(t[b.VALIDITY]=this._nulls.flush(a));const o=p.new(this.type,0,a,i,t,this.children.map(c=>c.flush()));return this.clear(),o}finish(){return this.finished=!0,this.children.forEach(t=>t.finish()),this}clear(){return this.length=0,this._offsets&&this._offsets.clear(),this._values&&this._values.clear(),this._nulls&&this._nulls.clear(),this._typeIds&&this._typeIds.clear(),this.children.forEach(t=>t.clear()),this}}W.prototype.length=1;W.prototype.stride=1;W.prototype.children=null;W.prototype.finished=!1;W.prototype.nullValues=null;W.prototype._isValid=()=>!0;class Jt extends W{constructor(t){super(t),this._values=new sr(new this.ArrayType(0),this.stride)}setValue(t,r){const n=this._values;return n.reserve(t-n.length+1),super.setValue(t,r)}}class ln extends W{constructor(t){super(t),this._pendingLength=0,this._offsets=new pa}setValue(t,r){const n=this._pending||(this._pending=new Map),s=n.get(t);s&&(this._pendingLength-=s.length),this._pendingLength+=r.length,n.set(t,r)}setValid(t,r){return super.setValid(t,r)?!0:((this._pending||(this._pending=new Map)).set(t,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){const t=this._pending,r=this._pendingLength;return this._pendingLength=0,this._pending=void 0,t&&t.size>0&&this._flushPending(t,r),this}}function xu(e){const{["queueingStrategy"]:t="count"}=e,{["highWaterMark"]:r=t!=="bytes"?1e3:2**14}=e,n=t!=="bytes"?"length":"byteLength";return function*(s){let a=0,i=W.new(e);for(const o of s)i.append(o)[n]>=r&&++a&&(yield i.toVector());(i.finish().length>0||a===0)&&(yield i.toVector())}}function Lu(e){const{["queueingStrategy"]:t="count"}=e,{["highWaterMark"]:r=t!=="bytes"?1e3:2**14}=e,n=t!=="bytes"?"length":"byteLength";return async function*(s){let a=0,i=W.new(e);for await(const o of s)i.append(o)[n]>=r&&++a&&(yield i.toVector());(i.finish().length>0||a===0)&&(yield i.toVector())}}class Mu extends W{constructor(t){super(t),this._values=new da}setValue(t,r){this._values.set(t,+r)}}class Uu extends W{setValue(t,r){}setValid(t,r){return this.length=Math.max(t+1,this.length),r}}class bi extends Jt{}class Eu extends bi{}class Nu extends bi{}class Vu extends Jt{}class Cu extends W{constructor({type:t,nullValues:r,dictionaryHashFunction:n}){super({type:new Ht(t.dictionary,t.indices,t.id,t.isOrdered)}),this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=W.new({type:this.type.indices,nullValues:r}),this.dictionary=W.new({type:this.type.dictionary,nullValues:null}),typeof n=="function"&&(this.valueToKey=n)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(t){return this.indices.isValid(t)}setValid(t,r){const n=this.indices;return r=n.setValid(t,r),this.length=n.length,r}setValue(t,r){let n=this._keysToIndices,s=this.valueToKey(r),a=n[s];return a===void 0&&(n[s]=a=this._dictionaryOffset+this.dictionary.append(r).length-1),this.indices.setValue(t,a)}flush(){const t=this.type,r=this._dictionary,n=this.dictionary.toVector(),s=this.indices.flush().clone(t);return s.dictionary=r?r.concat(n):n,this.finished||(this._dictionaryOffset+=n.length),this._dictionary=s.dictionary,this.clear(),s}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(t){return typeof t=="string"?t:`${t}`}}class Ru extends Jt{}const ba=new Float64Array(1),ue=new Uint32Array(ba.buffer);function ma(e){let t=(e&31744)>>10,r=(e&1023)/1024,n=(-1)**((e&32768)>>15);switch(t){case 31:return n*(r?NaN:1/0);case 0:return n*(r?6103515625e-14*r:0)}return n*2**(t-15)*(1+r)}function mi(e){if(e!==e)return 32256;ba[0]=e;let t=(ue[1]&2147483648)>>16&65535,r=ue[1]&2146435072,n=0;return r>=1089470464?ue[0]>0?r=31744:(r=(r&2080374784)>>16,n=(ue[1]&1048575)>>10):r<=1056964608?(n=1048576+(ue[1]&1048575),n=1048576+(n<<(r>>20)-998)>>21,r=0):(r=r-1056964608>>10,n=(ue[1]&1048575)+512>>10),t|r|n&65535}const ku=Object.freeze(Object.defineProperty({__proto__:null,uint16ToFloat64:ma,float64ToUint16:mi},Symbol.toStringTag,{value:"Module"}));class hn extends Jt{}class ju extends hn{setValue(t,r){this._values.set(t,mi(r))}}class zu extends hn{setValue(t,r){this._values.set(t,r)}}class Pu extends hn{setValue(t,r){this._values.set(t,r)}}const ga=Symbol.for("isArrowBigNum");function It(e,...t){return t.length===0?Object.setPrototypeOf(O(this.TypedArray,e),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(e,...t),this.constructor.prototype)}It.prototype[ga]=!0;It.prototype.toJSON=function(){return`"${$t(this)}"`};It.prototype.valueOf=function(){return _a(this)};It.prototype.toString=function(){return $t(this)};It.prototype[Symbol.toPrimitive]=function(e="default"){switch(e){case"number":return _a(this);case"string":return $t(this);case"default":return Ke(this)}return $t(this)};function pe(...e){return It.apply(this,e)}function ye(...e){return It.apply(this,e)}function He(...e){return It.apply(this,e)}Object.setPrototypeOf(pe.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(ye.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(He.prototype,Object.create(Uint32Array.prototype));Object.assign(pe.prototype,It.prototype,{constructor:pe,signed:!0,TypedArray:Int32Array,BigIntArray:Le});Object.assign(ye.prototype,It.prototype,{constructor:ye,signed:!1,TypedArray:Uint32Array,BigIntArray:Xe});Object.assign(He.prototype,It.prototype,{constructor:He,signed:!0,TypedArray:Uint32Array,BigIntArray:Xe});function _a(e){let{buffer:t,byteOffset:r,length:n,signed:s}=e,a=new Int32Array(t,r,n),i=0,o=0,c=a.length,u,d;for(;o<c;)d=a[o++],u=a[o++],s||(u=u>>>0),i+=(d>>>0)+u*o**32;return i}let $t,Ke;sn?(Ke=e=>e.byteLength===8?new e.BigIntArray(e.buffer,e.byteOffset,1)[0]:Bn(e),$t=e=>e.byteLength===8?`${new e.BigIntArray(e.buffer,e.byteOffset,1)[0]}`:Bn(e)):($t=Bn,Ke=$t);function Bn(e){let t="",r=new Uint32Array(2),n=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),s=new Uint32Array((n=new Uint16Array(n).reverse()).buffer),a=-1,i=n.length-1;do{for(r[0]=n[a=0];a<i;)n[a++]=r[1]=r[0]/10,r[0]=(r[0]-r[1]*10<<16)+n[a];n[a]=r[1]=r[0]/10,r[0]=r[0]-r[1]*10,t=`${r[0]}${t}`}while(s[0]||s[1]||s[2]||s[3]);return t||"0"}class se{constructor(t,r){return se.new(t,r)}static new(t,r){switch(r){case!0:return new pe(t);case!1:return new ye(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case Le:return new pe(t)}return t.byteLength===16?new He(t):new ye(t)}static signed(t){return new pe(t)}static unsigned(t){return new ye(t)}static decimal(t){return new He(t)}}const $u=Object.freeze(Object.defineProperty({__proto__:null,isArrowBigNumSymbol:ga,get bignumToString(){return $t},get bignumToBigInt(){return Ke},BN:se},Symbol.toStringTag,{value:"Module"}));class kt extends Jt{setValue(t,r){this._values.set(t,r)}}class Wu extends kt{}class Yu extends kt{}class Hu extends kt{}class Ku extends kt{constructor(t){t.nullValues&&(t.nullValues=t.nullValues.map(Rr)),super(t),this._values=new ya(new Int32Array(0),2)}get values64(){return this._values.buffer64}isValid(t){return super.isValid(Rr(t))}}class Ju extends kt{}class Gu extends kt{}class qu extends kt{}class Zu extends kt{constructor(t){t.nullValues&&(t.nullValues=t.nullValues.map(Rr)),super(t),this._values=new ya(new Uint32Array(0),2)}get values64(){return this._values.buffer64}isValid(t){return super.isValid(Rr(t))}}const Rr=(e=>t=>(ArrayBuffer.isView(t)&&(e.buffer=t.buffer,e.byteOffset=t.byteOffset,e.byteLength=t.byteLength,t=Ke(e),e.buffer=null),t))({BigIntArray:Le});class ar extends Jt{}class Qu extends ar{}class Xu extends ar{}class tl extends ar{}class el extends ar{}class or extends Jt{}class rl extends or{}class nl extends or{}class il extends or{}class sl extends or{}class gi extends Jt{}class al extends gi{}class ol extends gi{}class wa extends ln{constructor(t){super(t),this._values=new ir(new Uint8Array(0))}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,r){return super.setValue(t,x(r))}_flushPending(t,r){const n=this._offsets,s=this._values.reserve(r).buffer;let a=0,i=0,o=0,c;for([a,c]of t)c===void 0?n.set(a,0):(i=c.length,s.set(c,o),n.set(a,i),o+=i)}}class _i extends ln{constructor(t){super(t),this._values=new ir(new Uint8Array(0))}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,r){return super.setValue(t,nn(r))}_flushPending(t,r){}}_i.prototype._flushPending=wa.prototype._flushPending;class va{get length(){return this._values.length}get(t){return this._values[t]}clear(){return this._values=null,this}bind(t){return t instanceof L?t:(this._values=t,this)}}const J=Symbol.for("parent"),be=Symbol.for("rowIndex"),nt=Symbol.for("keyToIdx"),rt=Symbol.for("idxToVal"),zn=Symbol.for("nodejs.util.inspect.custom");class Et{constructor(t,r){this[J]=t,this.size=r}entries(){return this[Symbol.iterator]()}has(t){return this.get(t)!==void 0}get(t){let r;if(t!=null){const n=this[nt]||(this[nt]=new Map);let s=n.get(t);if(s!==void 0){const a=this[rt]||(this[rt]=new Array(this.size));(r=a[s])!==void 0||(a[s]=r=this.getValue(s))}else if((s=this.getIndex(t))>-1){n.set(t,s);const a=this[rt]||(this[rt]=new Array(this.size));(r=a[s])!==void 0||(a[s]=r=this.getValue(s))}}return r}set(t,r){if(t!=null){const n=this[nt]||(this[nt]=new Map);let s=n.get(t);if(s===void 0&&n.set(t,s=this.getIndex(t)),s>-1){const a=this[rt]||(this[rt]=new Array(this.size));a[s]=this.setValue(s,r)}}return this}clear(){throw new Error(`Clearing ${this[Symbol.toStringTag]} not supported.`)}delete(t){throw new Error(`Deleting ${this[Symbol.toStringTag]} values not supported.`)}*[Symbol.iterator](){const t=this.keys(),r=this.values(),n=this[nt]||(this[nt]=new Map),s=this[rt]||(this[rt]=new Array(this.size));for(let a,i,o=0,c,u;!((c=t.next()).done||(u=r.next()).done);++o)a=c.value,i=u.value,s[o]=i,n.has(a)||n.set(a,o),yield[a,i]}forEach(t,r){const n=this.keys(),s=this.values(),a=r===void 0?t:(c,u,d)=>t.call(r,c,u,d),i=this[nt]||(this[nt]=new Map),o=this[rt]||(this[rt]=new Array(this.size));for(let c,u,d=0,y,F;!((y=n.next()).done||(F=s.next()).done);++d)c=y.value,u=F.value,o[d]=u,i.has(c)||i.set(c,d),a(u,c,this)}toArray(){return[...this.values()]}toJSON(){const t={};return this.forEach((r,n)=>t[n]=r),t}inspect(){return this.toString()}[zn](){return this.toString()}toString(){const t=[];return this.forEach((r,n)=>{n=Ne(n),r=Ne(r),t.push(`${n}: ${r}`)}),`{ ${t.join(", ")} }`}}Et[Symbol.toStringTag]=(e=>(Object.defineProperties(e,{size:{writable:!0,enumerable:!1,configurable:!1,value:0},[J]:{writable:!0,enumerable:!1,configurable:!1,value:null},[be]:{writable:!0,enumerable:!1,configurable:!1,value:-1}}),e[Symbol.toStringTag]="Row"))(Et.prototype);class Ia extends Et{constructor(t){return super(t,t.length),cl(this)}keys(){return this[J].getChildAt(0)[Symbol.iterator]()}values(){return this[J].getChildAt(1)[Symbol.iterator]()}getKey(t){return this[J].getChildAt(0).get(t)}getIndex(t){return this[J].getChildAt(0).indexOf(t)}getValue(t){return this[J].getChildAt(1).get(t)}setValue(t,r){this[J].getChildAt(1).set(t,r)}}class Sa extends Et{constructor(t){return super(t,t.type.children.length),Ba(this)}*keys(){for(const t of this[J].type.children)yield t.name}*values(){for(const t of this[J].type.children)yield this[t.name]}getKey(t){return this[J].type.children[t].name}getIndex(t){return this[J].type.children.findIndex(r=>r.name===t)}getValue(t){return this[J].getChildAt(t).get(this[be])}setValue(t,r){return this[J].getChildAt(t).set(this[be],r)}}Object.setPrototypeOf(Et.prototype,Map.prototype);const Ba=(()=>{const e={enumerable:!0,configurable:!1,get:null,set:null};return t=>{let r=-1,n=t[nt]||(t[nt]=new Map);const s=i=>function(){return this.get(i)},a=i=>function(o){return this.set(i,o)};for(const i of t.keys())n.set(i,++r),e.get=s(i),e.set=a(i),t.hasOwnProperty(i)||(e.enumerable=!0,Object.defineProperty(t,i,e)),t.hasOwnProperty(r)||(e.enumerable=!1,Object.defineProperty(t,r,e));return e.get=e.set=null,t}})(),cl=(()=>{if(typeof Proxy>"u")return Ba;const e=Et.prototype.has,t=Et.prototype.get,r=Et.prototype.set,n=Et.prototype.getKey,s={isExtensible(){return!1},deleteProperty(){return!1},preventExtensions(){return!0},ownKeys(a){return[...a.keys()].map(i=>`${i}`)},has(a,i){switch(i){case"getKey":case"getIndex":case"getValue":case"setValue":case"toArray":case"toJSON":case"inspect":case"constructor":case"isPrototypeOf":case"propertyIsEnumerable":case"toString":case"toLocaleString":case"valueOf":case"size":case"has":case"get":case"set":case"clear":case"delete":case"keys":case"values":case"entries":case"forEach":case"__proto__":case"__defineGetter__":case"__defineSetter__":case"hasOwnProperty":case"__lookupGetter__":case"__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:case J:case be:case rt:case nt:case zn:return!0}return typeof i=="number"&&!a.has(i)&&(i=a.getKey(i)),a.has(i)},get(a,i,o){switch(i){case"getKey":case"getIndex":case"getValue":case"setValue":case"toArray":case"toJSON":case"inspect":case"constructor":case"isPrototypeOf":case"propertyIsEnumerable":case"toString":case"toLocaleString":case"valueOf":case"size":case"has":case"get":case"set":case"clear":case"delete":case"keys":case"values":case"entries":case"forEach":case"__proto__":case"__defineGetter__":case"__defineSetter__":case"hasOwnProperty":case"__lookupGetter__":case"__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:case J:case be:case rt:case nt:case zn:return Reflect.get(a,i,o)}return typeof i=="number"&&!e.call(o,i)&&(i=n.call(o,i)),t.call(o,i)},set(a,i,o,c){switch(i){case J:case be:case rt:case nt:return Reflect.set(a,i,o,c);case"getKey":case"getIndex":case"getValue":case"setValue":case"toArray":case"toJSON":case"inspect":case"constructor":case"isPrototypeOf":case"propertyIsEnumerable":case"toString":case"toLocaleString":case"valueOf":case"size":case"has":case"get":case"set":case"clear":case"delete":case"keys":case"values":case"entries":case"forEach":case"__proto__":case"__defineGetter__":case"__defineSetter__":case"hasOwnProperty":case"__lookupGetter__":case"__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:return!1}return typeof i=="number"&&!e.call(c,i)&&(i=n.call(c,i)),e.call(c,i)?!!r.call(c,i,o):!1}};return a=>new Proxy(a,s)})();function ul(e,t,r){const n=e.length,s=t>-1?t:n+t%n;return r?r(e,s):s}let as;function wi(e,t,r,n){let{length:s=0}=e,a=typeof t!="number"?0:t,i=typeof r!="number"?s:r;return a<0&&(a=(a%s+s)%s),i<0&&(i=(i%s+s)%s),i<a&&(as=a,a=i,i=as),i>s&&(i=s),n?n(e,a,i):[a,i]}const ll=sn?Ec(0):0,os=e=>e!==e;function ae(e){let t=typeof e;if(t!=="object"||e===null)return os(e)?os:t!=="bigint"?r=>r===e:r=>ll+r===e;if(e instanceof Date){const r=e.valueOf();return n=>n instanceof Date?n.valueOf()===r:!1}return ArrayBuffer.isView(e)?r=>r?oa(e,r):!1:e instanceof Map?fl(e):Array.isArray(e)?hl(e):e instanceof L?dl(e):pl(e)}function hl(e){const t=[];for(let r=-1,n=e.length;++r<n;)t[r]=ae(e[r]);return fn(t)}function fl(e){let t=-1;const r=[];return e.forEach(n=>r[++t]=ae(n)),fn(r)}function dl(e){const t=[];for(let r=-1,n=e.length;++r<n;)t[r]=ae(e.get(r));return fn(t)}function pl(e){const t=Object.keys(e);if(t.length===0)return()=>!1;const r=[];for(let n=-1,s=t.length;++n<s;)r[n]=ae(e[t[n]]);return fn(r,t)}function fn(e,t){return r=>{if(!r||typeof r!="object")return!1;switch(r.constructor){case Array:return yl(e,r);case Map:case Ia:case Sa:return cs(e,r,r.keys());case Object:case void 0:return cs(e,r,t||Object.keys(r))}return r instanceof L?bl(e,r):!1}}function yl(e,t){const r=e.length;if(t.length!==r)return!1;for(let n=-1;++n<r;)if(!e[n](t[n]))return!1;return!0}function bl(e,t){const r=e.length;if(t.length!==r)return!1;for(let n=-1;++n<r;)if(!e[n](t.get(n)))return!1;return!0}function cs(e,t,r){const n=r[Symbol.iterator](),s=t instanceof Map?t.keys():Object.keys(t)[Symbol.iterator](),a=t instanceof Map?t.values():Object.values(t)[Symbol.iterator]();let i=0,o=e.length,c=a.next(),u=n.next(),d=s.next();for(;i<o&&!u.done&&!d.done&&!c.done&&!(u.value!==d.value||!e[i](c.value));++i,u=n.next(),d=s.next(),c=a.next());return i===o&&u.done&&d.done&&c.done?!0:(n.return&&n.return(),s.return&&s.return(),a.return&&a.return(),!1)}const ml=Object.freeze(Object.defineProperty({__proto__:null,clampIndex:ul,clampRange:wi,createElementComparator:ae},Symbol.toStringTag,{value:"Module"}));class G extends L{constructor(t,r=[],n=gl(r)){super(),this._nullCount=-1,this._type=t,this._chunks=r,this._chunkOffsets=n,this._length=n[n.length-1],this._numChildren=(this._type.children||[]).length}static flatten(...t){return Il(L,t)}static concat(...t){const r=G.flatten(...t);return new G(r[0].type,r)}get type(){return this._type}get length(){return this._length}get chunks(){return this._chunks}get typeId(){return this._type.typeId}get VectorName(){return`Chunked<${this._type}>`}get data(){return this._chunks[0]?this._chunks[0].data:null}get ArrayType(){return this._type.ArrayType}get numChildren(){return this._numChildren}get stride(){return this._chunks[0]?this._chunks[0].stride:1}get byteLength(){return this._chunks.reduce((t,r)=>t+r.byteLength,0)}get nullCount(){let t=this._nullCount;return t<0&&(this._nullCount=t=this._chunks.reduce((r,{nullCount:n})=>r+n,0)),t}get indices(){if(A.isDictionary(this._type)){if(!this._indices){const t=this._chunks;this._indices=t.length===1?t[0].indices:G.concat(...t.map(r=>r.indices))}return this._indices}return null}get dictionary(){return A.isDictionary(this._type)?this._chunks[this._chunks.length-1].data.dictionary:null}*[Symbol.iterator](){for(const t of this._chunks)yield*t}clone(t=this._chunks){return new G(this._type,t)}concat(...t){return this.clone(G.flatten(this,...t))}slice(t,r){return wi(this,t,r,this._sliceInternal)}getChildAt(t){if(t<0||t>=this._numChildren)return null;let r=this._children||(this._children=[]),n,s,a;return(n=r[t])?n:(s=(this._type.children||[])[t])&&(a=this._chunks.map(i=>i.getChildAt(t)).filter(i=>i!=null),a.length>0)?r[t]=new G(s.type,a):null}search(t,r){let n=t,s=this._chunkOffsets,a=s.length-1;if(n<0||n>=s[a])return null;if(a<=1)return r?r(this,0,n):[0,n];let i=0,o=0,c=0;do{if(i+1===a)return r?r(this,i,n-o):[i,n-o];c=i+(a-i)/2|0,n>=s[c]?i=c:a=c}while(n<s[a]&&n>=(o=s[i]));return null}isValid(t){return!!this.search(t,this.isValidInternal)}get(t){return this.search(t,this.getInternal)}set(t,r){this.search(t,({chunks:n},s,a)=>n[s].set(a,r))}indexOf(t,r){return r&&typeof r=="number"?this.search(r,(n,s,a)=>this.indexOfInternal(n,s,a,t)):this.indexOfInternal(this,0,Math.max(0,r||0),t)}toArray(){const{chunks:t}=this,r=t.length;let n=this._type.ArrayType;if(r<=0)return new n(0);if(r<=1)return t[0].toArray();let s=0,a=new Array(r);for(let c=-1;++c<r;)s+=(a[c]=t[c].toArray()).length;n!==a[0].constructor&&(n=a[0].constructor);let i=new n(s),o=n===Array?wl:_l;for(let c=-1,u=0;++c<r;)u=o(a[c],i,u);return i}getInternal({_chunks:t},r,n){return t[r].get(n)}isValidInternal({_chunks:t},r,n){return t[r].isValid(n)}indexOfInternal({_chunks:t},r,n,s){let a=r-1,i=t.length,o=n,c=0,u=-1;for(;++a<i;){if(~(u=t[a].indexOf(s,o)))return c+u;o=0,c+=t[a].length}return-1}_sliceInternal(t,r,n){const s=[],{chunks:a,_chunkOffsets:i}=t;for(let o=-1,c=a.length;++o<c;){const u=a[o],d=u.length,y=i[o];if(y>=n)break;if(r>=y+d)continue;if(y>=r&&y+d<=n){s.push(u);continue}const F=Math.max(0,r-y),U=Math.min(n-y,d);s.push(u.slice(F,U))}return t.clone(s)}}function gl(e){let t=new Uint32Array((e||[]).length+1),r=t[0]=0,n=t.length;for(let s=0;++s<n;)t[s]=r+=e[s-1].length;return t}const _l=(e,t,r)=>(t.set(e,r),r+e.length),wl=(e,t,r)=>{let n=r;for(let s=-1,a=e.length;++s<a;)t[n++]=e[s];return n};class pt extends G{constructor(t,r=[],n){if(r=G.flatten(...r),super(t.type,r,n),this._field=t,r.length===1&&!(this instanceof us))return new us(t,r[0],this._chunkOffsets)}static new(t,r,...n){const s=G.flatten(Array.isArray(r)?[...r,...n]:r instanceof L?[r,...n]:[L.new(r,...n)]);if(typeof t=="string"){const a=s[0].data.type;t=new M(t,a,!0)}else!t.nullable&&s.some(({nullCount:a})=>a>0)&&(t=t.clone({nullable:!0}));return new pt(t,s)}get field(){return this._field}get name(){return this._field.name}get nullable(){return this._field.nullable}get metadata(){return this._field.metadata}clone(t=this._chunks){return new pt(this._field,t)}getChildAt(t){if(t<0||t>=this.numChildren)return null;let r=this._children||(this._children=[]),n,s,a;return(n=r[t])?n:(s=(this.type.children||[])[t])&&(a=this._chunks.map(i=>i.getChildAt(t)).filter(i=>i!=null),a.length>0)?r[t]=new pt(s,a):null}}class us extends pt{constructor(t,r,n){super(t,[r],n),this._chunk=r}search(t,r){return r?r(this,0,t):[0,t]}isValid(t){return this._chunk.isValid(t)}get(t){return this._chunk.get(t)}set(t,r){this._chunk.set(t,r)}indexOf(t,r){return this._chunk.indexOf(t,r)}}const Zt=Array.isArray,Aa=(e,t)=>vi(e,t,[],0),vl=e=>{const[t,r]=Ii(e,[[],[]]);return r.map((n,s)=>n instanceof pt?pt.new(n.field.clone(t[s]),n):n instanceof L?pt.new(t[s],n):pt.new(t[s],[]))},Ta=e=>Ii(e,[[],[]]),Il=(e,t)=>Pn(e,t,[],0),Sl=(e,t)=>Fa(e,t,[],0);function vi(e,t,r,n){let s,a=n,i=-1,o=t.length;for(;++i<o;)Zt(s=t[i])?a=vi(e,s,r,a).length:s instanceof e&&(r[a++]=s);return r}function Pn(e,t,r,n){let s,a=n,i=-1,o=t.length;for(;++i<o;)Zt(s=t[i])?a=Pn(e,s,r,a).length:s instanceof G?a=Pn(e,s.chunks,r,a).length:s instanceof e&&(r[a++]=s);return r}function Fa(e,t,r,n){let s,a=n,i=-1,o=t.length;for(;++i<o;)Zt(s=t[i])?a=Fa(e,s,r,a).length:s instanceof e?a=vi(L,s.schema.fields.map((c,u)=>s.getChildAt(u)),r,a).length:s instanceof L&&(r[a++]=s);return r}const Bl=(e,[t,r],n)=>(e[0][n]=t,e[1][n]=r,e);function Ii(e,t){let r,n;switch(n=e.length){case 0:return t;case 1:if(r=t[0],!e[0])return t;if(Zt(e[0]))return Ii(e[0],t);e[0]instanceof p||e[0]instanceof L||e[0]instanceof A||([r,e]=Object.entries(e[0]).reduce(Bl,t));break;default:Zt(r=e[n-1])?e=Zt(e[0])?e[0]:e.slice(0,n-1):(e=Zt(e[0])?e[0]:e,r=[])}let s=-1,a=-1,i=-1,o=e.length,c,u,[d,y]=t;for(;++i<o;)u=e[i],u instanceof pt&&(y[++a]=u)?d[++s]=u.field.clone(r[i],u.type,!0):({[i]:c=i}=r,u instanceof A&&(y[++a]=u)?d[++s]=M.new(c,u,!0):u&&u.type&&(y[++a]=u)&&(u instanceof p&&(y[a]=u=L.new(u)),d[++s]=M.new(c,u.type,!0)));return t}class C{constructor(t=[],r,n){this.fields=t||[],this.metadata=r||new Map,n||(n=$n(t)),this.dictionaries=n}static from(...t){return C.new(t[0],t[1])}static new(...t){return new C(Ta(t)[0])}get[Symbol.toStringTag](){return"Schema"}toString(){return`Schema<{ ${this.fields.map((t,r)=>`${r}: ${t}`).join(", ")} }>`}compareTo(t){return st.compareSchemas(this,t)}select(...t){const r=t.reduce((n,s)=>(n[s]=!0)&&n,Object.create(null));return new C(this.fields.filter(n=>r[n.name]),this.metadata)}selectAt(...t){return new C(t.map(r=>this.fields[r]).filter(Boolean),this.metadata)}assign(...t){const r=t[0]instanceof C?t[0]:new C(Aa(M,t)),n=[...this.fields],s=pr(pr(new Map,this.metadata),r.metadata),a=r.fields.filter(o=>{const c=n.findIndex(u=>u.name===o.name);return~c?(n[c]=o.clone({metadata:pr(pr(new Map,n[c].metadata),o.metadata)}))&&!1:!0}),i=$n(a,new Map);return new C([...n,...a],s,new Map([...this.dictionaries,...i]))}}class M{constructor(t,r,n=!1,s){this.name=t,this.type=r,this.nullable=n,this.metadata=s||new Map}static new(...t){let[r,n,s,a]=t;return t[0]&&typeof t[0]=="object"&&({name:r}=t[0],n===void 0&&(n=t[0].type),s===void 0&&(s=t[0].nullable),a===void 0&&(a=t[0].metadata)),new M(`${r}`,n,s,a)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}compareTo(t){return st.compareField(this,t)}clone(...t){let[r,n,s,a]=t;return!t[0]||typeof t[0]!="object"?[r=this.name,n=this.type,s=this.nullable,a=this.metadata]=t:{name:r=this.name,type:n=this.type,nullable:s=this.nullable,metadata:a=this.metadata}=t[0],M.new(r,n,s,a)}}function pr(e,t){return new Map([...e||new Map,...t||new Map])}function $n(e,t=new Map){for(let r=-1,n=e.length;++r<n;){const a=e[r].type;if(A.isDictionary(a)){if(!t.has(a.id))t.set(a.id,a.dictionary);else if(t.get(a.id)!==a.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}a.children&&a.children.length>0&&$n(a.children,t)}return t}C.prototype.fields=null;C.prototype.metadata=null;C.prototype.dictionaries=null;M.prototype.type=null;M.prototype.name=null;M.prototype.nullable=null;M.prototype.metadata=null;class Al extends ln{constructor(t){super(t),this._run=new va,this._offsets=new pa}addChild(t,r="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new Fe(new M(r,t.type,!0)),this.numChildren-1}clear(){return this._run.clear(),super.clear()}_flushPending(t){const r=this._run,n=this._offsets,s=this._setValue;let a=0,i;for([a,i]of t)i===void 0?n.set(a,0):(n.set(a,i.length),s(this,a,r.bind(i)))}}class Tl extends W{constructor(){super(...arguments),this._run=new va}setValue(t,r){super.setValue(t,this._run.bind(r))}addChild(t,r="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");const n=this.children.push(t);return this.type=new We(this.type.listSize,new M(r,t.type,!0)),n}clear(){return this._run.clear(),super.clear()}}class Fl extends ln{set(t,r){return super.set(t,r)}setValue(t,r){r=r instanceof Map?r:new Map(Object.entries(r));const n=this._pending||(this._pending=new Map),s=n.get(t);s&&(this._pendingLength-=s.size),this._pendingLength+=r.size,n.set(t,r)}addChild(t,r=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new Ye(new M(r,t.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(t){const r=this._offsets,n=this._setValue;t.forEach((s,a)=>{s===void 0?r.set(a,0):(r.set(a,s.size),n(this,a,s))})}}class Ol extends W{addChild(t,r=`${this.numChildren}`){const n=this.children.push(t);return this.type=new _t([...this.type.children,new M(r,t.type,!0)]),n}}class Si extends W{constructor(t){super(t),this._typeIds=new sr(new Int8Array(0),1),typeof t.valueToChildTypeId=="function"&&(this._valueToChildTypeId=t.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(t,r){return this.set(this.length,t,r)}set(t,r,n){return n===void 0&&(n=this._valueToChildTypeId(this,r,t)),this.setValid(t,this.isValid(r))&&this.setValue(t,r,n),this}setValue(t,r,n){this._typeIds.set(t,n),super.setValue(t,r)}addChild(t,r=`${this.children.length}`){const n=this.children.push(t),{type:{children:s,mode:a,typeIds:i}}=this,o=[...s,new M(r,t.type)];return this.type=new $e(a,[...i,n],o),n}_valueToChildTypeId(t,r,n){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}}class Dl extends Si{}class xl extends Si{constructor(t){super(t),this._offsets=new sr(new Int32Array(0))}setValue(t,r,n){const s=this.type.typeIdToChildIndex[n];return this._offsets.set(t,this.getChildAt(s).length),super.setValue(t,r,n)}}class I extends D{}const Ll=(e,t,r)=>{e[t]=r/864e5|0},Bi=(e,t,r)=>{e[t]=r%4294967296|0,e[t+1]=r/4294967296|0},Ml=(e,t,r)=>{e[t]=r*1e3%4294967296|0,e[t+1]=r*1e3/4294967296|0},Ul=(e,t,r)=>{e[t]=r*1e6%4294967296|0,e[t+1]=r*1e6/4294967296|0},Oa=(e,t,r,n)=>{const{[r]:s,[r+1]:a}=t;s!=null&&a!=null&&e.set(n.subarray(0,a-s),s)},El=({offset:e,values:t},r,n)=>{const s=e+r;n?t[s>>3]|=1<<s%8:t[s>>3]&=~(1<<s%8)},Da=({values:e},t,r)=>{Ll(e,t,r.valueOf())},xa=({values:e},t,r)=>{Bi(e,t*2,r.valueOf())},xt=({stride:e,values:t},r,n)=>{t[e*r]=n},La=({stride:e,values:t},r,n)=>{t[e*r]=mi(n)},Ai=(e,t,r)=>{switch(typeof r){case"bigint":e.values64[t]=r;break;case"number":e.values[t*e.stride]=r;break;default:const n=r,{stride:s,ArrayType:a}=e,i=O(a,n);e.values.set(i.subarray(0,s),s*t)}},Nl=({stride:e,values:t},r,n)=>{t.set(n.subarray(0,e),e*r)},Vl=({values:e,valueOffsets:t},r,n)=>Oa(e,t,r,n),Cl=({values:e,valueOffsets:t},r,n)=>{Oa(e,t,r,nn(n))},Rl=(e,t,r)=>{e.type.bitWidth<64?xt(e,t,r):Ai(e,t,r)},kl=(e,t,r)=>{e.type.precision!==ut.HALF?xt(e,t,r):La(e,t,r)},jl=(e,t,r)=>{e.type.unit===Ft.DAY?Da(e,t,r):xa(e,t,r)},Ma=({values:e},t,r)=>Bi(e,t*2,r/1e3),Ua=({values:e},t,r)=>Bi(e,t*2,r),Ea=({values:e},t,r)=>Ml(e,t*2,r),Na=({values:e},t,r)=>Ul(e,t*2,r),zl=(e,t,r)=>{switch(e.type.unit){case V.SECOND:return Ma(e,t,r);case V.MILLISECOND:return Ua(e,t,r);case V.MICROSECOND:return Ea(e,t,r);case V.NANOSECOND:return Na(e,t,r)}},Va=({values:e,stride:t},r,n)=>{e[t*r]=n},Ca=({values:e,stride:t},r,n)=>{e[t*r]=n},Ra=({values:e},t,r)=>{e.set(r.subarray(0,2),2*t)},ka=({values:e},t,r)=>{e.set(r.subarray(0,2),2*t)},Pl=(e,t,r)=>{switch(e.type.unit){case V.SECOND:return Va(e,t,r);case V.MILLISECOND:return Ca(e,t,r);case V.MICROSECOND:return Ra(e,t,r);case V.NANOSECOND:return ka(e,t,r)}},$l=({values:e},t,r)=>{e.set(r.subarray(0,4),4*t)},Wl=(e,t,r)=>{const n=e.getChildAt(0),s=e.valueOffsets;for(let a=-1,i=s[t],o=s[t+1];i<o;)n.set(i++,r.get(++a))},Yl=(e,t,r)=>{const n=e.getChildAt(0),s=e.valueOffsets,a=r instanceof Map?[...r]:Object.entries(r);for(let i=-1,o=s[t],c=s[t+1];o<c;)n.set(o++,a[++i])},Hl=(e,t)=>(r,n,s)=>r&&r.set(e,t[s]),Kl=(e,t)=>(r,n,s)=>r&&r.set(e,t.get(s)),Jl=(e,t)=>(r,n,s)=>r&&r.set(e,t.get(n.name)),Gl=(e,t)=>(r,n,s)=>r&&r.set(e,t[n.name]),ql=(e,t,r)=>{const n=r instanceof Map?Jl(t,r):r instanceof L?Kl(t,r):Array.isArray(r)?Hl(t,r):Gl(t,r);e.type.children.forEach((s,a)=>n(e.getChildAt(a),s,a))},Zl=(e,t,r)=>{e.type.mode===Nt.Dense?ja(e,t,r):za(e,t,r)},ja=(e,t,r)=>{const n=e.typeIdToChildIndex[e.typeIds[t]],s=e.getChildAt(n);s&&s.set(e.valueOffsets[t],r)},za=(e,t,r)=>{const n=e.typeIdToChildIndex[e.typeIds[t]],s=e.getChildAt(n);s&&s.set(t,r)},Ql=(e,t,r)=>{const n=e.getKey(t);n!==null&&e.setValue(n,r)},Xl=(e,t,r)=>{e.type.unit===ve.DAY_TIME?Pa(e,t,r):$a(e,t,r)},Pa=({values:e},t,r)=>{e.set(r.subarray(0,2),2*t)},$a=({values:e},t,r)=>{e[t]=r[0]*12+r[1]%12},th=(e,t,r)=>{const n=e.getChildAt(0),{stride:s}=e;for(let a=-1,i=t*s;++a<s;)n.set(i+a,r.get(a))};I.prototype.visitBool=El;I.prototype.visitInt=Rl;I.prototype.visitInt8=xt;I.prototype.visitInt16=xt;I.prototype.visitInt32=xt;I.prototype.visitInt64=Ai;I.prototype.visitUint8=xt;I.prototype.visitUint16=xt;I.prototype.visitUint32=xt;I.prototype.visitUint64=Ai;I.prototype.visitFloat=kl;I.prototype.visitFloat16=La;I.prototype.visitFloat32=xt;I.prototype.visitFloat64=xt;I.prototype.visitUtf8=Cl;I.prototype.visitBinary=Vl;I.prototype.visitFixedSizeBinary=Nl;I.prototype.visitDate=jl;I.prototype.visitDateDay=Da;I.prototype.visitDateMillisecond=xa;I.prototype.visitTimestamp=zl;I.prototype.visitTimestampSecond=Ma;I.prototype.visitTimestampMillisecond=Ua;I.prototype.visitTimestampMicrosecond=Ea;I.prototype.visitTimestampNanosecond=Na;I.prototype.visitTime=Pl;I.prototype.visitTimeSecond=Va;I.prototype.visitTimeMillisecond=Ca;I.prototype.visitTimeMicrosecond=Ra;I.prototype.visitTimeNanosecond=ka;I.prototype.visitDecimal=$l;I.prototype.visitList=Wl;I.prototype.visitStruct=ql;I.prototype.visitUnion=Zl;I.prototype.visitDenseUnion=ja;I.prototype.visitSparseUnion=za;I.prototype.visitDictionary=Ql;I.prototype.visitInterval=Xl;I.prototype.visitIntervalDayTime=Pa;I.prototype.visitIntervalYearMonth=$a;I.prototype.visitFixedSizeList=th;I.prototype.visitMap=Yl;const dn=new I;class eh extends D{visitNull(){return Uu}visitBool(){return Mu}visitInt(){return kt}visitInt8(){return Wu}visitInt16(){return Yu}visitInt32(){return Hu}visitInt64(){return Ku}visitUint8(){return Ju}visitUint16(){return Gu}visitUint32(){return qu}visitUint64(){return Zu}visitFloat(){return hn}visitFloat16(){return ju}visitFloat32(){return zu}visitFloat64(){return Pu}visitUtf8(){return _i}visitBinary(){return wa}visitFixedSizeBinary(){return Ru}visitDate(){return bi}visitDateDay(){return Eu}visitDateMillisecond(){return Nu}visitTimestamp(){return or}visitTimestampSecond(){return rl}visitTimestampMillisecond(){return nl}visitTimestampMicrosecond(){return il}visitTimestampNanosecond(){return sl}visitTime(){return ar}visitTimeSecond(){return Qu}visitTimeMillisecond(){return Xu}visitTimeMicrosecond(){return tl}visitTimeNanosecond(){return el}visitDecimal(){return Vu}visitList(){return Al}visitStruct(){return Ol}visitUnion(){return Si}visitDenseUnion(){return xl}visitSparseUnion(){return Dl}visitDictionary(){return Cu}visitInterval(){return gi}visitIntervalDayTime(){return al}visitIntervalYearMonth(){return ol}visitFixedSizeList(){return Tl}visitMap(){return Fl}}const Wa=new eh;W.new=Ya;function Ya(e){const t=e.type,r=new(Wa.getVisitFn(t)())(e);if(t.children&&t.children.length>0){const n=e.children||[],s={nullValues:e.nullValues},a=Array.isArray(n)?(i,o)=>n[o]||s:({name:i})=>n[i]||s;t.children.forEach((i,o)=>{const{type:c}=i,u=a(i,o);r.children.push(Ya({...u,type:c}))})}return r}Object.keys(l).map(e=>l[e]).filter(e=>typeof e=="number"&&e!==l.NONE).forEach(e=>{const t=Wa.visit(e);t.prototype._setValue=dn.getVisitFn(e)});_i.prototype._setValue=dn.visitBinary;var Oe;(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}static getRootAsFooter(i,o){return(o||new s).__init(i.readInt32(i.position())+i.position(),i)}version(){let i=this.bb.__offset(this.bb_pos,4);return i?this.bb.readInt16(this.bb_pos+i):f.apache.arrow.flatbuf.MetadataVersion.V1}schema(i){let o=this.bb.__offset(this.bb_pos,6);return o?(i||new f.apache.arrow.flatbuf.Schema).__init(this.bb.__indirect(this.bb_pos+o),this.bb):null}dictionaries(i,o){let c=this.bb.__offset(this.bb_pos,8);return c?(o||new e.apache.arrow.flatbuf.Block).__init(this.bb.__vector(this.bb_pos+c)+i*24,this.bb):null}dictionariesLength(){let i=this.bb.__offset(this.bb_pos,8);return i?this.bb.__vector_len(this.bb_pos+i):0}recordBatches(i,o){let c=this.bb.__offset(this.bb_pos,10);return c?(o||new e.apache.arrow.flatbuf.Block).__init(this.bb.__vector(this.bb_pos+c)+i*24,this.bb):null}recordBatchesLength(){let i=this.bb.__offset(this.bb_pos,10);return i?this.bb.__vector_len(this.bb_pos+i):0}static startFooter(i){i.startObject(4)}static addVersion(i,o){i.addFieldInt16(0,o,f.apache.arrow.flatbuf.MetadataVersion.V1)}static addSchema(i,o){i.addFieldOffset(1,o,0)}static addDictionaries(i,o){i.addFieldOffset(2,o,0)}static startDictionariesVector(i,o){i.startVector(24,o,8)}static addRecordBatches(i,o){i.addFieldOffset(3,o,0)}static startRecordBatchesVector(i,o){i.startVector(24,o,8)}static endFooter(i){return i.endObject()}static finishFooterBuffer(i,o){i.finish(o)}static createFooter(i,o,c,u,d){return s.startFooter(i),s.addVersion(i,o),s.addSchema(i,c),s.addDictionaries(i,u),s.addRecordBatches(i,d),s.endFooter(i)}}n.Footer=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(Oe||(Oe={}));(function(e){(function(t){(function(r){(function(n){class s{constructor(){this.bb=null,this.bb_pos=0}__init(i,o){return this.bb_pos=i,this.bb=o,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static createBlock(i,o,c,u){return i.prep(8,24),i.writeInt64(u),i.pad(4),i.writeInt32(c),i.writeInt64(o),i.offset()}}n.Block=s})(r.flatbuf||(r.flatbuf={}))})(t.arrow||(t.arrow={}))})(e.apache||(e.apache={}))})(Oe||(Oe={}));var ls=h.Long,rh=h.Builder,nh=h.ByteBuffer,ih=Oe.apache.arrow.flatbuf.Block,At=Oe.apache.arrow.flatbuf.Footer;class Je{constructor(t,r=dt.V4,n,s){this.schema=t,this.version=r,n&&(this._recordBatches=n),s&&(this._dictionaryBatches=s)}static decode(t){t=new nh(x(t));const r=At.getRootAsFooter(t),n=C.decode(r.schema());return new sh(n,r)}static encode(t){const r=new rh,n=C.encode(r,t.schema);At.startRecordBatchesVector(r,t.numRecordBatches),[...t.recordBatches()].slice().reverse().forEach(i=>Kt.encode(r,i));const s=r.endVector();At.startDictionariesVector(r,t.numDictionaries),[...t.dictionaryBatches()].slice().reverse().forEach(i=>Kt.encode(r,i));const a=r.endVector();return At.startFooter(r),At.addSchema(r,n),At.addVersion(r,dt.V4),At.addRecordBatches(r,s),At.addDictionaries(r,a),At.finishFooterBuffer(r,At.endFooter(r)),r.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let t,r=-1,n=this.numRecordBatches;++r<n;)(t=this.getRecordBatch(r))&&(yield t)}*dictionaryBatches(){for(let t,r=-1,n=this.numDictionaries;++r<n;)(t=this.getDictionaryBatch(r))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}}class sh extends Je{constructor(t,r){super(t,r.version()),this._footer=r}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){const r=this._footer.recordBatches(t);if(r)return Kt.decode(r)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){const r=this._footer.dictionaries(t);if(r)return Kt.decode(r)}return null}}class Kt{static decode(t){return new Kt(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,r){const{metaDataLength:n}=r,s=new ls(r.offset,0),a=new ls(r.bodyLength,0);return ih.createBlock(t,s,n,a)}constructor(t,r,n){this.metaDataLength=t,this.offset=typeof n=="number"?n:n.low,this.bodyLength=typeof r=="number"?r:r.low}}class Ve extends Uc{write(t){if((t=x(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?Rn(this.toUint8Array(!0)):this.toUint8Array(!1).then(Rn)}toUint8Array(t=!1){return t?gt(this._values)[0]:(async()=>{let r=[],n=0;for await(const s of this)r.push(s),n+=s.byteLength;return gt(r,n)[0]})()}}class kr{constructor(t){t&&(this.source=new ah(it.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class te{constructor(t){t instanceof te?this.source=t.source:t instanceof Ve?this.source=new qt(it.fromAsyncIterable(t)):ra(t)?this.source=new qt(it.fromNodeStream(t)):ni(t)?this.source=new qt(it.fromDOMStream(t)):ea(t)?this.source=new qt(it.fromDOMStream(t.body)):mt(t)?this.source=new qt(it.fromIterable(t)):Yt(t)?this.source=new qt(it.fromAsyncIterable(t)):Ct(t)&&(this.source=new qt(it.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class ah{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,r="read"){return this.source.next({cmd:r,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||$)}return(t){return Object.create(this.source.return&&this.source.return(t)||$)}}class qt{constructor(t){this.source=t,this._closedPromise=new Promise(r=>this._closedPromiseResolve=r)}async cancel(t){await this.return(t)}get closed(){return this._closedPromise}async read(t){return(await this.next(t,"read")).value}async peek(t){return(await this.next(t,"peek")).value}async next(t,r="read"){return await this.source.next({cmd:r,size:t})}async throw(t){const r=this.source.throw&&await this.source.throw(t)||$;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(r)}async return(t){const r=this.source.return&&await this.source.return(t)||$;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(r)}}class hs extends kr{constructor(t,r){super(),this.position=0,this.buffer=x(t),this.size=typeof r>"u"?this.buffer.byteLength:r}readInt32(t){const{buffer:r,byteOffset:n}=this.readAt(t,4);return new DataView(r,n).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){const{buffer:r,size:n,position:s}=this;return r&&s<n?(typeof t!="number"&&(t=1/0),this.position=Math.min(n,s+Math.min(n-s,t)),r.subarray(s,this.position)):null}readAt(t,r){const n=this.buffer,s=Math.min(this.size,t+r);return n?n.subarray(t,s):new Uint8Array(r)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}}class jr extends te{constructor(t,r){super(),this.position=0,this._handle=t,typeof r=="number"?this.size=r:this._pending=(async()=>{this.size=(await t.stat()).size,delete this._pending})()}async readInt32(t){const{buffer:r,byteOffset:n}=await this.readAt(t,4);return new DataView(r,n).getInt32(0,!0)}async seek(t){return this._pending&&await this._pending,this.position=Math.min(t,this.size),t<this.size}async read(t){this._pending&&await this._pending;const{_handle:r,size:n,position:s}=this;if(r&&s<n){typeof t!="number"&&(t=1/0);let a=s,i=0,o=0,c=Math.min(n,a+Math.min(n-a,t)),u=new Uint8Array(Math.max(0,(this.position=c)-a));for(;(a+=o)<c&&(i+=o)<u.byteLength;)({bytesRead:o}=await r.read(u,i,u.byteLength-i,a));return u}return null}async readAt(t,r){this._pending&&await this._pending;const{_handle:n,size:s}=this;if(n&&t+r<s){const a=Math.min(s,t+r),i=new Uint8Array(a-t);return(await n.read(i,0,r,t)).buffer}return new Uint8Array(r)}async close(){const t=this._handle;this._handle=null,t&&await t.close()}async throw(t){return await this.close(),{done:!0,value:t}}async return(t){return await this.close(),{done:!0,value:t}}}const oh=1<<16;function de(e){return e<0&&(e=4294967295+e+1),`0x${e.toString(16)}`}const De=8,Ti=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class Fi{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){const r=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),n=new Uint32Array([t.buffer[1]>>>16,t.buffer[1]&65535,t.buffer[0]>>>16,t.buffer[0]&65535]);let s=r[3]*n[3];this.buffer[0]=s&65535;let a=s>>>16;return s=r[2]*n[3],a+=s,s=r[3]*n[2]>>>0,a+=s,this.buffer[0]+=a<<16,this.buffer[1]=a>>>0<s?oh:0,this.buffer[1]+=a>>>16,this.buffer[1]+=r[1]*n[3]+r[2]*n[2]+r[3]*n[1],this.buffer[1]+=r[0]*n[3]+r[1]*n[2]+r[2]*n[1]+r[3]*n[0]<<16,this}_plus(t){const r=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],r<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=r}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${de(this.buffer[1])} ${de(this.buffer[0])}`}}class N extends Fi{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,r=new Uint32Array(2)){return N.fromString(typeof t=="string"?t:t.toString(),r)}static fromNumber(t,r=new Uint32Array(2)){return N.fromString(t.toString(),r)}static fromString(t,r=new Uint32Array(2)){const n=t.length;let s=new N(r);for(let a=0;a<n;){const i=De<n-a?De:n-a,o=new N(new Uint32Array([parseInt(t.substr(a,i),10),0])),c=new N(new Uint32Array([Ti[i],0]));s.times(c),s.plus(o),a+=i}return s}static convertArray(t){const r=new Uint32Array(t.length*2);for(let n=-1,s=t.length;++n<s;)N.from(t[n],new Uint32Array(r.buffer,r.byteOffset+2*n*4,2));return r}static multiply(t,r){return new N(new Uint32Array(t.buffer)).times(r)}static add(t,r){return new N(new Uint32Array(t.buffer)).plus(r)}}class Z extends Fi{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){const r=this.buffer[1]<<0,n=t.buffer[1]<<0;return r<n||r===n&&this.buffer[0]<t.buffer[0]}static from(t,r=new Uint32Array(2)){return Z.fromString(typeof t=="string"?t:t.toString(),r)}static fromNumber(t,r=new Uint32Array(2)){return Z.fromString(t.toString(),r)}static fromString(t,r=new Uint32Array(2)){const n=t.startsWith("-"),s=t.length;let a=new Z(r);for(let i=n?1:0;i<s;){const o=De<s-i?De:s-i,c=new Z(new Uint32Array([parseInt(t.substr(i,o),10),0])),u=new Z(new Uint32Array([Ti[o],0]));a.times(u),a.plus(c),i+=o}return n?a.negate():a}static convertArray(t){const r=new Uint32Array(t.length*2);for(let n=-1,s=t.length;++n<s;)Z.from(t[n],new Uint32Array(r.buffer,r.byteOffset+2*n*4,2));return r}static multiply(t,r){return new Z(new Uint32Array(t.buffer)).times(r)}static add(t,r){return new Z(new Uint32Array(t.buffer)).plus(r)}}class ft{constructor(t){this.buffer=t}high(){return new Z(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new Z(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(t){const r=new N(new Uint32Array([this.buffer[3],0])),n=new N(new Uint32Array([this.buffer[2],0])),s=new N(new Uint32Array([this.buffer[1],0])),a=new N(new Uint32Array([this.buffer[0],0])),i=new N(new Uint32Array([t.buffer[3],0])),o=new N(new Uint32Array([t.buffer[2],0])),c=new N(new Uint32Array([t.buffer[1],0])),u=new N(new Uint32Array([t.buffer[0],0]));let d=N.multiply(a,u);this.buffer[0]=d.low();let y=new N(new Uint32Array([d.high(),0]));return d=N.multiply(s,u),y.plus(d),d=N.multiply(a,c),y.plus(d),this.buffer[1]=y.low(),this.buffer[3]=y.lessThan(d)?1:0,this.buffer[2]=y.high(),new N(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(N.multiply(n,u)).plus(N.multiply(s,c)).plus(N.multiply(a,o)),this.buffer[3]+=N.multiply(r,u).plus(N.multiply(n,c)).plus(N.multiply(s,o)).plus(N.multiply(a,i)).low(),this}plus(t){let r=new Uint32Array(4);return r[3]=this.buffer[3]+t.buffer[3]>>>0,r[2]=this.buffer[2]+t.buffer[2]>>>0,r[1]=this.buffer[1]+t.buffer[1]>>>0,r[0]=this.buffer[0]+t.buffer[0]>>>0,r[0]<this.buffer[0]>>>0&&++r[1],r[1]<this.buffer[1]>>>0&&++r[2],r[2]<this.buffer[2]>>>0&&++r[3],this.buffer[3]=r[3],this.buffer[2]=r[2],this.buffer[1]=r[1],this.buffer[0]=r[0],this}hex(){return`${de(this.buffer[3])} ${de(this.buffer[2])} ${de(this.buffer[1])} ${de(this.buffer[0])}`}static multiply(t,r){return new ft(new Uint32Array(t.buffer)).times(r)}static add(t,r){return new ft(new Uint32Array(t.buffer)).plus(r)}static from(t,r=new Uint32Array(4)){return ft.fromString(typeof t=="string"?t:t.toString(),r)}static fromNumber(t,r=new Uint32Array(4)){return ft.fromString(t.toString(),r)}static fromString(t,r=new Uint32Array(4)){const n=t.startsWith("-"),s=t.length;let a=new ft(r);for(let i=n?1:0;i<s;){const o=De<s-i?De:s-i,c=new ft(new Uint32Array([parseInt(t.substr(i,o),10),0,0,0])),u=new ft(new Uint32Array([Ti[o],0,0,0]));a.times(u),a.plus(c),i+=o}return n?a.negate():a}static convertArray(t){const r=new Uint32Array(t.length*4);for(let n=-1,s=t.length;++n<s;)ft.from(t[n],new Uint32Array(r.buffer,r.byteOffset+4*4*n,4));return r}}const ch=Object.freeze(Object.defineProperty({__proto__:null,BaseInt64:Fi,Uint64:N,Int64:Z,Int128:ft},Symbol.toStringTag,{value:"Module"}));class Ha extends D{constructor(t,r,n,s){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=r,this.buffers=n,this.dictionaries=s}visit(t){return super.visit(t instanceof M?t.type:t)}visitNull(t,{length:r}=this.nextFieldNode()){return p.Null(t,0,r)}visitBool(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.Bool(t,0,r,n,this.readNullBitmap(t,n),this.readData(t))}visitInt(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.Int(t,0,r,n,this.readNullBitmap(t,n),this.readData(t))}visitFloat(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.Float(t,0,r,n,this.readNullBitmap(t,n),this.readData(t))}visitUtf8(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.Utf8(t,0,r,n,this.readNullBitmap(t,n),this.readOffsets(t),this.readData(t))}visitBinary(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.Binary(t,0,r,n,this.readNullBitmap(t,n),this.readOffsets(t),this.readData(t))}visitFixedSizeBinary(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.FixedSizeBinary(t,0,r,n,this.readNullBitmap(t,n),this.readData(t))}visitDate(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.Date(t,0,r,n,this.readNullBitmap(t,n),this.readData(t))}visitTimestamp(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.Timestamp(t,0,r,n,this.readNullBitmap(t,n),this.readData(t))}visitTime(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.Time(t,0,r,n,this.readNullBitmap(t,n),this.readData(t))}visitDecimal(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.Decimal(t,0,r,n,this.readNullBitmap(t,n),this.readData(t))}visitList(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.List(t,0,r,n,this.readNullBitmap(t,n),this.readOffsets(t),this.visit(t.children[0]))}visitStruct(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.Struct(t,0,r,n,this.readNullBitmap(t,n),this.visitMany(t.children))}visitUnion(t){return t.mode===Nt.Sparse?this.visitSparseUnion(t):this.visitDenseUnion(t)}visitDenseUnion(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.Union(t,0,r,n,this.readNullBitmap(t,n),this.readTypeIds(t),this.readOffsets(t),this.visitMany(t.children))}visitSparseUnion(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.Union(t,0,r,n,this.readNullBitmap(t,n),this.readTypeIds(t),this.visitMany(t.children))}visitDictionary(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.Dictionary(t,0,r,n,this.readNullBitmap(t,n),this.readData(t.indices),this.readDictionary(t))}visitInterval(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.Interval(t,0,r,n,this.readNullBitmap(t,n),this.readData(t))}visitFixedSizeList(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.FixedSizeList(t,0,r,n,this.readNullBitmap(t,n),this.visit(t.children[0]))}visitMap(t,{length:r,nullCount:n}=this.nextFieldNode()){return p.Map(t,0,r,n,this.readNullBitmap(t,n),this.readOffsets(t),this.visit(t.children[0]))}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,r,n=this.nextBufferRange()){return r>0&&this.readData(t,n)||new Uint8Array(0)}readOffsets(t,r){return this.readData(t,r)}readTypeIds(t,r){return this.readData(t,r)}readData(t,{length:r,offset:n}=this.nextBufferRange()){return this.bytes.subarray(n,n+r)}readDictionary(t){return this.dictionaries.get(t.id)}}class uh extends Ha{constructor(t,r,n,s){super(new Uint8Array(0),r,n,s),this.sources=t}readNullBitmap(t,r,{offset:n}=this.nextBufferRange()){return r<=0?new Uint8Array(0):je(this.sources[n])}readOffsets(t,{offset:r}=this.nextBufferRange()){return O(Uint8Array,O(Int32Array,this.sources[r]))}readTypeIds(t,{offset:r}=this.nextBufferRange()){return O(Uint8Array,O(t.ArrayType,this.sources[r]))}readData(t,{offset:r}=this.nextBufferRange()){const{sources:n}=this;return A.isTimestamp(t)||(A.isInt(t)||A.isTime(t))&&t.bitWidth===64||A.isDate(t)&&t.unit===Ft.MILLISECOND?O(Uint8Array,Z.convertArray(n[r])):A.isDecimal(t)?O(Uint8Array,ft.convertArray(n[r])):A.isBinary(t)||A.isFixedSizeBinary(t)?lh(n[r]):A.isBool(t)?je(n[r]):A.isUtf8(t)?nn(n[r].join("")):O(Uint8Array,O(t.ArrayType,n[r].map(s=>+s)))}}function lh(e){const t=e.join(""),r=new Uint8Array(t.length/2);for(let n=0;n<t.length;n+=2)r[n>>1]=parseInt(t.substr(n,2),16);return r}var hh=h.Long,fs=f.apache.arrow.flatbuf.Null,yr=f.apache.arrow.flatbuf.Int,An=f.apache.arrow.flatbuf.FloatingPoint,ds=f.apache.arrow.flatbuf.Binary,ps=f.apache.arrow.flatbuf.Bool,ys=f.apache.arrow.flatbuf.Utf8,br=f.apache.arrow.flatbuf.Decimal,Tn=f.apache.arrow.flatbuf.Date,mr=f.apache.arrow.flatbuf.Time,gr=f.apache.arrow.flatbuf.Timestamp,Fn=f.apache.arrow.flatbuf.Interval,bs=f.apache.arrow.flatbuf.List,ms=f.apache.arrow.flatbuf.Struct_,le=f.apache.arrow.flatbuf.Union,Me=f.apache.arrow.flatbuf.DictionaryEncoding,On=f.apache.arrow.flatbuf.FixedSizeBinary,Dn=f.apache.arrow.flatbuf.FixedSizeList,xn=f.apache.arrow.flatbuf.Map;class fh extends D{visit(t,r){return t==null||r==null?void 0:super.visit(t,r)}visitNull(t,r){return fs.startNull(r),fs.endNull(r)}visitInt(t,r){return yr.startInt(r),yr.addBitWidth(r,t.bitWidth),yr.addIsSigned(r,t.isSigned),yr.endInt(r)}visitFloat(t,r){return An.startFloatingPoint(r),An.addPrecision(r,t.precision),An.endFloatingPoint(r)}visitBinary(t,r){return ds.startBinary(r),ds.endBinary(r)}visitBool(t,r){return ps.startBool(r),ps.endBool(r)}visitUtf8(t,r){return ys.startUtf8(r),ys.endUtf8(r)}visitDecimal(t,r){return br.startDecimal(r),br.addScale(r,t.scale),br.addPrecision(r,t.precision),br.endDecimal(r)}visitDate(t,r){return Tn.startDate(r),Tn.addUnit(r,t.unit),Tn.endDate(r)}visitTime(t,r){return mr.startTime(r),mr.addUnit(r,t.unit),mr.addBitWidth(r,t.bitWidth),mr.endTime(r)}visitTimestamp(t,r){const n=t.timezone&&r.createString(t.timezone)||void 0;return gr.startTimestamp(r),gr.addUnit(r,t.unit),n!==void 0&&gr.addTimezone(r,n),gr.endTimestamp(r)}visitInterval(t,r){return Fn.startInterval(r),Fn.addUnit(r,t.unit),Fn.endInterval(r)}visitList(t,r){return bs.startList(r),bs.endList(r)}visitStruct(t,r){return ms.startStruct_(r),ms.endStruct_(r)}visitUnion(t,r){le.startTypeIdsVector(r,t.typeIds.length);const n=le.createTypeIdsVector(r,t.typeIds);return le.startUnion(r),le.addMode(r,t.mode),le.addTypeIds(r,n),le.endUnion(r)}visitDictionary(t,r){const n=this.visit(t.indices,r);return Me.startDictionaryEncoding(r),Me.addId(r,new hh(t.id,0)),Me.addIsOrdered(r,t.isOrdered),n!==void 0&&Me.addIndexType(r,n),Me.endDictionaryEncoding(r)}visitFixedSizeBinary(t,r){return On.startFixedSizeBinary(r),On.addByteWidth(r,t.byteWidth),On.endFixedSizeBinary(r)}visitFixedSizeList(t,r){return Dn.startFixedSizeList(r),Dn.addListSize(r,t.listSize),Dn.endFixedSizeList(r)}visitMap(t,r){return xn.startMap(r),xn.addKeysSorted(r,t.keysSorted),xn.endMap(r)}}const Ln=new fh;function dh(e,t=new Map){return new C(yh(e,t),Ir(e.customMetadata),t)}function Ka(e){return new ot(e.count,Ja(e.columns),Ga(e.columns))}function ph(e){return new Ot(Ka(e.data),e.id,e.isDelta)}function yh(e,t){return(e.fields||[]).filter(Boolean).map(r=>M.fromJSON(r,t))}function gs(e,t){return(e.children||[]).filter(Boolean).map(r=>M.fromJSON(r,t))}function Ja(e){return(e||[]).reduce((t,r)=>[...t,new oe(r.count,bh(r.VALIDITY)),...Ja(r.children)],[])}function Ga(e,t=[]){for(let r=-1,n=(e||[]).length;++r<n;){const s=e[r];s.VALIDITY&&t.push(new Tt(t.length,s.VALIDITY.length)),s.TYPE&&t.push(new Tt(t.length,s.TYPE.length)),s.OFFSET&&t.push(new Tt(t.length,s.OFFSET.length)),s.DATA&&t.push(new Tt(t.length,s.DATA.length)),t=Ga(s.children,t)}return t}function bh(e){return(e||[]).reduce((t,r)=>t+ +(r===0),0)}function mh(e,t){let r,n,s,a,i,o;return!t||!(a=e.dictionary)?(i=ws(e,gs(e,t)),s=new M(e.name,i,e.nullable,Ir(e.customMetadata))):t.has(r=a.id)?(n=(n=a.indexType)?_s(n):new Qt,o=new Ht(t.get(r),n,r,a.isOrdered),s=new M(e.name,o,e.nullable,Ir(e.customMetadata))):(n=(n=a.indexType)?_s(n):new Qt,t.set(r,i=ws(e,gs(e,t))),o=new Ht(i,n,r,a.isOrdered),s=new M(e.name,o,e.nullable,Ir(e.customMetadata))),s||null}function Ir(e){return new Map(Object.entries(e||{}))}function _s(e){return new tt(e.isSigned,e.bitWidth)}function ws(e,t){const r=e.type.name;switch(r){case"NONE":return new Ie;case"null":return new Ie;case"binary":return new ze;case"utf8":return new Ae;case"bool":return new Pe;case"list":return new Fe((t||[])[0]);case"struct":return new _t(t||[]);case"struct_":return new _t(t||[])}switch(r){case"int":{const n=e.type;return new tt(n.isSigned,n.bitWidth)}case"floatingpoint":{const n=e.type;return new Xt(ut[n.precision])}case"decimal":{const n=e.type;return new Ur(n.scale,n.precision)}case"date":{const n=e.type;return new Te(Ft[n.unit])}case"time":{const n=e.type;return new Er(V[n.unit],n.bitWidth)}case"timestamp":{const n=e.type;return new Nr(V[n.unit],n.timezone)}case"interval":{const n=e.type;return new Vr(ve[n.unit])}case"union":{const n=e.type;return new $e(Nt[n.mode],n.typeIds||[],t||[])}case"fixedsizebinary":{const n=e.type;return new Cr(n.byteWidth)}case"fixedsizelist":{const n=e.type;return new We(n.listSize,(t||[])[0])}case"map":{const n=e.type;return new Ye((t||[])[0],n.keysSorted)}}throw new Error(`Unrecognized type: "${r}"`)}var ee=h.Long,gh=h.Builder,_h=h.ByteBuffer,H=f.apache.arrow.flatbuf.Type,ht=f.apache.arrow.flatbuf.Field,Mt=f.apache.arrow.flatbuf.Schema,wh=f.apache.arrow.flatbuf.Buffer,jt=q.apache.arrow.flatbuf.Message,Pt=f.apache.arrow.flatbuf.KeyValue,vh=q.apache.arrow.flatbuf.FieldNode,vs=f.apache.arrow.flatbuf.Endianness,zt=q.apache.arrow.flatbuf.RecordBatch,fe=q.apache.arrow.flatbuf.DictionaryBatch;class Q{constructor(t,r,n,s){this._version=r,this._headerType=n,this.body=new Uint8Array(0),s&&(this._createHeader=()=>s),this._bodyLength=typeof t=="number"?t:t.low}static fromJSON(t,r){const n=new Q(0,dt.V4,r);return n._createHeader=Ih(t,r),n}static decode(t){t=new _h(x(t));const r=jt.getRootAsMessage(t),n=r.bodyLength(),s=r.version(),a=r.headerType(),i=new Q(n,s,a);return i._createHeader=Sh(r,a),i}static encode(t){let r=new gh,n=-1;return t.isSchema()?n=C.encode(r,t.header()):t.isRecordBatch()?n=ot.encode(r,t.header()):t.isDictionaryBatch()&&(n=Ot.encode(r,t.header())),jt.startMessage(r),jt.addVersion(r,dt.V4),jt.addHeader(r,n),jt.addHeaderType(r,t.headerType),jt.addBodyLength(r,new ee(t.bodyLength,0)),jt.finishMessageBuffer(r,jt.endMessage(r)),r.asUint8Array()}static from(t,r=0){if(t instanceof C)return new Q(0,dt.V4,j.Schema,t);if(t instanceof ot)return new Q(r,dt.V4,j.RecordBatch,t);if(t instanceof Ot)return new Q(r,dt.V4,j.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===j.Schema}isRecordBatch(){return this.headerType===j.RecordBatch}isDictionaryBatch(){return this.headerType===j.DictionaryBatch}}class ot{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}constructor(t,r,n){this._nodes=r,this._buffers=n,this._length=typeof t=="number"?t:t.low}}class Ot{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor(t,r,n=!1){this._data=t,this._isDelta=n,this._id=typeof r=="number"?r:r.low}}class Tt{constructor(t,r){this.offset=typeof t=="number"?t:t.low,this.length=typeof r=="number"?r:r.low}}class oe{constructor(t,r){this.length=typeof t=="number"?t:t.low,this.nullCount=typeof r=="number"?r:r.low}}function Ih(e,t){return()=>{switch(t){case j.Schema:return C.fromJSON(e);case j.RecordBatch:return ot.fromJSON(e);case j.DictionaryBatch:return Ot.fromJSON(e)}throw new Error(`Unrecognized Message type: { name: ${j[t]}, type: ${t} }`)}}function Sh(e,t){return()=>{switch(t){case j.Schema:return C.decode(e.header(new Mt));case j.RecordBatch:return ot.decode(e.header(new zt),e.version());case j.DictionaryBatch:return Ot.decode(e.header(new fe),e.version())}throw new Error(`Unrecognized Message type: { name: ${j[t]}, type: ${t} }`)}}M.encode=Eh;M.decode=Mh;M.fromJSON=mh;C.encode=Uh;C.decode=Bh;C.fromJSON=dh;ot.encode=Nh;ot.decode=Ah;ot.fromJSON=Ka;Ot.encode=Vh;Ot.decode=Th;Ot.fromJSON=ph;oe.encode=Ch;oe.decode=Oh;Tt.encode=Rh;Tt.decode=Fh;function Bh(e,t=new Map){const r=Lh(e,t);return new C(r,Sr(e),t)}function Ah(e,t=dt.V4){return new ot(e.length(),Dh(e),xh(e,t))}function Th(e,t=dt.V4){return new Ot(ot.decode(e.data(),t),e.id(),e.isDelta())}function Fh(e){return new Tt(e.offset(),e.length())}function Oh(e){return new oe(e.length(),e.nullCount())}function Dh(e){const t=[];for(let r,n=-1,s=-1,a=e.nodesLength();++n<a;)(r=e.nodes(n))&&(t[++s]=oe.decode(r));return t}function xh(e,t){const r=[];for(let n,s=-1,a=-1,i=e.buffersLength();++s<i;)(n=e.buffers(s))&&(t<dt.V4&&(n.bb_pos+=8*(s+1)),r[++a]=Tt.decode(n));return r}function Lh(e,t){const r=[];for(let n,s=-1,a=-1,i=e.fieldsLength();++s<i;)(n=e.fields(s))&&(r[++a]=M.decode(n,t));return r}function Is(e,t){const r=[];for(let n,s=-1,a=-1,i=e.childrenLength();++s<i;)(n=e.children(s))&&(r[++a]=M.decode(n,t));return r}function Mh(e,t){let r,n,s,a,i,o;return!t||!(o=e.dictionary())?(s=Bs(e,Is(e,t)),n=new M(e.name(),s,e.nullable(),Sr(e))):t.has(r=o.id().low)?(a=(a=o.indexType())?Ss(a):new Qt,i=new Ht(t.get(r),a,r,o.isOrdered()),n=new M(e.name(),i,e.nullable(),Sr(e))):(a=(a=o.indexType())?Ss(a):new Qt,t.set(r,s=Bs(e,Is(e,t))),i=new Ht(s,a,r,o.isOrdered()),n=new M(e.name(),i,e.nullable(),Sr(e))),n||null}function Sr(e){const t=new Map;if(e)for(let r,n,s=-1,a=e.customMetadataLength()|0;++s<a;)(r=e.customMetadata(s))&&(n=r.key())!=null&&t.set(n,r.value());return t}function Ss(e){return new tt(e.isSigned(),e.bitWidth())}function Bs(e,t){const r=e.typeType();switch(r){case H.NONE:return new Ie;case H.Null:return new Ie;case H.Binary:return new ze;case H.Utf8:return new Ae;case H.Bool:return new Pe;case H.List:return new Fe((t||[])[0]);case H.Struct_:return new _t(t||[])}switch(r){case H.Int:{const n=e.type(new f.apache.arrow.flatbuf.Int);return new tt(n.isSigned(),n.bitWidth())}case H.FloatingPoint:{const n=e.type(new f.apache.arrow.flatbuf.FloatingPoint);return new Xt(n.precision())}case H.Decimal:{const n=e.type(new f.apache.arrow.flatbuf.Decimal);return new Ur(n.scale(),n.precision())}case H.Date:{const n=e.type(new f.apache.arrow.flatbuf.Date);return new Te(n.unit())}case H.Time:{const n=e.type(new f.apache.arrow.flatbuf.Time);return new Er(n.unit(),n.bitWidth())}case H.Timestamp:{const n=e.type(new f.apache.arrow.flatbuf.Timestamp);return new Nr(n.unit(),n.timezone())}case H.Interval:{const n=e.type(new f.apache.arrow.flatbuf.Interval);return new Vr(n.unit())}case H.Union:{const n=e.type(new f.apache.arrow.flatbuf.Union);return new $e(n.mode(),n.typeIdsArray()||[],t||[])}case H.FixedSizeBinary:{const n=e.type(new f.apache.arrow.flatbuf.FixedSizeBinary);return new Cr(n.byteWidth())}case H.FixedSizeList:{const n=e.type(new f.apache.arrow.flatbuf.FixedSizeList);return new We(n.listSize(),(t||[])[0])}case H.Map:{const n=e.type(new f.apache.arrow.flatbuf.Map);return new Ye((t||[])[0],n.keysSorted())}}throw new Error(`Unrecognized type: "${H[r]}" (${r})`)}function Uh(e,t){const r=t.fields.map(a=>M.encode(e,a));Mt.startFieldsVector(e,r.length);const n=Mt.createFieldsVector(e,r),s=t.metadata&&t.metadata.size>0?Mt.createCustomMetadataVector(e,[...t.metadata].map(([a,i])=>{const o=e.createString(`${a}`),c=e.createString(`${i}`);return Pt.startKeyValue(e),Pt.addKey(e,o),Pt.addValue(e,c),Pt.endKeyValue(e)})):-1;return Mt.startSchema(e),Mt.addFields(e,n),Mt.addEndianness(e,kh?vs.Little:vs.Big),s!==-1&&Mt.addCustomMetadata(e,s),Mt.endSchema(e)}function Eh(e,t){let r=-1,n=-1,s=-1,a=t.type,i=t.typeId;A.isDictionary(a)?(i=a.dictionary.typeId,s=Ln.visit(a,e),n=Ln.visit(a.dictionary,e)):n=Ln.visit(a,e);const o=(a.children||[]).map(d=>M.encode(e,d)),c=ht.createChildrenVector(e,o),u=t.metadata&&t.metadata.size>0?ht.createCustomMetadataVector(e,[...t.metadata].map(([d,y])=>{const F=e.createString(`${d}`),U=e.createString(`${y}`);return Pt.startKeyValue(e),Pt.addKey(e,F),Pt.addValue(e,U),Pt.endKeyValue(e)})):-1;return t.name&&(r=e.createString(t.name)),ht.startField(e),ht.addType(e,n),ht.addTypeType(e,i),ht.addChildren(e,c),ht.addNullable(e,!!t.nullable),r!==-1&&ht.addName(e,r),s!==-1&&ht.addDictionary(e,s),u!==-1&&ht.addCustomMetadata(e,u),ht.endField(e)}function Nh(e,t){const r=t.nodes||[],n=t.buffers||[];zt.startNodesVector(e,r.length),r.slice().reverse().forEach(i=>oe.encode(e,i));const s=e.endVector();zt.startBuffersVector(e,n.length),n.slice().reverse().forEach(i=>Tt.encode(e,i));const a=e.endVector();return zt.startRecordBatch(e),zt.addLength(e,new ee(t.length,0)),zt.addNodes(e,s),zt.addBuffers(e,a),zt.endRecordBatch(e)}function Vh(e,t){const r=ot.encode(e,t.data);return fe.startDictionaryBatch(e),fe.addId(e,new ee(t.id,0)),fe.addIsDelta(e,t.isDelta),fe.addData(e,r),fe.endDictionaryBatch(e)}function Ch(e,t){return vh.createFieldNode(e,new ee(t.length,0),new ee(t.nullCount,0))}function Rh(e,t){return wh.createBuffer(e,new ee(t.offset,0),new ee(t.length,0))}const kh=function(){const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),new Int16Array(e)[0]===256}();var qa=h.ByteBuffer;const Oi=e=>`Expected ${j[e]} Message in stream, but was null or length 0.`,Di=e=>`Header pointer of flatbuffer-encoded ${j[e]} Message is null or length 0.`,Za=(e,t)=>`Expected to read ${e} metadata bytes, but only read ${t}.`,Qa=(e,t)=>`Expected to read ${e} bytes for message body, but only read ${t}.`;class Xa{constructor(t){this.source=t instanceof kr?t:new kr(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done||t.value===-1&&(t=this.readMetadataLength()).done||(t=this.readMetadata(t.value)).done?$:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let r;if((r=this.next()).done)return null;if(t!=null&&r.value.headerType!==t)throw new Error(Oi(t));return r.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);const r=x(this.source.read(t));if(r.byteLength<t)throw new Error(Qa(t,r.byteLength));return r.byteOffset%8===0&&r.byteOffset+r.byteLength<=r.buffer.byteLength?r:r.slice()}readSchema(t=!1){const r=j.Schema,n=this.readMessage(r),s=n&&n.header();if(t&&!s)throw new Error(Di(r));return s}readMetadataLength(){const t=this.source.read(pn),r=t&&new qa(t),n=r&&r.readInt32(0)||0;return{done:n===0,value:n}}readMetadata(t){const r=this.source.read(t);if(!r)return $;if(r.byteLength<t)throw new Error(Za(t,r.byteLength));return{done:!1,value:Q.decode(r)}}}class jh{constructor(t,r){this.source=t instanceof te?t:ta(t)?new jr(t,r):new te(t)}[Symbol.asyncIterator](){return this}async next(){let t;return(t=await this.readMetadataLength()).done||t.value===-1&&(t=await this.readMetadataLength()).done||(t=await this.readMetadata(t.value)).done?$:t}async throw(t){return await this.source.throw(t)}async return(t){return await this.source.return(t)}async readMessage(t){let r;if((r=await this.next()).done)return null;if(t!=null&&r.value.headerType!==t)throw new Error(Oi(t));return r.value}async readMessageBody(t){if(t<=0)return new Uint8Array(0);const r=x(await this.source.read(t));if(r.byteLength<t)throw new Error(Qa(t,r.byteLength));return r.byteOffset%8===0&&r.byteOffset+r.byteLength<=r.buffer.byteLength?r:r.slice()}async readSchema(t=!1){const r=j.Schema,n=await this.readMessage(r),s=n&&n.header();if(t&&!s)throw new Error(Di(r));return s}async readMetadataLength(){const t=await this.source.read(pn),r=t&&new qa(t),n=r&&r.readInt32(0)||0;return{done:n===0,value:n}}async readMetadata(t){const r=await this.source.read(t);if(!r)return $;if(r.byteLength<t)throw new Error(Za(t,r.byteLength));return{done:!1,value:Q.decode(r)}}}class zh extends Xa{constructor(t){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof is?t:new is(t)}next(){const{_json:t}=this;if(!this._schema){this._schema=!0;const r=Q.fromJSON(t.schema,j.Schema);return{done:!1,value:r}}if(this._dictionaryIndex<t.dictionaries.length){const r=t.dictionaries[this._dictionaryIndex++];this._body=r.data.columns;const n=Q.fromJSON(r,j.DictionaryBatch);return{done:!1,value:n}}if(this._batchIndex<t.batches.length){const r=t.batches[this._batchIndex++];this._body=r.columns;const n=Q.fromJSON(r,j.RecordBatch);return{done:!1,value:n}}return this._body=[],$}readMessageBody(t){return r(this._body);function r(n){return(n||[]).reduce((s,a)=>[...s,...a.VALIDITY&&[a.VALIDITY]||[],...a.TYPE&&[a.TYPE]||[],...a.OFFSET&&[a.OFFSET]||[],...a.DATA&&[a.DATA]||[],...r(a.children)],[])}}readMessage(t){let r;if((r=this.next()).done)return null;if(t!=null&&r.value.headerType!==t)throw new Error(Oi(t));return r.value}readSchema(){const t=j.Schema,r=this.readMessage(t),n=r&&r.header();if(!r||!n)throw new Error(Di(t));return n}}const pn=4,Wn="ARROW1",Ge=new Uint8Array(Wn.length);for(let e=0;e<Wn.length;e+=1)Ge[e]=Wn.charCodeAt(e);function xi(e,t=0){for(let r=-1,n=Ge.length;++r<n;)if(Ge[r]!==e[t+r])return!1;return!0}const cr=Ge.length,to=cr+pn,Ph=cr*2+pn;class Y extends D{constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}static assemble(...t){const r=new Y,n=Sl(X,t),[s=r]=r.visitMany(n);return s}visit(t){if(!A.isDictionary(t.type)){const{data:r,length:n,nullCount:s}=t;if(n>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");A.isNull(t.type)||yt.call(this,s<=0?new Uint8Array(0):on(r.offset,n,r.nullBitmap)),this.nodes.push(new oe(n,s))}return super.visit(t)}visitNull(t){return this}visitDictionary(t){return this.visit(t.indices)}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}function yt(e){const t=e.byteLength+7&-8;return this.buffers.push(e),this.bufferRegions.push(new Tt(this._byteLength,t)),this._byteLength+=t,this}function $h(e){const{type:t,length:r,typeIds:n,valueOffsets:s}=e;if(yt.call(this,n),t.mode===Nt.Sparse)return Yn.call(this,e);if(t.mode===Nt.Dense){if(e.offset<=0)return yt.call(this,s),Yn.call(this,e);{const a=n.reduce((d,y)=>Math.max(d,y),n[0]),i=new Int32Array(a+1),o=new Int32Array(a+1).fill(-1),c=new Int32Array(r),u=an(-s[0],r,s);for(let d,y,F=-1;++F<r;)(y=o[d=n[F]])===-1&&(y=o[d]=u[d]),c[F]=u[F]-y,++i[d];yt.call(this,c);for(let d,y=-1,F=t.children.length;++y<F;)if(d=e.getChildAt(y)){const U=t.typeIds[y],Bt=Math.min(r,i[U]);this.visit(d.slice(o[U],Bt))}}}return this}function Wh(e){let t;return e.nullCount>=e.length?yt.call(this,new Uint8Array(0)):(t=e.values)instanceof Uint8Array?yt.call(this,on(e.offset,e.length,t)):yt.call(this,je(e))}function Gt(e){return yt.call(this,e.values.subarray(0,e.length*e.stride))}function eo(e){const{length:t,values:r,valueOffsets:n}=e,s=n[0],a=n[t],i=Math.min(a-s,r.byteLength-s);return yt.call(this,an(-n[0],t,n)),yt.call(this,r.subarray(s,s+i)),this}function Li(e){const{length:t,valueOffsets:r}=e;return r&&yt.call(this,an(r[0],t,r)),this.visit(e.getChildAt(0))}function Yn(e){return this.visitMany(e.type.children.map((t,r)=>e.getChildAt(r)).filter(Boolean))[0]}Y.prototype.visitBool=Wh;Y.prototype.visitInt=Gt;Y.prototype.visitFloat=Gt;Y.prototype.visitUtf8=eo;Y.prototype.visitBinary=eo;Y.prototype.visitFixedSizeBinary=Gt;Y.prototype.visitDate=Gt;Y.prototype.visitTimestamp=Gt;Y.prototype.visitTime=Gt;Y.prototype.visitDecimal=Gt;Y.prototype.visitList=Li;Y.prototype.visitStruct=Yn;Y.prototype.visitUnion=$h;Y.prototype.visitInterval=Gt;Y.prototype.visitFixedSizeList=Li;Y.prototype.visitMap=Li;class Mi extends ie{constructor(t){super(),this._position=0,this._started=!1,this._sink=new Ve,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,at(t)||(t={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof t.autoDestroy=="boolean"?t.autoDestroy:!0,this._writeLegacyIpcFormat=typeof t.writeLegacyIpcFormat=="boolean"?t.writeLegacyIpcFormat:!1}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,r){throw new Error('"throughDOM" not available in this environment')}toString(t=!1){return this._sink.toString(t)}toUint8Array(t=!1){return this._sink.toUint8Array(t)}writeAll(t){return Yt(t)?t.then(r=>this.writeAll(r)):Ct(t)?Vi(this,t):Ni(this,t)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(t){return this._sink.toDOMStream(t)}toNodeStream(t){return this._sink.toNodeStream(t)}close(){return this.reset()._sink.close()}abort(t){return this.reset()._sink.abort(t)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(t=this._sink,r=null){return t===this._sink||t instanceof Ve?this._sink=t:(this._sink=new Ve,t&&Vc(t)?this.toDOMStream({type:"bytes"}).pipeTo(t):t&&Cc(t)&&this.toNodeStream({objectMode:!1}).pipe(t)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(!r||!r.compareTo(this._schema))&&(r===null?(this._position=0,this._schema=null):(this._started=!0,this._schema=r,this._writeSchema(r))),this}write(t){let r=null;if(this._sink){if(t==null)return this.finish()&&void 0;if(t instanceof E&&!(r=t.schema))return this.finish()&&void 0;if(t instanceof X&&!(r=t.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(r&&!r.compareTo(this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,r)}t instanceof X?t instanceof gn||this._writeRecordBatch(t):t instanceof E?this.writeAll(t.chunks):mt(t)&&this.writeAll(t)}_writeMessage(t,r=8){const n=r-1,s=Q.encode(t),a=s.byteLength,i=this._writeLegacyIpcFormat?4:8,o=a+i+n&~n,c=o-a-i;return t.headerType===j.RecordBatch?this._recordBatchBlocks.push(new Kt(o,t.bodyLength,this._position)):t.headerType===j.DictionaryBatch&&this._dictionaryBlocks.push(new Kt(o,t.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(o-i)),a>0&&this._write(s),this._writePadding(c)}_write(t){if(this._started){const r=x(t);r&&r.byteLength>0&&(this._sink.write(r),this._position+=r.byteLength)}return this}_writeSchema(t){return this._writeMessage(Q.from(t))}_writeFooter(t){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(Ge)}_writePadding(t){return t>0?this._write(new Uint8Array(t)):this}_writeRecordBatch(t){const{byteLength:r,nodes:n,bufferRegions:s,buffers:a}=Y.assemble(t),i=new ot(t.length,n,s),o=Q.from(i,r);return this._writeDictionaries(t)._writeMessage(o)._writeBodyBuffers(a)}_writeDictionaryBatch(t,r,n=!1){this._dictionaryDeltaOffsets.set(r,t.length+(this._dictionaryDeltaOffsets.get(r)||0));const{byteLength:s,nodes:a,bufferRegions:i,buffers:o}=Y.assemble(t),c=new ot(t.length,a,i),u=new Ot(c,r,n),d=Q.from(u,s);return this._writeMessage(d)._writeBodyBuffers(o)}_writeBodyBuffers(t){let r,n,s;for(let a=-1,i=t.length;++a<i;)(r=t[a])&&(n=r.byteLength)>0&&(this._write(r),(s=(n+7&-8)-n)>0&&this._writePadding(s));return this}_writeDictionaries(t){for(let[r,n]of t.dictionaries){let s=this._dictionaryDeltaOffsets.get(r)||0;if(s===0||(n=n.slice(s)).length>0){const a="chunks"in n?n.chunks:[n];for(const i of a)this._writeDictionaryBatch(i,r,s>0),s+=i.length}}return this}}class Ui extends Mi{static writeAll(t,r){const n=new Ui(r);return Yt(t)?t.then(s=>n.writeAll(s)):Ct(t)?Vi(n,t):Ni(n,t)}}class Ei extends Mi{constructor(){super(),this._autoDestroy=!0}static writeAll(t){const r=new Ei;return Yt(t)?t.then(n=>r.writeAll(n)):Ct(t)?Vi(r,t):Ni(r,t)}_writeSchema(t){return this._writeMagic()._writePadding(2)}_writeFooter(t){const r=Je.encode(new Je(t,dt.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(t)._write(r)._write(Int32Array.of(r.byteLength))._writeMagic()}}function Ni(e,t){let r=t;t instanceof E&&(r=t.chunks,e.reset(void 0,t.schema));for(const n of r)e.write(n);return e.finish()}async function Vi(e,t){for await(const r of t)e.write(r);return e.finish()}const Mn=new Uint8Array(0),ro=e=>[Mn,Mn,new Uint8Array(e),Mn];function Yh(e,t,r=t.reduce((n,s)=>Math.max(n,s.length),0)){let n,s,a=-1,i=t.length;const o=[...e.fields],c=[],u=(r+63&-64)>>3;for(;++a<i;)(n=t[a])&&n.length===r?c[a]=n:((s=o[a]).nullable||(o[a]=o[a].clone({nullable:!0})),c[a]=n?n._changeLengthAndBackfillNullBitmap(r):p.new(s.type,0,r,r,ro(u)));return[new C(o),r,c]}function Hh(e){return no(new C(e.map(({field:t})=>t)),e)}function no(e,t){return Kh(e,t.map(r=>r instanceof G?r.chunks.map(n=>n.data):[r.data]))}function Kh(e,t){const r=[...e.fields],n=[],s={numBatches:t.reduce((y,F)=>Math.max(y,F.length),0)};let a=0,i=0,o=-1,c=t.length,u,d=[];for(;s.numBatches-- >0;){for(i=Number.POSITIVE_INFINITY,o=-1;++o<c;)d[o]=u=t[o].shift(),i=Math.min(i,u?u.length:i);isFinite(i)&&(d=Jh(r,i,d,t,s),i>0&&(n[a++]=[i,d.slice()]))}return[e=new C(r,e.metadata),n.map(y=>new X(e,...y))]}function Jh(e,t,r,n,s){let a,i,o=0,c=-1,u=n.length;const d=(t+63&-64)>>3;for(;++c<u;)(a=r[c])&&(o=a.length)>=t?o===t?r[c]=a:(r[c]=a.slice(0,t),a=a.slice(t,o-t),s.numBatches=Math.max(s.numBatches,n[c].unshift(a))):((i=e[c]).nullable||(e[c]=i.clone({nullable:!0})),r[c]=a?a._changeLengthAndBackfillNullBitmap(t):p.new(i.type,0,t,t,ro(d)));return r}class z extends L{constructor(t,r){super(),this._children=r,this.numChildren=t.childData.length,this._bindDataAccessors(this.data=t)}get type(){return this.data.type}get typeId(){return this.data.typeId}get length(){return this.data.length}get offset(){return this.data.offset}get stride(){return this.data.stride}get nullCount(){return this.data.nullCount}get byteLength(){return this.data.byteLength}get VectorName(){return`${l[this.typeId]}Vector`}get ArrayType(){return this.type.ArrayType}get values(){return this.data.values}get typeIds(){return this.data.typeIds}get nullBitmap(){return this.data.nullBitmap}get valueOffsets(){return this.data.valueOffsets}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}clone(t,r=this._children){return L.new(t,r)}concat(...t){return G.concat(this,...t)}slice(t,r){return wi(this,t,r,this._sliceInternal)}isValid(t){if(this.nullCount>0){const r=this.offset+t;return(this.nullBitmap[r>>3]&1<<r%8)!==0}return!0}getChildAt(t){return t<0||t>=this.numChildren?null:(this._children||(this._children=[]))[t]||(this._children[t]=L.new(this.data.childData[t]))}toJSON(){return[...this]}_sliceInternal(t,r,n){return t.clone(t.data.slice(r,n-r),null)}_bindDataAccessors(t){}}z.prototype[Symbol.isConcatSpreadable]=!0;class Gh extends z{asUtf8(){return L.new(this.data.clone(new Ae))}}class qh extends z{static from(t){return re(()=>new Pe,t)}}class Ci extends z{static from(...t){return t.length===2?re(()=>t[1]===Ft.DAY?new Su:new ss,t[0]):re(()=>new ss,t[0])}}class Zh extends Ci{}class Qh extends Ci{}class Xh extends z{}class Ri extends z{constructor(t){super(t),this.indices=L.new(t.clone(this.type.indices))}static from(...t){if(t.length===3){const[r,n,s]=t,a=new Ht(r.type,n,null,null);return L.new(p.Dictionary(a,0,s.length,0,null,s,r))}return re(()=>t[0].type,t[0])}get dictionary(){return this.data.dictionary}reverseLookup(t){return this.dictionary.indexOf(t)}getKey(t){return this.indices.get(t)}getValue(t){return this.dictionary.get(t)}setKey(t,r){return this.indices.set(t,r)}setValue(t,r){return this.dictionary.set(t,r)}}Ri.prototype.indices=null;class tf extends z{}class ef extends z{}class yn extends z{static from(t){let r=sf(this);if(t instanceof ArrayBuffer||ArrayBuffer.isView(t)){let n=nf(t.constructor)||r;if(r===null&&(r=n),r&&r===n){let s=new r,a=t.byteLength/s.ArrayType.BYTES_PER_ELEMENT;if(!rf(r,t.constructor))return L.new(p.Float(s,0,a,0,null,t))}}if(r)return re(()=>new r,t);throw t instanceof DataView||t instanceof ArrayBuffer?new TypeError(`Cannot infer float type from instance of ${t.constructor.name}`):new TypeError("Unrecognized FloatVector input")}}class io extends yn{toFloat32Array(){return new Float32Array(this)}toFloat64Array(){return new Float64Array(this)}}class so extends yn{}class ao extends yn{}const rf=(e,t)=>e===un&&t!==Uint16Array,nf=e=>{switch(e){case Uint16Array:return un;case Float32Array:return pi;case Float64Array:return yi;default:return null}},sf=e=>{switch(e){case io:return un;case so:return pi;case ao:return yi;default:return null}};class ki extends z{}class af extends ki{}class of extends ki{}class St extends z{static from(...t){let[r,n=!1]=t,s=lf(this,n);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)){let a=uf(r.constructor,n)||s;if(s===null&&(s=a),s&&s===a){let i=new s,o=r.byteLength/i.ArrayType.BYTES_PER_ELEMENT;return cf(s,r.constructor)&&(o*=.5),L.new(p.Int(i,0,o,0,null,r))}}if(s)return re(()=>new s,r);throw r instanceof DataView||r instanceof ArrayBuffer?new TypeError(`Cannot infer integer type from instance of ${r.constructor.name}`):new TypeError("Unrecognized IntVector input")}}class oo extends St{}class co extends St{}class uo extends St{}class lo extends St{toBigInt64Array(){return na(this.values)}get values64(){return this._values64||(this._values64=this.toBigInt64Array())}}class ho extends St{}class fo extends St{}class po extends St{}class yo extends St{toBigUint64Array(){return ia(this.values)}get values64(){return this._values64||(this._values64=this.toBigUint64Array())}}const cf=(e,t)=>(e===Se||e===Be)&&(t===Int32Array||t===Uint32Array),uf=(e,t)=>{switch(e){case Int8Array:return ui;case Int16Array:return li;case Int32Array:return t?Se:Qt;case Le:return Se;case Uint8Array:return hi;case Uint16Array:return fi;case Uint32Array:return t?Be:di;case Xe:return Be;default:return null}},lf=(e,t)=>{switch(e){case oo:return ui;case co:return li;case uo:return t?Se:Qt;case lo:return Se;case ho:return hi;case fo:return fi;case po:return t?Be:di;case yo:return Be;default:return null}};class hf extends z{}class ff extends z{asList(){const t=this.type.children[0];return L.new(this.data.clone(new Fe(t)))}bind(t){const r=this.getChildAt(0),{[t]:n,[t+1]:s}=this.valueOffsets;return new Ia(r.slice(n,s))}}class df extends z{}const pf=Symbol.for("rowIndex");class bn extends z{bind(t){const r=this._row||(this._row=new Sa(this)),n=Object.create(r);return n[pf]=t,n}}class ur extends z{}class yf extends ur{}class bf extends ur{}class mf extends ur{}class gf extends ur{}class lr extends z{}class _f extends lr{}class wf extends lr{}class vf extends lr{}class If extends lr{}class ji extends z{get typeIdToChildIndex(){return this.data.type.typeIdToChildIndex}}class Sf extends ji{get valueOffsets(){return this.data.valueOffsets}}class Bf extends ji{}class Af extends z{static from(t){return re(()=>new Ae,t)}asBinary(){return L.new(this.data.clone(new ze))}}function As(e){return function(){return e(this)}}function Tf(e){return function(t){return e(this,t)}}function Ts(e){return function(t,r){return e(this,t,r)}}class g extends D{}const Ff=(e,t)=>864e5*e[t],zi=(e,t)=>4294967296*e[t+1]+(e[t]>>>0),Of=(e,t)=>4294967296*(e[t+1]/1e3)+(e[t]>>>0)/1e3,Df=(e,t)=>4294967296*(e[t+1]/1e6)+(e[t]>>>0)/1e6,bo=e=>new Date(e),xf=(e,t)=>bo(Ff(e,t)),Lf=(e,t)=>bo(zi(e,t)),Mf=(e,t)=>null,mo=(e,t,r)=>{const{[r]:n,[r+1]:s}=t;return n!=null&&s!=null?e.subarray(n,s):null},Uf=({offset:e,values:t},r)=>{const n=e+r;return(t[n>>3]&1<<n%8)!==0},go=({values:e},t)=>xf(e,t),_o=({values:e},t)=>Lf(e,t*2),Lt=({stride:e,values:t},r)=>t[e*r],wo=({stride:e,values:t},r)=>ma(t[e*r]),Pi=({stride:e,values:t,type:r},n)=>se.new(t.subarray(e*n,e*(n+1)),r.isSigned),Ef=({stride:e,values:t},r)=>t.subarray(e*r,e*(r+1)),Nf=({values:e,valueOffsets:t},r)=>mo(e,t,r),Vf=({values:e,valueOffsets:t},r)=>{const n=mo(e,t,r);return n!==null?Rn(n):null},Cf=(e,t)=>e.type.bitWidth<64?Lt(e,t):Pi(e,t),Rf=(e,t)=>e.type.precision!==ut.HALF?Lt(e,t):wo(e,t),kf=(e,t)=>e.type.unit===Ft.DAY?go(e,t):_o(e,t),vo=({values:e},t)=>1e3*zi(e,t*2),Io=({values:e},t)=>zi(e,t*2),So=({values:e},t)=>Of(e,t*2),Bo=({values:e},t)=>Df(e,t*2),jf=(e,t)=>{switch(e.type.unit){case V.SECOND:return vo(e,t);case V.MILLISECOND:return Io(e,t);case V.MICROSECOND:return So(e,t);case V.NANOSECOND:return Bo(e,t)}},Ao=({values:e,stride:t},r)=>e[t*r],To=({values:e,stride:t},r)=>e[t*r],Fo=({values:e},t)=>se.signed(e.subarray(2*t,2*(t+1))),Oo=({values:e},t)=>se.signed(e.subarray(2*t,2*(t+1))),zf=(e,t)=>{switch(e.type.unit){case V.SECOND:return Ao(e,t);case V.MILLISECOND:return To(e,t);case V.MICROSECOND:return Fo(e,t);case V.NANOSECOND:return Oo(e,t)}},Pf=({values:e},t)=>se.decimal(e.subarray(4*t,4*(t+1))),$f=(e,t)=>{const r=e.getChildAt(0),{valueOffsets:n,stride:s}=e;return r.slice(n[t*s],n[t*s+1])},Wf=(e,t)=>e.bind(t),Yf=(e,t)=>e.bind(t),Hf=(e,t)=>e.type.mode===Nt.Dense?Do(e,t):xo(e,t),Do=(e,t)=>{const r=e.typeIdToChildIndex[e.typeIds[t]],n=e.getChildAt(r);return n?n.get(e.valueOffsets[t]):null},xo=(e,t)=>{const r=e.typeIdToChildIndex[e.typeIds[t]],n=e.getChildAt(r);return n?n.get(t):null},Kf=(e,t)=>e.getValue(e.getKey(t)),Jf=(e,t)=>e.type.unit===ve.DAY_TIME?Lo(e,t):Mo(e,t),Lo=({values:e},t)=>e.subarray(2*t,2*(t+1)),Mo=({values:e},t)=>{const r=e[t],n=new Int32Array(2);return n[0]=r/12|0,n[1]=r%12|0,n},Gf=(e,t)=>{const r=e.getChildAt(0),{stride:n}=e;return r.slice(t*n,(t+1)*n)};g.prototype.visitNull=Mf;g.prototype.visitBool=Uf;g.prototype.visitInt=Cf;g.prototype.visitInt8=Lt;g.prototype.visitInt16=Lt;g.prototype.visitInt32=Lt;g.prototype.visitInt64=Pi;g.prototype.visitUint8=Lt;g.prototype.visitUint16=Lt;g.prototype.visitUint32=Lt;g.prototype.visitUint64=Pi;g.prototype.visitFloat=Rf;g.prototype.visitFloat16=wo;g.prototype.visitFloat32=Lt;g.prototype.visitFloat64=Lt;g.prototype.visitUtf8=Vf;g.prototype.visitBinary=Nf;g.prototype.visitFixedSizeBinary=Ef;g.prototype.visitDate=kf;g.prototype.visitDateDay=go;g.prototype.visitDateMillisecond=_o;g.prototype.visitTimestamp=jf;g.prototype.visitTimestampSecond=vo;g.prototype.visitTimestampMillisecond=Io;g.prototype.visitTimestampMicrosecond=So;g.prototype.visitTimestampNanosecond=Bo;g.prototype.visitTime=zf;g.prototype.visitTimeSecond=Ao;g.prototype.visitTimeMillisecond=To;g.prototype.visitTimeMicrosecond=Fo;g.prototype.visitTimeNanosecond=Oo;g.prototype.visitDecimal=Pf;g.prototype.visitList=$f;g.prototype.visitStruct=Yf;g.prototype.visitUnion=Hf;g.prototype.visitDenseUnion=Do;g.prototype.visitSparseUnion=xo;g.prototype.visitDictionary=Kf;g.prototype.visitInterval=Jf;g.prototype.visitIntervalDayTime=Lo;g.prototype.visitIntervalYearMonth=Mo;g.prototype.visitFixedSizeList=Gf;g.prototype.visitMap=Wf;const mn=new g;class _ extends D{}function qf(e,t){return t===null&&e.length>0?0:-1}function Zf(e,t){const{nullBitmap:r}=e;if(!r||e.nullCount<=0)return-1;let n=0;for(const s of tr(r,e.data.offset+(t||0),e.length,r,si)){if(!s)return n;++n}return-1}function T(e,t,r){if(t===void 0)return-1;if(t===null)return Zf(e,r);const n=ae(t);for(let s=(r||0)-1,a=e.length;++s<a;)if(n(e.get(s)))return s;return-1}function Uo(e,t,r){const n=ae(t);for(let s=(r||0)-1,a=e.length;++s<a;)if(n(e.get(s)))return s;return-1}_.prototype.visitNull=qf;_.prototype.visitBool=T;_.prototype.visitInt=T;_.prototype.visitInt8=T;_.prototype.visitInt16=T;_.prototype.visitInt32=T;_.prototype.visitInt64=T;_.prototype.visitUint8=T;_.prototype.visitUint16=T;_.prototype.visitUint32=T;_.prototype.visitUint64=T;_.prototype.visitFloat=T;_.prototype.visitFloat16=T;_.prototype.visitFloat32=T;_.prototype.visitFloat64=T;_.prototype.visitUtf8=T;_.prototype.visitBinary=T;_.prototype.visitFixedSizeBinary=T;_.prototype.visitDate=T;_.prototype.visitDateDay=T;_.prototype.visitDateMillisecond=T;_.prototype.visitTimestamp=T;_.prototype.visitTimestampSecond=T;_.prototype.visitTimestampMillisecond=T;_.prototype.visitTimestampMicrosecond=T;_.prototype.visitTimestampNanosecond=T;_.prototype.visitTime=T;_.prototype.visitTimeSecond=T;_.prototype.visitTimeMillisecond=T;_.prototype.visitTimeMicrosecond=T;_.prototype.visitTimeNanosecond=T;_.prototype.visitDecimal=T;_.prototype.visitList=T;_.prototype.visitStruct=T;_.prototype.visitUnion=T;_.prototype.visitDenseUnion=Uo;_.prototype.visitSparseUnion=Uo;_.prototype.visitDictionary=T;_.prototype.visitInterval=T;_.prototype.visitIntervalDayTime=T;_.prototype.visitIntervalYearMonth=T;_.prototype.visitFixedSizeList=T;_.prototype.visitMap=T;const Eo=new _;class w extends D{}function Qf(e){const t=mn.getVisitFn(e);return tr(e.nullBitmap,e.offset,e.length,e,(r,n,s,a)=>(s&1<<a)!==0?t(r,n):null)}function S(e){if(e.nullCount>0)return Qf(e);const{type:t,typeId:r,length:n}=e;return e.stride===1&&(r===l.Timestamp||r===l.Int&&t.bitWidth!==64||r===l.Time&&t.bitWidth!==64||r===l.Float&&t.precision>0)?e.values.subarray(0,n)[Symbol.iterator]():function*(s){for(let a=-1;++a<n;)yield s(e,a)}(mn.getVisitFn(e))}w.prototype.visitNull=S;w.prototype.visitBool=S;w.prototype.visitInt=S;w.prototype.visitInt8=S;w.prototype.visitInt16=S;w.prototype.visitInt32=S;w.prototype.visitInt64=S;w.prototype.visitUint8=S;w.prototype.visitUint16=S;w.prototype.visitUint32=S;w.prototype.visitUint64=S;w.prototype.visitFloat=S;w.prototype.visitFloat16=S;w.prototype.visitFloat32=S;w.prototype.visitFloat64=S;w.prototype.visitUtf8=S;w.prototype.visitBinary=S;w.prototype.visitFixedSizeBinary=S;w.prototype.visitDate=S;w.prototype.visitDateDay=S;w.prototype.visitDateMillisecond=S;w.prototype.visitTimestamp=S;w.prototype.visitTimestampSecond=S;w.prototype.visitTimestampMillisecond=S;w.prototype.visitTimestampMicrosecond=S;w.prototype.visitTimestampNanosecond=S;w.prototype.visitTime=S;w.prototype.visitTimeSecond=S;w.prototype.visitTimeMillisecond=S;w.prototype.visitTimeMicrosecond=S;w.prototype.visitTimeNanosecond=S;w.prototype.visitDecimal=S;w.prototype.visitList=S;w.prototype.visitStruct=S;w.prototype.visitUnion=S;w.prototype.visitDenseUnion=S;w.prototype.visitSparseUnion=S;w.prototype.visitDictionary=S;w.prototype.visitInterval=S;w.prototype.visitIntervalDayTime=S;w.prototype.visitIntervalYearMonth=S;w.prototype.visitFixedSizeList=S;w.prototype.visitMap=S;const $i=new w;class v extends D{}function B(e){const{type:t,length:r,stride:n}=e;switch(t.typeId){case l.Int:case l.Float:case l.Decimal:case l.Time:case l.Timestamp:return e.values.subarray(0,r*n)}return[...$i.visit(e)]}v.prototype.visitNull=B;v.prototype.visitBool=B;v.prototype.visitInt=B;v.prototype.visitInt8=B;v.prototype.visitInt16=B;v.prototype.visitInt32=B;v.prototype.visitInt64=B;v.prototype.visitUint8=B;v.prototype.visitUint16=B;v.prototype.visitUint32=B;v.prototype.visitUint64=B;v.prototype.visitFloat=B;v.prototype.visitFloat16=B;v.prototype.visitFloat32=B;v.prototype.visitFloat64=B;v.prototype.visitUtf8=B;v.prototype.visitBinary=B;v.prototype.visitFixedSizeBinary=B;v.prototype.visitDate=B;v.prototype.visitDateDay=B;v.prototype.visitDateMillisecond=B;v.prototype.visitTimestamp=B;v.prototype.visitTimestampSecond=B;v.prototype.visitTimestampMillisecond=B;v.prototype.visitTimestampMicrosecond=B;v.prototype.visitTimestampNanosecond=B;v.prototype.visitTime=B;v.prototype.visitTimeSecond=B;v.prototype.visitTimeMillisecond=B;v.prototype.visitTimeMicrosecond=B;v.prototype.visitTimeNanosecond=B;v.prototype.visitDecimal=B;v.prototype.visitList=B;v.prototype.visitStruct=B;v.prototype.visitUnion=B;v.prototype.visitDenseUnion=B;v.prototype.visitSparseUnion=B;v.prototype.visitDictionary=B;v.prototype.visitInterval=B;v.prototype.visitIntervalDayTime=B;v.prototype.visitIntervalYearMonth=B;v.prototype.visitFixedSizeList=B;v.prototype.visitMap=B;const No=new v,Ue=(e,t)=>e+t,Un=e=>`Cannot compute the byte width of variable-width column ${e}`;class Xf extends D{visitNull(t){return 0}visitInt(t){return t.bitWidth/8}visitFloat(t){return t.ArrayType.BYTES_PER_ELEMENT}visitBinary(t){throw new Error(Un(t))}visitUtf8(t){throw new Error(Un(t))}visitBool(t){return 1/8}visitDecimal(t){return 16}visitDate(t){return(t.unit+1)*4}visitTime(t){return t.bitWidth/8}visitTimestamp(t){return t.unit===V.SECOND?4:8}visitInterval(t){return(t.unit+1)*4}visitList(t){throw new Error(Un(t))}visitStruct(t){return this.visitFields(t.children).reduce(Ue,0)}visitUnion(t){return this.visitFields(t.children).reduce(Ue,0)}visitFixedSizeBinary(t){return t.byteWidth}visitFixedSizeList(t){return t.listSize*this.visitFields(t.children).reduce(Ue,0)}visitMap(t){return this.visitFields(t.children).reduce(Ue,0)}visitDictionary(t){return this.visit(t.indices)}visitFields(t){return(t||[]).map(r=>this.visit(r.type))}visitSchema(t){return this.visitFields(t.fields).reduce(Ue,0)}}const Vo=new Xf;class td extends D{visitNull(){return df}visitBool(){return qh}visitInt(){return St}visitInt8(){return oo}visitInt16(){return co}visitInt32(){return uo}visitInt64(){return lo}visitUint8(){return ho}visitUint16(){return fo}visitUint32(){return po}visitUint64(){return yo}visitFloat(){return yn}visitFloat16(){return io}visitFloat32(){return so}visitFloat64(){return ao}visitUtf8(){return Af}visitBinary(){return Gh}visitFixedSizeBinary(){return tf}visitDate(){return Ci}visitDateDay(){return Zh}visitDateMillisecond(){return Qh}visitTimestamp(){return ur}visitTimestampSecond(){return yf}visitTimestampMillisecond(){return bf}visitTimestampMicrosecond(){return mf}visitTimestampNanosecond(){return gf}visitTime(){return lr}visitTimeSecond(){return _f}visitTimeMillisecond(){return wf}visitTimeMicrosecond(){return vf}visitTimeNanosecond(){return If}visitDecimal(){return Xh}visitList(){return hf}visitStruct(){return bn}visitUnion(){return ji}visitDenseUnion(){return Sf}visitSparseUnion(){return Bf}visitDictionary(){return Ri}visitInterval(){return ki}visitIntervalDayTime(){return af}visitIntervalYearMonth(){return of}visitFixedSizeList(){return ef}visitMap(){return ff}}const Co=new td;L.new=ed;L.from=rd;function ed(e,...t){return new(Co.getVisitFn(e)())(e,...t)}function re(e,t){if(mt(t))return L.from({nullValues:[null,void 0],type:e(),values:t});if(Ct(t))return L.from({nullValues:[null,void 0],type:e(),values:t});const{values:r=[],type:n=e(),nullValues:s=[null,void 0]}={...t};return mt(r)?L.from({nullValues:s,...t,type:n}):L.from({nullValues:s,...t,type:n})}function rd(e){const{values:t=[],...r}={nullValues:[null,void 0],...e};if(mt(t)){const n=[...W.throughIterable(r)(t)];return n.length===1?n[0]:G.concat(n)}return(async n=>{const s=W.throughAsyncIterable(r);for await(const a of s(t))n.push(a);return n.length===1?n[0]:G.concat(n)})([])}z.prototype.get=function(t){return mn.visit(this,t)};z.prototype.set=function(t,r){return dn.visit(this,t,r)};z.prototype.indexOf=function(t,r){return Eo.visit(this,t,r)};z.prototype.toArray=function(){return No.visit(this)};z.prototype.getByteWidth=function(){return Vo.visit(this.type)};z.prototype[Symbol.iterator]=function(){return $i.visit(this)};z.prototype._bindDataAccessors=ad;Object.keys(l).map(e=>l[e]).filter(e=>typeof e=="number").filter(e=>e!==l.NONE).forEach(e=>{const t=Co.visit(e);t.prototype.get=Tf(mn.getVisitFn(e)),t.prototype.set=Ts(dn.getVisitFn(e)),t.prototype.indexOf=Ts(Eo.getVisitFn(e)),t.prototype.toArray=As(No.getVisitFn(e)),t.prototype.getByteWidth=nd(Vo.getVisitFn(e)),t.prototype[Symbol.iterator]=As($i.getVisitFn(e))});function nd(e){return function(){return e(this.type)}}function id(e){return function(t){return this.isValid(t)?e.call(this,t):null}}function sd(e){return function(t,r){la(this.nullBitmap,this.offset+t,r!=null)&&e.call(this,t,r)}}function ad(){const e=this.nullBitmap;e&&e.byteLength>0&&(this.get=id(this.get),this.set=sd(this.set))}class E extends G{constructor(...t){let r=null;t[0]instanceof C&&(r=t.shift());let n=Aa(X,t);if(!r&&!(r=n[0]&&n[0].schema))throw new TypeError("Table must be initialized with a Schema or at least one RecordBatch");n[0]||(n[0]=new gn(r)),super(new _t(r.fields),n),this._schema=r,this._chunks=n}static empty(t=new C([])){return new E(t,[])}static from(t){if(!t)return E.empty();if(typeof t=="object"){let n=mt(t.values)?od(t):Ct(t.values)?cd(t):null;if(n!==null)return n}let r=bt.from(t);return Yt(r)?(async()=>await E.from(await r))():r.isSync()&&(r=r.open())?r.schema?new E(r.schema,[...r]):E.empty():(async n=>{const s=await n,a=s.schema,i=[];if(a){for await(let o of s)i.push(o);return new E(a,i)}return E.empty()})(r.open())}static async fromAsync(t){return await E.from(t)}static fromStruct(t){return E.new(t.data.childData,t.type.children)}static new(...t){return new E(...Hh(vl(t)))}get schema(){return this._schema}get length(){return this._length}get chunks(){return this._chunks}get numCols(){return this._numChildren}clone(t=this._chunks){return new E(this._schema,t)}getColumn(t){return this.getColumnAt(this.getColumnIndex(t))}getColumnAt(t){return this.getChildAt(t)}getColumnIndex(t){return this._schema.fields.findIndex(r=>r.name===t)}getChildAt(t){if(t<0||t>=this.numChildren)return null;let r,n;const s=this._schema.fields,a=this._children||(this._children=[]);if(n=a[t])return n;if(r=s[t]){const i=this._chunks.map(o=>o.getChildAt(t)).filter(o=>o!=null);if(i.length>0)return a[t]=new pt(r,i)}return null}serialize(t="binary",r=!0){return(r?Ui:Ei).writeAll(this).toUint8Array(!0)}count(){return this._length}select(...t){const r=this._schema.fields.reduce((n,s,a)=>n.set(s.name,a),new Map);return this.selectAt(...t.map(n=>r.get(n)).filter(n=>n>-1))}selectAt(...t){const r=this._schema.selectAt(...t);return new E(r,this._chunks.map(({length:n,data:{childData:s}})=>new X(r,n,t.map(a=>s[a]).filter(Boolean))))}assign(t){const r=this._schema.fields,[n,s]=t.schema.fields.reduce((o,c,u)=>{const[d,y]=o,F=r.findIndex(U=>U.name===c.name);return~F?y[F]=u:d.push(u),o},[[],[]]),a=this._schema.assign(t.schema),i=[...r.map((o,c,u,d=s[c])=>d===void 0?this.getColumnAt(c):t.getColumnAt(d)),...n.map(o=>t.getColumnAt(o))].filter(Boolean);return new E(...no(a,i))}}function od(e){const{type:t}=e;return t instanceof _t?E.fromStruct(bn.from(e)):null}function cd(e){const{type:t}=e;return t instanceof _t?bn.from(e).then(r=>E.fromStruct(r)):null}class X extends bn{constructor(...t){let r,n=t[0],s;if(t[1]instanceof p)[,r,s]=t;else{const a=n.fields,[,i,o]=t;r=p.Struct(new _t(a),0,i,0,null,o)}super(r,s),this._schema=n}static from(t){return mt(t.values),E.from(t)}static new(...t){const[r,n]=Ta(t),s=n.filter(a=>a instanceof L);return new X(...Yh(new C(r),s.map(a=>a.data)))}clone(t,r=this._children){return new X(this._schema,t,r)}concat(...t){const r=this._schema,n=G.flatten(this,...t);return new E(r,n.map(({data:s})=>new X(r,s)))}get schema(){return this._schema}get numCols(){return this._schema.fields.length}get dictionaries(){return this._dictionaries||(this._dictionaries=Wi.collect(this))}select(...t){const r=this._schema.fields.reduce((n,s,a)=>n.set(s.name,a),new Map);return this.selectAt(...t.map(n=>r.get(n)).filter(n=>n>-1))}selectAt(...t){const r=this._schema.selectAt(...t),n=t.map(s=>this.data.childData[s]).filter(Boolean);return new X(r,this.length,n)}}class gn extends X{constructor(t){super(t,0,t.fields.map(r=>p.new(r.type,0,0,0)))}}class Wi extends D{constructor(){super(...arguments),this.dictionaries=new Map}static collect(t){return new Wi().visit(t.data,new _t(t.schema.fields)).dictionaries}visit(t,r){return A.isDictionary(r)?this.visitDictionary(t,r):(t.childData.forEach((n,s)=>this.visit(n,r.children[s].type)),this)}visitDictionary(t,r){const n=t.dictionary;return n&&n.length>0&&this.dictionaries.set(r.id,n),this}}class bt extends ie{constructor(t){super(),this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){const r=this._impl.open(t);return Yt(r)?r.then(()=>this):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return it.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return it.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,r){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof bt?t:kn(t)?fd(t):ta(t)?yd(t):Yt(t)?(async()=>await bt.from(await t))():ea(t)||ni(t)||ra(t)||Ct(t)?pd(new te(t)):dd(new kr(t))}static readAll(t){return t instanceof bt?t.isSync()?Fs(t):Os(t):kn(t)||ArrayBuffer.isView(t)||mt(t)||Xs(t)?Fs(t):Os(t)}}class zr extends bt{constructor(t){super(t),this._impl=t}[Symbol.iterator](){return this._impl[Symbol.iterator]()}async*[Symbol.asyncIterator](){yield*this[Symbol.iterator]()}}class Pr extends bt{constructor(t){super(t),this._impl=t}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class Ro extends zr{constructor(t){super(t),this._impl=t}}class ud extends Pr{constructor(t){super(t),this._impl=t}}class ko{constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,r){return new X(this.schema,t.length,this._loadVectors(t,r,this.schema.fields))}_loadDictionaryBatch(t,r){const{id:n,isDelta:s,data:a}=t,{dictionaries:i,schema:o}=this,c=i.get(n);if(s||!c){const u=o.dictionaries.get(n);return c&&s?c.concat(L.new(this._loadVectors(a,r,[u])[0])):L.new(this._loadVectors(a,r,[u])[0])}return c}_loadVectors(t,r,n){return new Ha(r,t.nodes,t.buffers,this.dictionaries).visitMany(n)}}class $r extends ko{constructor(t,r){super(r),this._reader=kn(t)?new zh(this._handle=t):new Xa(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=zo(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):$}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):$}next(){if(this.closed)return $;let t,{_reader:r}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;const n=t.header(),s=r.readMessageBody(t.bodyLength),a=this._loadRecordBatch(n,s);return{done:!1,value:a}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;const n=t.header(),s=r.readMessageBody(t.bodyLength),a=this._loadDictionaryBatch(n,s);this.dictionaries.set(n.id,a)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new gn(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}}class Wr extends ko{constructor(t,r){super(r),this._reader=new jh(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}async cancel(){!this.closed&&(this.closed=!0)&&(await this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}async open(t){return this.closed||(this.autoDestroy=zo(this,t),this.schema||(this.schema=await this._reader.readSchema())||await this.cancel()),this}async throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?await this.reset()._reader.throw(t):$}async return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?await this.reset()._reader.return(t):$}async next(){if(this.closed)return $;let t,{_reader:r}=this;for(;t=await this._readNextMessageAndValidate();)if(t.isSchema())await this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;const n=t.header(),s=await r.readMessageBody(t.bodyLength),a=this._loadRecordBatch(n,s);return{done:!1,value:a}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;const n=t.header(),s=await r.readMessageBody(t.bodyLength),a=this._loadDictionaryBatch(n,s);this.dictionaries.set(n.id,a)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new gn(this.schema)}):await this.return()}async _readNextMessageAndValidate(t){return await this._reader.readMessage(t)}}class jo extends $r{constructor(t,r){super(t instanceof hs?t:new hs(t),r)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const r of this._footer.dictionaryBatches())r&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){if(this.closed)return null;this._footer||this.open();const r=this._footer&&this._footer.getRecordBatch(t);if(r&&this._handle.seek(r.offset)){const n=this._reader.readMessage(j.RecordBatch);if(n&&n.isRecordBatch()){const s=n.header(),a=this._reader.readMessageBody(n.bodyLength);return this._loadRecordBatch(s,a)}}return null}_readDictionaryBatch(t){const r=this._footer&&this._footer.getDictionaryBatch(t);if(r&&this._handle.seek(r.offset)){const n=this._reader.readMessage(j.DictionaryBatch);if(n&&n.isDictionaryBatch()){const s=n.header(),a=this._reader.readMessageBody(n.bodyLength),i=this._loadDictionaryBatch(s,a);this.dictionaries.set(s.id,i)}}}_readFooter(){const{_handle:t}=this,r=t.size-to,n=t.readInt32(r),s=t.readAt(r-n,n);return Je.decode(s)}_readNextMessageAndValidate(t){if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const r=this._footer&&this._footer.getRecordBatch(this._recordBatchIndex);if(r&&this._handle.seek(r.offset))return this._reader.readMessage(t)}return null}}class ld extends Wr{constructor(t,...r){const n=typeof r[0]!="number"?r.shift():void 0,s=r[0]instanceof Map?r.shift():void 0;super(t instanceof jr?t:new jr(t,n),s)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}async open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=await this._readFooter()).schema;for(const r of this._footer.dictionaryBatches())r&&await this._readDictionaryBatch(this._dictionaryIndex++)}return await super.open(t)}async readRecordBatch(t){if(this.closed)return null;this._footer||await this.open();const r=this._footer&&this._footer.getRecordBatch(t);if(r&&await this._handle.seek(r.offset)){const n=await this._reader.readMessage(j.RecordBatch);if(n&&n.isRecordBatch()){const s=n.header(),a=await this._reader.readMessageBody(n.bodyLength);return this._loadRecordBatch(s,a)}}return null}async _readDictionaryBatch(t){const r=this._footer&&this._footer.getDictionaryBatch(t);if(r&&await this._handle.seek(r.offset)){const n=await this._reader.readMessage(j.DictionaryBatch);if(n&&n.isDictionaryBatch()){const s=n.header(),a=await this._reader.readMessageBody(n.bodyLength),i=this._loadDictionaryBatch(s,a);this.dictionaries.set(s.id,i)}}}async _readFooter(){const{_handle:t}=this;t._pending&&await t._pending;const r=t.size-to,n=await t.readInt32(r),s=await t.readAt(r-n,n);return Je.decode(s)}async _readNextMessageAndValidate(t){if(this._footer||await this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const r=this._footer.getRecordBatch(this._recordBatchIndex);if(r&&await this._handle.seek(r.offset))return await this._reader.readMessage(t)}return null}}class hd extends $r{constructor(t,r){super(t,r)}_loadVectors(t,r,n){return new uh(r,t.nodes,t.buffers,this.dictionaries).visitMany(n)}}function zo(e,t){return t&&typeof t.autoDestroy=="boolean"?t.autoDestroy:e.autoDestroy}function*Fs(e){const t=bt.from(e);try{if(!t.open({autoDestroy:!1}).closed)do yield t;while(!t.reset().open().closed)}finally{t.cancel()}}async function*Os(e){const t=await bt.from(e);try{if(!(await t.open({autoDestroy:!1})).closed)do yield t;while(!(await t.reset().open()).closed)}finally{await t.cancel()}}function fd(e){return new zr(new hd(e))}function dd(e){const t=e.peek(cr+7&-8);return t&&t.byteLength>=4?xi(t)?new Ro(new jo(e.read())):new zr(new $r(e)):new zr(new $r(function*(){}()))}async function pd(e){const t=await e.peek(cr+7&-8);return t&&t.byteLength>=4?xi(t)?new Ro(new jo(await e.read())):new Pr(new Wr(e)):new Pr(new Wr(async function*(){}()))}async function yd(e){const{size:t}=await e.stat(),r=new jr(e,t);return t>=Ph&&xi(await r.readAt(0,cr+7&-8))?new ud(new ld(r)):new Pr(new Wr(r))}function bd(e,t){if(Ct(e))return gd(e,t);if(mt(e))return md(e,t);throw new Error("toDOMStream() must be called with an Iterable or AsyncIterable")}function md(e,t){let r=null;const n=t&&t.type==="bytes"||!1,s=t&&t.highWaterMark||2**24;return new ReadableStream({...t,start(i){a(i,r||(r=e[Symbol.iterator]()))},pull(i){r?a(i,r):i.close()},cancel(){(r&&r.return&&r.return()||!0)&&(r=null)}},{highWaterMark:n?s:void 0,...t});function a(i,o){let c,u=null,d=i.desiredSize||null;for(;!(u=o.next(n?d:null)).done;)if(ArrayBuffer.isView(u.value)&&(c=x(u.value))&&(d!=null&&n&&(d=d-c.byteLength+1),u.value=c),i.enqueue(u.value),d!=null&&--d<=0)return;i.close()}}function gd(e,t){let r=null;const n=t&&t.type==="bytes"||!1,s=t&&t.highWaterMark||2**24;return new ReadableStream({...t,async start(i){await a(i,r||(r=e[Symbol.asyncIterator]()))},async pull(i){r?await a(i,r):i.close()},async cancel(){(r&&r.return&&await r.return()||!0)&&(r=null)}},{highWaterMark:n?s:void 0,...t});async function a(i,o){let c,u=null,d=i.desiredSize||null;for(;!(u=await o.next(n?d:null)).done;)if(ArrayBuffer.isView(u.value)&&(c=x(u.value))&&(d!=null&&n&&(d=d-c.byteLength+1),u.value=c),i.enqueue(u.value),d!=null&&--d<=0)return;i.close()}}function _d(e){return new wd(e)}class wd{constructor(t){this._numChunks=0,this._finished=!1,this._bufferedSize=0;const{["readableStrategy"]:r,["writableStrategy"]:n,["queueingStrategy"]:s="count",...a}=t;this._controller=null,this._builder=W.new(a),this._getSize=s!=="bytes"?Ds:xs;const{["highWaterMark"]:i=s==="bytes"?2**14:1e3}={...r},{["highWaterMark"]:o=s==="bytes"?2**14:1e3}={...n};this.readable=new ReadableStream({cancel:()=>{this._builder.clear()},pull:c=>{this._maybeFlush(this._builder,this._controller=c)},start:c=>{this._maybeFlush(this._builder,this._controller=c)}},{highWaterMark:i,size:s!=="bytes"?Ds:xs}),this.writable=new WritableStream({abort:()=>{this._builder.clear()},write:()=>{this._maybeFlush(this._builder,this._controller)},close:()=>{this._maybeFlush(this._builder.finish(),this._controller)}},{highWaterMark:o,size:c=>this._writeValueAndReturnChunkSize(c)})}_writeValueAndReturnChunkSize(t){const r=this._bufferedSize;return this._bufferedSize=this._getSize(this._builder.append(t)),this._bufferedSize-r}_maybeFlush(t,r){r!==null&&(this._bufferedSize>=r.desiredSize&&++this._numChunks&&this._enqueue(r,t.toVector()),t.finished&&((t.length>0||this._numChunks===0)&&++this._numChunks&&this._enqueue(r,t.toVector()),!this._finished&&(this._finished=!0)&&this._enqueue(r,null)))}_enqueue(t,r){this._bufferedSize=0,this._controller=null,r===null?t.close():t.enqueue(r)}}const Ds=e=>e.length,xs=e=>e.byteLength;function vd(e,t){const r=new Ve;let n=null;const s=new ReadableStream({async cancel(){await r.close()},async start(o){await i(o,n||(n=await a()))},async pull(o){n?await i(o,n):o.close()}});return{writable:new WritableStream(r,{highWaterMark:2**14,...e}),readable:s};async function a(){return await(await bt.from(r)).open(t)}async function i(o,c){let u=o.desiredSize,d=null;for(;!(d=await c.next()).done;)if(o.enqueue(d.value),u!=null&&--u<=0)return;o.close()}}function Id(e,t){const r=new this(e),n=new te(r),s=new ReadableStream({type:"bytes",async cancel(){await n.cancel()},async pull(i){await a(i)},async start(i){await a(i)}},{highWaterMark:2**14,...t});return{writable:new WritableStream(r,e),readable:s};async function a(i){let o=null,c=i.desiredSize;for(;o=await n.read(c||null);)if(i.enqueue(o),c!=null&&(c-=o.byteLength)<=0)return;i.close()}}class me{eq(t){return t instanceof me||(t=new ge(t)),new Sd(this,t)}le(t){return t instanceof me||(t=new ge(t)),new Bd(this,t)}ge(t){return t instanceof me||(t=new ge(t)),new Ad(this,t)}lt(t){return new Br(this.ge(t))}gt(t){return new Br(this.le(t))}ne(t){return new Br(this.eq(t))}}class ge extends me{constructor(t){super(),this.v=t}}class Po extends me{constructor(t){super(),this.name=t}bind(t){if(!this.colidx){this.colidx=-1;const n=t.schema.fields;for(let s=-1;++s<n.length;)if(n[s].name===this.name){this.colidx=s;break}if(this.colidx<0)throw new Error(`Failed to bind Col "${this.name}"`)}const r=this.vector=t.getChildAt(this.colidx);return n=>r.get(n)}}class Yi{and(...t){return new Ji(this,...t)}or(...t){return new Gi(this,...t)}not(){return new Br(this)}}class Hi extends Yi{constructor(t,r){super(),this.left=t,this.right=r}bind(t){return this.left instanceof ge?this.right instanceof ge?this._bindLitLit(t,this.left,this.right):this._bindLitCol(t,this.left,this.right):this.right instanceof ge?this._bindColLit(t,this.left,this.right):this._bindColCol(t,this.left,this.right)}}class Ki extends Yi{constructor(...t){super(),this.children=t}}Ki.prototype.children=Object.freeze([]);class Ji extends Ki{constructor(...t){t=t.reduce((r,n)=>r.concat(n instanceof Ji?n.children:n),[]),super(...t)}bind(t){const r=this.children.map(n=>n.bind(t));return(n,s)=>r.every(a=>a(n,s))}}class Gi extends Ki{constructor(...t){t=t.reduce((r,n)=>r.concat(n instanceof Gi?n.children:n),[]),super(...t)}bind(t){const r=this.children.map(n=>n.bind(t));return(n,s)=>r.some(a=>a(n,s))}}class Sd extends Hi{_bindLitLit(t,r,n){const s=r.v==n.v;return()=>s}_bindColCol(t,r,n){const s=r.bind(t),a=n.bind(t);return(i,o)=>s(i,o)==a(i,o)}_bindColLit(t,r,n){const s=r.bind(t);if(r.vector instanceof Ri){let a;const i=r.vector;return i.dictionary!==this.lastDictionary?(a=i.reverseLookup(n.v),this.lastDictionary=i.dictionary,this.lastKey=a):a=this.lastKey,a===-1?()=>!1:o=>i.getKey(o)===a}else return(a,i)=>s(a,i)==n.v}_bindLitCol(t,r,n){return this._bindColLit(t,n,r)}}class Bd extends Hi{_bindLitLit(t,r,n){const s=r.v<=n.v;return()=>s}_bindColCol(t,r,n){const s=r.bind(t),a=n.bind(t);return(i,o)=>s(i,o)<=a(i,o)}_bindColLit(t,r,n){const s=r.bind(t);return(a,i)=>s(a,i)<=n.v}_bindLitCol(t,r,n){const s=n.bind(t);return(a,i)=>r.v<=s(a,i)}}class Ad extends Hi{_bindLitLit(t,r,n){const s=r.v>=n.v;return()=>s}_bindColCol(t,r,n){const s=r.bind(t),a=n.bind(t);return(i,o)=>s(i,o)>=a(i,o)}_bindColLit(t,r,n){const s=r.bind(t);return(a,i)=>s(a,i)>=n.v}_bindLitCol(t,r,n){const s=n.bind(t);return(a,i)=>r.v>=s(a,i)}}class Br extends Yi{constructor(t){super(),this.child=t}bind(t){const r=this.child.bind(t);return(n,s)=>!r(n,s)}}E.prototype.countBy=function(e){return new hr(this.chunks).countBy(e)};E.prototype.scan=function(e,t){return new hr(this.chunks).scan(e,t)};E.prototype.scanReverse=function(e,t){return new hr(this.chunks).scanReverse(e,t)};E.prototype.filter=function(e){return new hr(this.chunks).filter(e)};class hr extends E{filter(t){return new qi(this.chunks,t)}scan(t,r){const n=this.chunks,s=n.length;for(let a=-1;++a<s;){const i=n[a];r&&r(i);for(let o=-1,c=i.length;++o<c;)t(o,i)}}scanReverse(t,r){const n=this.chunks,s=n.length;for(let a=s;--a>=0;){const i=n[a];r&&r(i);for(let o=i.length;--o>=0;)t(o,i)}}countBy(t){const r=this.chunks,n=r.length,s=typeof t=="string"?new Po(t):t;s.bind(r[n-1]);const a=s.vector;if(!A.isDictionary(a.type))throw new Error("countBy currently only supports dictionary-encoded columns");const i=Math.ceil(Math.log(a.length)/Math.log(256)),o=i==4?Uint32Array:i>=2?Uint16Array:Uint8Array,c=new o(a.dictionary.length);for(let u=-1;++u<n;){const d=r[u];s.bind(d);const y=s.vector.indices;for(let F=-1,U=d.length;++F<U;){let Bt=y.get(F);Bt!==null&&c[Bt]++}}return new $o(a.dictionary,St.from(c))}}class $o extends E{constructor(t,r){const n=new C([new M("values",t.type),new M("counts",r.type)]);super(new X(n,r.length,[t,r]))}toJSON(){const t=this.getColumnAt(0),r=this.getColumnAt(1),n={};for(let s=-1;++s<this.length;)n[t.get(s)]=r.get(s);return n}}class qi extends hr{constructor(t,r){super(t),this._predicate=r}scan(t,r){const n=this._chunks,s=n.length;for(let a=-1;++a<s;){const i=n[a],o=this._predicate.bind(i);let c=!1;for(let u=-1,d=i.length;++u<d;)o(u,i)&&(r&&!c&&(r(i),c=!0),t(u,i))}}scanReverse(t,r){const n=this._chunks,s=n.length;for(let a=s;--a>=0;){const i=n[a],o=this._predicate.bind(i);let c=!1;for(let u=i.length;--u>=0;)o(u,i)&&(r&&!c&&(r(i),c=!0),t(u,i))}}count(){let t=0;const r=this._chunks,n=r.length;for(let s=-1;++s<n;){const a=r[s],i=this._predicate.bind(a);for(let o=-1,c=a.length;++o<c;)i(o,a)&&++t}return t}*[Symbol.iterator](){const t=this._chunks,r=t.length;for(let n=-1;++n<r;){const s=t[n],a=this._predicate.bind(s);for(let i=-1,o=s.length;++i<o;)a(i,s)&&(yield s.get(i))}}filter(t){return new qi(this._chunks,this._predicate.and(t))}countBy(t){const r=this._chunks,n=r.length,s=typeof t=="string"?new Po(t):t;s.bind(r[n-1]);const a=s.vector;if(!A.isDictionary(a.type))throw new Error("countBy currently only supports dictionary-encoded columns");const i=Math.ceil(Math.log(a.length)/Math.log(256)),o=i==4?Uint32Array:i>=2?Uint16Array:Uint8Array,c=new o(a.dictionary.length);for(let u=-1;++u<n;){const d=r[u],y=this._predicate.bind(d);s.bind(d);const F=s.vector.indices;for(let U=-1,Bt=d.length;++U<Bt;){let fr=F.get(U);fr!==null&&y(U,d)&&c[fr]++}}return new $o(a.dictionary,St.from(c))}}({...$u,...ch,...yu,...ku,...uu,...ml});it.toDOMStream=bd;W.throughDOM=_d;bt.throughDOM=vd;Mi.throughDOM=Id;/**
 * @license
 * Copyright 2018-2021 Streamlit Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ls=function(){function e(t,r,n,s){var a=this;this.getCell=function(i,o){var c=i<a.headerRows&&o<a.headerColumns,u=i>=a.headerRows&&o<a.headerColumns,d=i<a.headerRows&&o>=a.headerColumns;if(c){var y=["blank"];return o>0&&y.push("level"+i),{type:"blank",classNames:y.join(" "),content:""}}else if(d){var F=o-a.headerColumns,y=["col_heading","level"+i,"col"+F];return{type:"columns",classNames:y.join(" "),content:a.getContent(a.columnsTable,F,i)}}else if(u){var U=i-a.headerRows,y=["row_heading","level"+o,"row"+U];return{type:"index",id:"T_"+a.uuid+"level"+o+"_row"+U,classNames:y.join(" "),content:a.getContent(a.indexTable,U,o)}}else{var U=i-a.headerRows,F=o-a.headerColumns,y=["data","row"+U,"col"+F],Bt=a.styler?a.getContent(a.styler.displayValuesTable,U,F):a.getContent(a.dataTable,U,F);return{type:"data",id:"T_"+a.uuid+"row"+U+"_col"+F,classNames:y.join(" "),content:Bt}}},this.getContent=function(i,o,c){var u=i.getColumnAt(c);if(u===null)return"";var d=a.getColumnTypeId(i,c);switch(d){case l.Timestamp:return a.nanosToDate(u.get(o));default:return u.get(o)}},this.dataTable=E.from(t),this.indexTable=E.from(r),this.columnsTable=E.from(n),this.styler=s?{caption:s.caption,displayValuesTable:E.from(s.displayValues),styles:s.styles,uuid:s.uuid}:void 0}return Object.defineProperty(e.prototype,"rows",{get:function(){return this.indexTable.length+this.columnsTable.numCols},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return this.indexTable.numCols+this.columnsTable.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerRows",{get:function(){return this.rows-this.dataRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerColumns",{get:function(){return this.columns-this.dataColumns},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataRows",{get:function(){return this.dataTable.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataColumns",{get:function(){return this.dataTable.numCols},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uuid",{get:function(){return this.styler&&this.styler.uuid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"caption",{get:function(){return this.styler&&this.styler.caption},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"styles",{get:function(){return this.styler&&this.styler.styles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"table",{get:function(){return this.dataTable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this.indexTable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnTable",{get:function(){return this.columnsTable},enumerable:!0,configurable:!0}),e.prototype.serialize=function(){return{data:this.dataTable.serialize(),index:this.indexTable.serialize(),columns:this.columnsTable.serialize()}},e.prototype.getColumnTypeId=function(t,r){return t.schema.fields[r].type.typeId},e.prototype.nanosToDate=function(t){return new Date(t/1e6)},e}();/**
 * @license
 * Copyright 2018-2021 Streamlit Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ce=globalThis&&globalThis.__assign||function(){return Ce=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Ce.apply(this,arguments)},Re;(function(e){e.COMPONENT_READY="streamlit:componentReady",e.SET_COMPONENT_VALUE="streamlit:setComponentValue",e.SET_FRAME_HEIGHT="streamlit:setFrameHeight"})(Re||(Re={}));var ne=function(){function e(){}return e.API_VERSION=1,e.RENDER_EVENT="streamlit:render",e.events=new Wt,e.registeredMessageListener=!1,e.setComponentReady=function(){e.registeredMessageListener||(window.addEventListener("message",e.onMessageEvent),e.registeredMessageListener=!0),e.sendBackMsg(Re.COMPONENT_READY,{apiVersion:e.API_VERSION})},e.setFrameHeight=function(t){t===void 0&&(t=document.body.scrollHeight),t!==e.lastFrameHeight&&(e.lastFrameHeight=t,e.sendBackMsg(Re.SET_FRAME_HEIGHT,{height:t}))},e.setComponentValue=function(t){var r;t instanceof Ls?(r="dataframe",t=t.serialize()):Fd(t)?(r="bytes",t=new Uint8Array(t.buffer)):t instanceof ArrayBuffer?(r="bytes",t=new Uint8Array(t)):r="json",e.sendBackMsg(Re.SET_COMPONENT_VALUE,{value:t,dataType:r})},e.onMessageEvent=function(t){var r=t.data.type;switch(r){case e.RENDER_EVENT:e.onRenderMessage(t.data);break}},e.onRenderMessage=function(t){var r=t.args;r==null&&(console.error("Got null args in onRenderMessage. This should never happen"),r={});var n=t.dfs&&t.dfs.length>0?e.argsDataframeToObject(t.dfs):{};r=Ce(Ce({},r),n);var s=Boolean(t.disabled),a=t.theme;a&&Td(a);var i={disabled:s,args:r,theme:a},o=new CustomEvent(e.RENDER_EVENT,{detail:i});e.events.dispatchEvent(o)},e.argsDataframeToObject=function(t){var r=t.map(function(n){var s=n.key,a=n.value;return[s,e.toArrowTable(a)]});return Object.fromEntries(r)},e.toArrowTable=function(t){var r=t.data,n=r.data,s=r.index,a=r.columns,i=r.styler;return new Ls(n,s,a,i)},e.sendBackMsg=function(t,r){window.parent.postMessage(Ce({isStreamlitMessage:!0,type:t},r),"*")},e}(),Td=function(e){var t=document.createElement("style");document.head.appendChild(t),t.innerHTML=`
    :root {
      --primary-color: `+e.primaryColor+`;
      --background-color: `+e.backgroundColor+`;
      --secondary-background-color: `+e.secondaryBackgroundColor+`;
      --text-color: `+e.textColor+`;
      --font: `+e.font+`;
    }

    body {
      background-color: var(--background-color);
      color: var(--text-color);
    }
  `};function Fd(e){var t=!1;try{t=e instanceof BigInt64Array||e instanceof BigUint64Array}catch{}return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array||t}/**
 * @license
 * Copyright 2018-2021 Streamlit Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Od=globalThis&&globalThis.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var a in s)s.hasOwnProperty(a)&&(n[a]=s[a])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(e){Od(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.componentDidMount=function(){ne.setFrameHeight()},t.prototype.componentDidUpdate=function(){ne.setFrameHeight()},t})(wc.PureComponent);const Dd=document.body.appendChild(document.createElement("div")),qe=Dd.appendChild(document.createElement("button")),Ar=qe.appendChild(document.createElement("span")),Wo=qe.appendChild(document.createElement("span"));Ar.className="icon";Wo.textContent="AUTHORIZE";qe.onclick=async()=>{var e=screen.width/2-Kn/2,t=screen.height/2-Hn/2;const r=window.open(Yr,"oauthWidget",`toolbar=no, location=no, directories=no, status=no, menubar=no, resizable=no, copyhistory=no,width=${Kn},height=${Hn},top=${t},left=${e}`);r.focus();let n=await new Promise((s,a)=>{const i=setInterval(()=>{try{let o=new URLSearchParams(Yr).get("redirect_uri"),c=new URL(r.location.href).toString(),u=new URLSearchParams(r.location.search);if(!c.startsWith(o))return;r.close(),clearInterval(i);let d={};for(let y of u.entries())d[y[0]]=y[1];return s(d)}catch(o){return o.name==="SecurityError"?void 0:a(o)}},1e3)});ne.setComponentValue(n)};let Yr,Hn,Kn;function xd(e){const t=e.detail;Yr=t.args.authorization_url,Hn=t.args.popup_height,Kn=t.args.popup_width,Wo.textContent=t.args.name,t.args.icon?Ar.style.backgroundImage=`url("${t.args.icon}")`:(Ar.style.width="0px",Ar.style.height="0px"),t.args.use_container_width&&(qe.style.width="100%"),t.args.auto_click&&!window.opener&&!window.clicked&&(qe.click(),window.clicked=!0),console.log(`authorization_url: ${Yr}`),ne.setFrameHeight()}ne.events.addEventListener(ne.RENDER_EVENT,xd);ne.setComponentReady();
